import{r as Ce,o as ot,h as wt,b as ke,c as nt,e as be,y as ha,u as Hs,d as qn,w as Tt,k as mt,F as ua,l as da}from"./index-DsVLOH3a.js";import{_ as at,H as pa}from"./Header-CkuJyqQi.js";import{S as pt,B as Jt,M as Et,a as Ae,P as lt,O as Vt,W as ft,b as Hn,c as Bi,d as fa,G as Zi,V as xi,L as Us,e as qs,A as cr,C as hi,D as va,H as Sn,F as fr,f as $n,g as ei,h as Zn,i as ui,N as $s,j as je,k as ki,l as oi,m as rn,n as hr,E as Xs,o as ma,p as ga,q as jr,r as In,s as ya,t as wa,u as an,v as yt,w as _a,x as bn,y as Ki,z as Ys,I as xa,J as js,K as Ks,Q as Aa,R as ba,U as Ta,X as Pr,Y as Qs,Z as Rn,_ as zi,$ as Ti,a0 as Kr,a1 as Jn,a2 as Ea,a3 as Sa,a4 as Zs,a5 as Ca,a6 as Ma,a7 as Js,a8 as It,a9 as eo,aa as vr,ab as Ra,ac as Pa,ad as La,ae as Ba,af as to,ag as Pn,ah as Fa,ai as Ia,aj as ka,ak as za,al as io,am as vs,an as no,ao as Na,ap as Oa,aq as Va,ar as Da,as as Wa,at as Ga,au as Ha,av as Ua,aw as ms,ax as gs,ay as ys,az as ws,aA as qa,aB as $a,aC as Xa,aD as Ya,aE as ja,aF as Ka,aG as Qa,aH as Za,aI as Ja,aJ as el,aK as tl,aL as _s,aM as il,aN as nl,aO as rl,aP as sl,T as ol}from"./ThreeMaterials-Dt7A37tS.js";function wi(y){if(y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return y}function ro(y,e){y.prototype=Object.create(e.prototype),y.prototype.constructor=y,y.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Nt={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},yn={duration:.5,overwrite:!1,delay:0},Qr,ut,qe,Yt=1e8,We=1/Yt,Lr=Math.PI*2,al=Lr/4,ll=0,so=Math.sqrt,cl=Math.cos,hl=Math.sin,rt=function(e){return typeof e=="string"},Ke=function(e){return typeof e=="function"},Ai=function(e){return typeof e=="number"},Zr=function(e){return typeof e>"u"},ci=function(e){return typeof e=="object"},St=function(e){return e!==!1},Jr=function(){return typeof window<"u"},Xn=function(e){return Ke(e)||rt(e)},oo=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},dt=Array.isArray,Br=/(?:-?\.?\d|\.)+/gi,ao=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,dn=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,mr=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,lo=/[+-]=-?[.\d]+/,co=/[^,'"\[\]\s]+/gi,ul=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,$e,ni,Fr,es,Ot={},er={},ho,uo=function(e){return(er=sn(e,Ot))&&Pt},ts=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},kn=function(e,t){return!t&&console.warn(e)},po=function(e,t){return e&&(Ot[e]=t)&&er&&(er[e]=t)||Ot},zn=function(){return 0},dl={suppressEvents:!0,isStart:!0,kill:!1},jn={suppressEvents:!0,kill:!1},pl={suppressEvents:!0},is={},Fi=[],Ir={},fo,Ft={},gr={},xs=30,Kn=[],ns="",rs=function(e){var t=e[0],i,r;if(ci(t)||Ke(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(r=Kn.length;r--&&!Kn[r].targetTest(t););i=Kn[r]}for(r=e.length;r--;)e[r]&&(e[r]._gsap||(e[r]._gsap=new Oo(e[r],i)))||e.splice(r,1);return e},Ji=function(e){return e._gsap||rs(jt(e))[0]._gsap},vo=function(e,t,i){return(i=e[t])&&Ke(i)?e[t]():Zr(i)&&e.getAttribute&&e.getAttribute(t)||i},Ct=function(e,t){return(e=e.split(",")).forEach(t)||e},Qe=function(e){return Math.round(e*1e5)/1e5||0},it=function(e){return Math.round(e*1e7)/1e7||0},fn=function(e,t){var i=t.charAt(0),r=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+r:i==="-"?e-r:i==="*"?e*r:e/r},fl=function(e,t){for(var i=t.length,r=0;e.indexOf(t[r])<0&&++r<i;);return r<i},tr=function(){var e=Fi.length,t=Fi.slice(0),i,r;for(Ir={},Fi.length=0,i=0;i<e;i++)r=t[i],r&&r._lazy&&(r.render(r._lazy[0],r._lazy[1],!0)._lazy=0)},mo=function(e,t,i,r){Fi.length&&!ut&&tr(),e.render(t,i,ut&&t<0&&(e._initted||e._startAt)),Fi.length&&!ut&&tr()},go=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(co).length<2?t:rt(e)?e.trim():e},yo=function(e){return e},Kt=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},vl=function(e){return function(t,i){for(var r in i)r in t||r==="duration"&&e||r==="ease"||(t[r]=i[r])}},sn=function(e,t){for(var i in t)e[i]=t[i];return e},As=function y(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=ci(t[i])?y(e[i]||(e[i]={}),t[i]):t[i]);return e},ir=function(e,t){var i={},r;for(r in e)r in t||(i[r]=e[r]);return i},Ln=function(e){var t=e.parent||$e,i=e.keyframes?vl(dt(e.keyframes)):Kt;if(St(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},ml=function(e,t){for(var i=e.length,r=i===t.length;r&&i--&&e[i]===t[i];);return i<0},wo=function(e,t,i,r,s){var n=e[r],o;if(s)for(o=t[s];n&&n[s]>o;)n=n._prev;return n?(t._next=n._next,n._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[r]=t,t._prev=n,t.parent=t._dp=e,t},ur=function(e,t,i,r){i===void 0&&(i="_first"),r===void 0&&(r="_last");var s=t._prev,n=t._next;s?s._next=n:e[i]===t&&(e[i]=n),n?n._prev=s:e[r]===t&&(e[r]=s),t._next=t._prev=t.parent=null},Ni=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},en=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},gl=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},kr=function(e,t,i,r){return e._startAt&&(ut?e._startAt.revert(jn):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,r))},yl=function y(e){return!e||e._ts&&y(e.parent)},bs=function(e){return e._repeat?wn(e._tTime,e=e.duration()+e._rDelay)*e:0},wn=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},nr=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},dr=function(e){return e._end=it(e._start+(e._tDur/Math.abs(e._ts||e._rts||We)||0))},pr=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=it(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),dr(e),i._dirty||en(i,e)),e},_o=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=nr(e.rawTime(),t),(!t._dur||Un(0,t.totalDuration(),i)-t._tTime>We)&&t.render(i,!0)),en(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-We}},ri=function(e,t,i,r){return t.parent&&Ni(t),t._start=it((Ai(i)?i:i||e!==$e?$t(e,i,t):e._time)+t._delay),t._end=it(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),wo(e,t,"_first","_last",e._sort?"_start":0),zr(t)||(e._recent=t),r||_o(e,t),e._ts<0&&pr(e,e._tTime),e},xo=function(e,t){return(Ot.ScrollTrigger||ts("scrollTrigger",t))&&Ot.ScrollTrigger.create(t,e)},Ao=function(e,t,i,r,s){if(os(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!ut&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&fo!==kt.frame)return Fi.push(e),e._lazy=[s,r],1},wl=function y(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||y(t))},zr=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},_l=function(e,t,i,r){var s=e.ratio,n=t<0||!t&&(!e._start&&wl(e)&&!(!e._initted&&zr(e))||(e._ts<0||e._dp._ts<0)&&!zr(e))?0:1,o=e._rDelay,a=0,h,l,c;if(o&&e._repeat&&(a=Un(0,e._tDur,t),l=wn(a,o),e._yoyo&&l&1&&(n=1-n),l!==wn(e._tTime,o)&&(s=1-n,e.vars.repeatRefresh&&e._initted&&e.invalidate())),n!==s||ut||r||e._zTime===We||!t&&e._zTime){if(!e._initted&&Ao(e,t,r,i,a))return;for(c=e._zTime,e._zTime=t||(i?We:0),i||(i=t&&!c),e.ratio=n,e._from&&(n=1-n),e._time=0,e._tTime=a,h=e._pt;h;)h.r(n,h.d),h=h._next;t<0&&kr(e,t,i,!0),e._onUpdate&&!i&&zt(e,"onUpdate"),a&&e._repeat&&!i&&e.parent&&zt(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===n&&(n&&Ni(e,1),!i&&!ut&&(zt(e,n?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},xl=function(e,t,i){var r;if(i>t)for(r=e._first;r&&r._start<=i;){if(r.data==="isPause"&&r._start>t)return r;r=r._next}else for(r=e._last;r&&r._start>=i;){if(r.data==="isPause"&&r._start<t)return r;r=r._prev}},_n=function(e,t,i,r){var s=e._repeat,n=it(t)||0,o=e._tTime/e._tDur;return o&&!r&&(e._time*=n/e._dur),e._dur=n,e._tDur=s?s<0?1e10:it(n*(s+1)+e._rDelay*s):n,o>0&&!r&&pr(e,e._tTime=e._tDur*o),e.parent&&dr(e),i||en(e.parent,e),e},Ts=function(e){return e instanceof gt?en(e):_n(e,e._dur)},Al={_start:0,endTime:zn,totalDuration:zn},$t=function y(e,t,i){var r=e.labels,s=e._recent||Al,n=e.duration()>=Yt?s.endTime(!1):e._dur,o,a,h;return rt(t)&&(isNaN(t)||t in r)?(a=t.charAt(0),h=t.substr(-1)==="%",o=t.indexOf("="),a==="<"||a===">"?(o>=0&&(t=t.replace(/=/,"")),(a==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(o<0?s:i).totalDuration()/100:1)):o<0?(t in r||(r[t]=n),r[t]):(a=parseFloat(t.charAt(o-1)+t.substr(o+1)),h&&i&&(a=a/100*(dt(i)?i[0]:i).totalDuration()),o>1?y(e,t.substr(0,o-1),i)+a:n+a)):t==null?n:+t},Bn=function(e,t,i){var r=Ai(t[1]),s=(r?2:1)+(e<2?0:1),n=t[s],o,a;if(r&&(n.duration=t[1]),n.parent=i,e){for(o=n,a=i;a&&!("immediateRender"in o);)o=a.vars.defaults||{},a=St(a.vars.inherit)&&a.parent;n.immediateRender=St(o.immediateRender),e<2?n.runBackwards=1:n.startAt=t[s-1]}return new Ze(t[0],n,t[s+1])},Vi=function(e,t){return e||e===0?t(e):t},Un=function(e,t,i){return i<e?e:i>t?t:i},ht=function(e,t){return!rt(e)||!(t=ul.exec(e))?"":t[1]},bl=function(e,t,i){return Vi(i,function(r){return Un(e,t,r)})},Nr=[].slice,bo=function(e,t){return e&&ci(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&ci(e[0]))&&!e.nodeType&&e!==ni},Tl=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(r){var s;return rt(r)&&!t||bo(r,1)?(s=i).push.apply(s,jt(r)):i.push(r)})||i},jt=function(e,t,i){return qe&&!t&&qe.selector?qe.selector(e):rt(e)&&!i&&(Fr||!xn())?Nr.call((t||es).querySelectorAll(e),0):dt(e)?Tl(e,i):bo(e)?Nr.call(e,0):e?[e]:[]},Or=function(e){return e=jt(e)[0]||kn("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return jt(t,i.querySelectorAll?i:i===e?kn("Invalid scope")||es.createElement("div"):e)}},To=function(e){return e.sort(function(){return .5-Math.random()})},Eo=function(e){if(Ke(e))return e;var t=ci(e)?e:{each:e},i=tn(t.ease),r=t.from||0,s=parseFloat(t.base)||0,n={},o=r>0&&r<1,a=isNaN(r)||o,h=t.axis,l=r,c=r;return rt(r)?l=c={center:.5,edges:.5,end:1}[r]||0:!o&&a&&(l=r[0],c=r[1]),function(u,d,p){var f=(p||t).length,v=n[f],m,g,_,w,x,E,L,A,T;if(!v){if(T=t.grid==="auto"?0:(t.grid||[1,Yt])[1],!T){for(L=-Yt;L<(L=p[T++].getBoundingClientRect().left)&&T<f;);T<f&&T--}for(v=n[f]=[],m=a?Math.min(T,f)*l-.5:r%T,g=T===Yt?0:a?f*c/T-.5:r/T|0,L=0,A=Yt,E=0;E<f;E++)_=E%T-m,w=g-(E/T|0),v[E]=x=h?Math.abs(h==="y"?w:_):so(_*_+w*w),x>L&&(L=x),x<A&&(A=x);r==="random"&&To(v),v.max=L-A,v.min=A,v.v=f=(parseFloat(t.amount)||parseFloat(t.each)*(T>f?f-1:h?h==="y"?f/T:T:Math.max(T,f/T))||0)*(r==="edges"?-1:1),v.b=f<0?s-f:s,v.u=ht(t.amount||t.each)||0,i=i&&f<0?ko(i):i}return f=(v[u]-v.min)/v.max||0,it(v.b+(i?i(f):f)*v.v)+v.u}},Vr=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var r=it(Math.round(parseFloat(i)/e)*e*t);return(r-r%1)/t+(Ai(i)?0:ht(i))}},So=function(e,t){var i=dt(e),r,s;return!i&&ci(e)&&(r=i=e.radius||Yt,e.values?(e=jt(e.values),(s=!Ai(e[0]))&&(r*=r)):e=Vr(e.increment)),Vi(t,i?Ke(e)?function(n){return s=e(n),Math.abs(s-n)<=r?s:n}:function(n){for(var o=parseFloat(s?n.x:n),a=parseFloat(s?n.y:0),h=Yt,l=0,c=e.length,u,d;c--;)s?(u=e[c].x-o,d=e[c].y-a,u=u*u+d*d):u=Math.abs(e[c]-o),u<h&&(h=u,l=c);return l=!r||h<=r?e[l]:n,s||l===n||Ai(n)?l:l+ht(n)}:Vr(e))},Co=function(e,t,i,r){return Vi(dt(e)?!t:i===!0?!!(i=0):!r,function(){return dt(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(r=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*r)/r})},El=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduce(function(s,n){return n(s)},r)}},Sl=function(e,t){return function(i){return e(parseFloat(i))+(t||ht(i))}},Cl=function(e,t,i){return Ro(e,t,0,1,i)},Mo=function(e,t,i){return Vi(i,function(r){return e[~~t(r)]})},Ml=function y(e,t,i){var r=t-e;return dt(e)?Mo(e,y(0,e.length),t):Vi(i,function(s){return(r+(s-e)%r)%r+e})},Rl=function y(e,t,i){var r=t-e,s=r*2;return dt(e)?Mo(e,y(0,e.length-1),t):Vi(i,function(n){return n=(s+(n-e)%s)%s||0,e+(n>r?s-n:n)})},Nn=function(e){for(var t=0,i="",r,s,n,o;~(r=e.indexOf("random(",t));)n=e.indexOf(")",r),o=e.charAt(r+7)==="[",s=e.substr(r+7,n-r-7).match(o?co:Br),i+=e.substr(t,r-t)+Co(o?s:+s[0],o?0:+s[1],+s[2]||1e-5),t=n+1;return i+e.substr(t,e.length-t)},Ro=function(e,t,i,r,s){var n=t-e,o=r-i;return Vi(s,function(a){return i+((a-e)/n*o||0)})},Pl=function y(e,t,i,r){var s=isNaN(e+t)?0:function(d){return(1-d)*e+d*t};if(!s){var n=rt(e),o={},a,h,l,c,u;if(i===!0&&(r=1)&&(i=null),n)e={p:e},t={p:t};else if(dt(e)&&!dt(t)){for(l=[],c=e.length,u=c-2,h=1;h<c;h++)l.push(y(e[h-1],e[h]));c--,s=function(p){p*=c;var f=Math.min(u,~~p);return l[f](p-f)},i=t}else r||(e=sn(dt(e)?[]:{},e));if(!l){for(a in t)ss.call(o,e,a,"get",t[a]);s=function(p){return cs(p,o)||(n?e.p:e)}}}return Vi(i,s)},Es=function(e,t,i){var r=e.labels,s=Yt,n,o,a;for(n in r)o=r[n]-t,o<0==!!i&&o&&s>(o=Math.abs(o))&&(a=n,s=o);return a},zt=function(e,t,i){var r=e.vars,s=r[t],n=qe,o=e._ctx,a,h,l;if(s)return a=r[t+"Params"],h=r.callbackScope||e,i&&Fi.length&&tr(),o&&(qe=o),l=a?s.apply(h,a):s.call(h),qe=n,l},Cn=function(e){return Ni(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ut),e.progress()<1&&zt(e,"onInterrupt"),e},pn,Po=[],Lo=function(e){if(e)if(e=!e.name&&e.default||e,Jr()||e.headless){var t=e.name,i=Ke(e),r=t&&!i&&e.init?function(){this._props=[]}:e,s={init:zn,render:cs,add:ss,kill:$l,modifier:ql,rawVars:0},n={targetTest:0,get:0,getSetter:ls,aliases:{},register:0};if(xn(),e!==r){if(Ft[t])return;Kt(r,Kt(ir(e,s),n)),sn(r.prototype,sn(s,ir(e,n))),Ft[r.prop=t]=r,e.targetTest&&(Kn.push(r),is[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}po(t,r),e.register&&e.register(Pt,r,Mt)}else Po.push(e)},Ve=255,Mn={aqua:[0,Ve,Ve],lime:[0,Ve,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Ve],navy:[0,0,128],white:[Ve,Ve,Ve],olive:[128,128,0],yellow:[Ve,Ve,0],orange:[Ve,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Ve,0,0],pink:[Ve,192,203],cyan:[0,Ve,Ve],transparent:[Ve,Ve,Ve,0]},yr=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*Ve+.5|0},Bo=function(e,t,i){var r=e?Ai(e)?[e>>16,e>>8&Ve,e&Ve]:0:Mn.black,s,n,o,a,h,l,c,u,d,p;if(!r){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Mn[e])r=Mn[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),n=e.charAt(2),o=e.charAt(3),e="#"+s+s+n+n+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return r=parseInt(e.substr(1,6),16),[r>>16,r>>8&Ve,r&Ve,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),r=[e>>16,e>>8&Ve,e&Ve]}else if(e.substr(0,3)==="hsl"){if(r=p=e.match(Br),!t)a=+r[0]%360/360,h=+r[1]/100,l=+r[2]/100,n=l<=.5?l*(h+1):l+h-l*h,s=l*2-n,r.length>3&&(r[3]*=1),r[0]=yr(a+1/3,s,n),r[1]=yr(a,s,n),r[2]=yr(a-1/3,s,n);else if(~e.indexOf("="))return r=e.match(ao),i&&r.length<4&&(r[3]=1),r}else r=e.match(Br)||Mn.transparent;r=r.map(Number)}return t&&!p&&(s=r[0]/Ve,n=r[1]/Ve,o=r[2]/Ve,c=Math.max(s,n,o),u=Math.min(s,n,o),l=(c+u)/2,c===u?a=h=0:(d=c-u,h=l>.5?d/(2-c-u):d/(c+u),a=c===s?(n-o)/d+(n<o?6:0):c===n?(o-s)/d+2:(s-n)/d+4,a*=60),r[0]=~~(a+.5),r[1]=~~(h*100+.5),r[2]=~~(l*100+.5)),i&&r.length<4&&(r[3]=1),r},Fo=function(e){var t=[],i=[],r=-1;return e.split(Ii).forEach(function(s){var n=s.match(dn)||[];t.push.apply(t,n),i.push(r+=n.length+1)}),t.c=i,t},Ss=function(e,t,i){var r="",s=(e+r).match(Ii),n=t?"hsla(":"rgba(",o=0,a,h,l,c;if(!s)return e;if(s=s.map(function(u){return(u=Bo(u,t,1))&&n+(t?u[0]+","+u[1]+"%,"+u[2]+"%,"+u[3]:u.join(","))+")"}),i&&(l=Fo(e),a=i.c,a.join(r)!==l.c.join(r)))for(h=e.replace(Ii,"1").split(dn),c=h.length-1;o<c;o++)r+=h[o]+(~a.indexOf(o)?s.shift()||n+"0,0,0,0)":(l.length?l:s.length?s:i).shift());if(!h)for(h=e.split(Ii),c=h.length-1;o<c;o++)r+=h[o]+s[o];return r+h[c]},Ii=function(){var y="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Mn)y+="|"+e+"\\b";return new RegExp(y+")","gi")}(),Ll=/hsl[a]?\(/,Io=function(e){var t=e.join(" "),i;if(Ii.lastIndex=0,Ii.test(t))return i=Ll.test(t),e[1]=Ss(e[1],i),e[0]=Ss(e[0],i,Fo(e[1])),!0},On,kt=function(){var y=Date.now,e=500,t=33,i=y(),r=i,s=1e3/240,n=s,o=[],a,h,l,c,u,d,p=function f(v){var m=y()-r,g=v===!0,_,w,x,E;if((m>e||m<0)&&(i+=m-t),r+=m,x=r-i,_=x-n,(_>0||g)&&(E=++c.frame,u=x-c.time*1e3,c.time=x=x/1e3,n+=_+(_>=s?4:s-_),w=1),g||(a=h(f)),w)for(d=0;d<o.length;d++)o[d](x,u,E,v)};return c={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(v){return u/(1e3/(v||60))},wake:function(){ho&&(!Fr&&Jr()&&(ni=Fr=window,es=ni.document||{},Ot.gsap=Pt,(ni.gsapVersions||(ni.gsapVersions=[])).push(Pt.version),uo(er||ni.GreenSockGlobals||!ni.gsap&&ni||{}),Po.forEach(Lo)),l=typeof requestAnimationFrame<"u"&&requestAnimationFrame,a&&c.sleep(),h=l||function(v){return setTimeout(v,n-c.time*1e3+1|0)},On=1,p(2))},sleep:function(){(l?cancelAnimationFrame:clearTimeout)(a),On=0,h=zn},lagSmoothing:function(v,m){e=v||1/0,t=Math.min(m||33,e)},fps:function(v){s=1e3/(v||240),n=c.time*1e3+s},add:function(v,m,g){var _=m?function(w,x,E,L){v(w,x,E,L),c.remove(_)}:v;return c.remove(v),o[g?"unshift":"push"](_),xn(),_},remove:function(v,m){~(m=o.indexOf(v))&&o.splice(m,1)&&d>=m&&d--},_listeners:o},c}(),xn=function(){return!On&&kt.wake()},Re={},Bl=/^[\d.\-M][\d.\-,\s]/,Fl=/["']/g,Il=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),r=i[0],s=1,n=i.length,o,a,h;s<n;s++)a=i[s],o=s!==n-1?a.lastIndexOf(","):a.length,h=a.substr(0,o),t[r]=isNaN(h)?h.replace(Fl,"").trim():+h,r=a.substr(o+1).trim();return t},kl=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),r=e.indexOf("(",t);return e.substring(t,~r&&r<i?e.indexOf(")",i+1):i)},zl=function(e){var t=(e+"").split("("),i=Re[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[Il(t[1])]:kl(e).split(",").map(go)):Re._CE&&Bl.test(e)?Re._CE("",e):i},ko=function(e){return function(t){return 1-e(1-t)}},zo=function y(e,t){for(var i=e._first,r;i;)i instanceof gt?y(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?y(i.timeline,t):(r=i._ease,i._ease=i._yEase,i._yEase=r,i._yoyo=t)),i=i._next},tn=function(e,t){return e&&(Ke(e)?e:Re[e]||zl(e))||t},ln=function(e,t,i,r){i===void 0&&(i=function(a){return 1-t(1-a)}),r===void 0&&(r=function(a){return a<.5?t(a*2)/2:1-t((1-a)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:r},n;return Ct(e,function(o){Re[o]=Ot[o]=s,Re[n=o.toLowerCase()]=i;for(var a in s)Re[n+(a==="easeIn"?".in":a==="easeOut"?".out":".inOut")]=Re[o+"."+a]=s[a]}),s},No=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},wr=function y(e,t,i){var r=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),n=s/Lr*(Math.asin(1/r)||0),o=function(l){return l===1?1:r*Math.pow(2,-10*l)*hl((l-n)*s)+1},a=e==="out"?o:e==="in"?function(h){return 1-o(1-h)}:No(o);return s=Lr/s,a.config=function(h,l){return y(e,h,l)},a},_r=function y(e,t){t===void 0&&(t=1.70158);var i=function(n){return n?--n*n*((t+1)*n+t)+1:0},r=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:No(i);return r.config=function(s){return y(e,s)},r};Ct("Linear,Quad,Cubic,Quart,Quint,Strong",function(y,e){var t=e<5?e+1:e;ln(y+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});Re.Linear.easeNone=Re.none=Re.Linear.easeIn;ln("Elastic",wr("in"),wr("out"),wr());(function(y,e){var t=1/e,i=2*t,r=2.5*t,s=function(o){return o<t?y*o*o:o<i?y*Math.pow(o-1.5/e,2)+.75:o<r?y*(o-=2.25/e)*o+.9375:y*Math.pow(o-2.625/e,2)+.984375};ln("Bounce",function(n){return 1-s(1-n)},s)})(7.5625,2.75);ln("Expo",function(y){return y?Math.pow(2,10*(y-1)):0});ln("Circ",function(y){return-(so(1-y*y)-1)});ln("Sine",function(y){return y===1?1:-cl(y*al)+1});ln("Back",_r("in"),_r("out"),_r());Re.SteppedEase=Re.steps=Ot.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,r=e+(t?0:1),s=t?1:0,n=1-We;return function(o){return((r*Un(0,n,o)|0)+s)*i}}};yn.ease=Re["quad.out"];Ct("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(y){return ns+=y+","+y+"Params,"});var Oo=function(e,t){this.id=ll++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:vo,this.set=t?t.getSetter:ls},Vn=function(){function y(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,_n(this,+t.duration,1,1),this.data=t.data,qe&&(this._ctx=qe,qe.data.push(this)),On||kt.wake()}var e=y.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,_n(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,r){if(xn(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(pr(this,i),!s._dp||s.parent||_o(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&ri(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!r||this._initted&&Math.abs(this._zTime)===We||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),mo(this,i,r)),this},e.time=function(i,r){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+bs(this))%(this._dur+this._rDelay)||(i?this._dur:0),r):this._time},e.totalProgress=function(i,r){return arguments.length?this.totalTime(this.totalDuration()*i,r):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(i,r){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+bs(this),r):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,r){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,r):this._repeat?wn(this._tTime,s)+1:1},e.timeScale=function(i,r){if(!arguments.length)return this._rts===-We?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?nr(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-We?0:this._rts,this.totalTime(Un(-Math.abs(this._delay),this._tDur,s),r!==!1),dr(this),gl(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(xn(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==We&&(this._tTime-=We)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var r=this.parent||this._dp;return r&&(r._sort||!this.parent)&&ri(r,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(St(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var r=this.parent||this._dp;return r?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?nr(r.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=pl);var r=ut;return ut=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),ut=r,this},e.globalTime=function(i){for(var r=this,s=arguments.length?i:r.rawTime();r;)s=r._start+s/(Math.abs(r._ts)||1),r=r._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,Ts(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var r=this._time;return this._rDelay=i,Ts(this),r?this.time(r):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,r){return this.totalTime($t(this,i),St(r))},e.restart=function(i,r){return this.play().totalTime(i?-this._delay:0,St(r))},e.play=function(i,r){return i!=null&&this.seek(i,r),this.reversed(!1).paused(!1)},e.reverse=function(i,r){return i!=null&&this.seek(i||this.totalDuration(),r),this.reversed(!0).paused(!1)},e.pause=function(i,r){return i!=null&&this.seek(i,r),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-We:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-We,this},e.isActive=function(){var i=this.parent||this._dp,r=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=r&&s<this.endTime(!0)-We)},e.eventCallback=function(i,r,s){var n=this.vars;return arguments.length>1?(r?(n[i]=r,s&&(n[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=r)):delete n[i],this):n[i]},e.then=function(i){var r=this;return new Promise(function(s){var n=Ke(i)?i:yo,o=function(){var h=r.then;r.then=null,Ke(n)&&(n=n(r))&&(n.then||n===r)&&(r.then=h),s(n),r.then=h};r._initted&&r.totalProgress()===1&&r._ts>=0||!r._tTime&&r._ts<0?o():r._prom=o})},e.kill=function(){Cn(this)},y}();Kt(Vn.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-We,_prom:0,_ps:!1,_rts:1});var gt=function(y){ro(e,y);function e(i,r){var s;return i===void 0&&(i={}),s=y.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=St(i.sortChildren),$e&&ri(i.parent||$e,wi(s),r),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&xo(wi(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(r,s,n){return Bn(0,arguments,this),this},t.from=function(r,s,n){return Bn(1,arguments,this),this},t.fromTo=function(r,s,n,o){return Bn(2,arguments,this),this},t.set=function(r,s,n){return s.duration=0,s.parent=this,Ln(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new Ze(r,s,$t(this,n),1),this},t.call=function(r,s,n){return ri(this,Ze.delayedCall(0,r,s),n)},t.staggerTo=function(r,s,n,o,a,h,l){return n.duration=s,n.stagger=n.stagger||o,n.onComplete=h,n.onCompleteParams=l,n.parent=this,new Ze(r,n,$t(this,a)),this},t.staggerFrom=function(r,s,n,o,a,h,l){return n.runBackwards=1,Ln(n).immediateRender=St(n.immediateRender),this.staggerTo(r,s,n,o,a,h,l)},t.staggerFromTo=function(r,s,n,o,a,h,l,c){return o.startAt=n,Ln(o).immediateRender=St(o.immediateRender),this.staggerTo(r,s,o,a,h,l,c)},t.render=function(r,s,n){var o=this._time,a=this._dirty?this.totalDuration():this._tDur,h=this._dur,l=r<=0?0:it(r),c=this._zTime<0!=r<0&&(this._initted||!h),u,d,p,f,v,m,g,_,w,x,E,L;if(this!==$e&&l>a&&r>=0&&(l=a),l!==this._tTime||n||c){if(o!==this._time&&h&&(l+=this._time-o,r+=this._time-o),u=l,w=this._start,_=this._ts,m=!_,c&&(h||(o=this._zTime),(r||!s)&&(this._zTime=r)),this._repeat){if(E=this._yoyo,v=h+this._rDelay,this._repeat<-1&&r<0)return this.totalTime(v*100+r,s,n);if(u=it(l%v),l===a?(f=this._repeat,u=h):(f=~~(l/v),f&&f===l/v&&(u=h,f--),u>h&&(u=h)),x=wn(this._tTime,v),!o&&this._tTime&&x!==f&&this._tTime-x*v-this._dur<=0&&(x=f),E&&f&1&&(u=h-u,L=1),f!==x&&!this._lock){var A=E&&x&1,T=A===(E&&f&1);if(f<x&&(A=!A),o=A?0:l%h?h:l,this._lock=1,this.render(o||(L?0:it(f*v)),s,!h)._lock=0,this._tTime=l,!s&&this.parent&&zt(this,"onRepeat"),this.vars.repeatRefresh&&!L&&(this.invalidate()._lock=1),o&&o!==this._time||m!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,a=this._tDur,T&&(this._lock=2,o=A?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!L&&this.invalidate()),this._lock=0,!this._ts&&!m)return this;zo(this,L)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(g=xl(this,it(o),it(u)),g&&(l-=u-(u=g._start))),this._tTime=l,this._time=u,this._act=!_,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=r,o=0),!o&&u&&!s&&!f&&(zt(this,"onStart"),this._tTime!==l))return this;if(u>=o&&r>=0)for(d=this._first;d;){if(p=d._next,(d._act||u>=d._start)&&d._ts&&g!==d){if(d.parent!==this)return this.render(r,s,n);if(d.render(d._ts>0?(u-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(u-d._start)*d._ts,s,n),u!==this._time||!this._ts&&!m){g=0,p&&(l+=this._zTime=-We);break}}d=p}else{d=this._last;for(var R=r<0?r:u;d;){if(p=d._prev,(d._act||R<=d._end)&&d._ts&&g!==d){if(d.parent!==this)return this.render(r,s,n);if(d.render(d._ts>0?(R-d._start)*d._ts:(d._dirty?d.totalDuration():d._tDur)+(R-d._start)*d._ts,s,n||ut&&(d._initted||d._startAt)),u!==this._time||!this._ts&&!m){g=0,p&&(l+=this._zTime=R?-We:We);break}}d=p}}if(g&&!s&&(this.pause(),g.render(u>=o?0:-We)._zTime=u>=o?1:-1,this._ts))return this._start=w,dr(this),this.render(r,s,n);this._onUpdate&&!s&&zt(this,"onUpdate",!0),(l===a&&this._tTime>=this.totalDuration()||!l&&o)&&(w===this._start||Math.abs(_)!==Math.abs(this._ts))&&(this._lock||((r||!h)&&(l===a&&this._ts>0||!l&&this._ts<0)&&Ni(this,1),!s&&!(r<0&&!o)&&(l||o||!a)&&(zt(this,l===a&&r>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(l<a&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(r,s){var n=this;if(Ai(s)||(s=$t(this,s,r)),!(r instanceof Vn)){if(dt(r))return r.forEach(function(o){return n.add(o,s)}),this;if(rt(r))return this.addLabel(r,s);if(Ke(r))r=Ze.delayedCall(0,r);else return this}return this!==r?ri(this,r,s):this},t.getChildren=function(r,s,n,o){r===void 0&&(r=!0),s===void 0&&(s=!0),n===void 0&&(n=!0),o===void 0&&(o=-Yt);for(var a=[],h=this._first;h;)h._start>=o&&(h instanceof Ze?s&&a.push(h):(n&&a.push(h),r&&a.push.apply(a,h.getChildren(!0,s,n)))),h=h._next;return a},t.getById=function(r){for(var s=this.getChildren(1,1,1),n=s.length;n--;)if(s[n].vars.id===r)return s[n]},t.remove=function(r){return rt(r)?this.removeLabel(r):Ke(r)?this.killTweensOf(r):(ur(this,r),r===this._recent&&(this._recent=this._last),en(this))},t.totalTime=function(r,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=it(kt.time-(this._ts>0?r/this._ts:(this.totalDuration()-r)/-this._ts))),y.prototype.totalTime.call(this,r,s),this._forcing=0,this):this._tTime},t.addLabel=function(r,s){return this.labels[r]=$t(this,s),this},t.removeLabel=function(r){return delete this.labels[r],this},t.addPause=function(r,s,n){var o=Ze.delayedCall(0,s||zn,n);return o.data="isPause",this._hasPause=1,ri(this,o,$t(this,r))},t.removePause=function(r){var s=this._first;for(r=$t(this,r);s;)s._start===r&&s.data==="isPause"&&Ni(s),s=s._next},t.killTweensOf=function(r,s,n){for(var o=this.getTweensOf(r,n),a=o.length;a--;)Ri!==o[a]&&o[a].kill(r,s);return this},t.getTweensOf=function(r,s){for(var n=[],o=jt(r),a=this._first,h=Ai(s),l;a;)a instanceof Ze?fl(a._targets,o)&&(h?(!Ri||a._initted&&a._ts)&&a.globalTime(0)<=s&&a.globalTime(a.totalDuration())>s:!s||a.isActive())&&n.push(a):(l=a.getTweensOf(o,s)).length&&n.push.apply(n,l),a=a._next;return n},t.tweenTo=function(r,s){s=s||{};var n=this,o=$t(n,r),a=s,h=a.startAt,l=a.onStart,c=a.onStartParams,u=a.immediateRender,d,p=Ze.to(n,Kt({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:s.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale())||We,onStart:function(){if(n.pause(),!d){var v=s.duration||Math.abs((o-(h&&"time"in h?h.time:n._time))/n.timeScale());p._dur!==v&&_n(p,v,0,1).render(p._time,!0,!0),d=1}l&&l.apply(p,c||[])}},s));return u?p.render(0):p},t.tweenFromTo=function(r,s,n){return this.tweenTo(s,Kt({startAt:{time:$t(this,r)}},n))},t.recent=function(){return this._recent},t.nextLabel=function(r){return r===void 0&&(r=this._time),Es(this,$t(this,r))},t.previousLabel=function(r){return r===void 0&&(r=this._time),Es(this,$t(this,r),1)},t.currentLabel=function(r){return arguments.length?this.seek(r,!0):this.previousLabel(this._time+We)},t.shiftChildren=function(r,s,n){n===void 0&&(n=0);for(var o=this._first,a=this.labels,h;o;)o._start>=n&&(o._start+=r,o._end+=r),o=o._next;if(s)for(h in a)a[h]>=n&&(a[h]+=r);return en(this)},t.invalidate=function(r){var s=this._first;for(this._lock=0;s;)s.invalidate(r),s=s._next;return y.prototype.invalidate.call(this,r)},t.clear=function(r){r===void 0&&(r=!0);for(var s=this._first,n;s;)n=s._next,this.remove(s),s=n;return this._dp&&(this._time=this._tTime=this._pTime=0),r&&(this.labels={}),en(this)},t.totalDuration=function(r){var s=0,n=this,o=n._last,a=Yt,h,l,c;if(arguments.length)return n.timeScale((n._repeat<0?n.duration():n.totalDuration())/(n.reversed()?-r:r));if(n._dirty){for(c=n.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),l=o._start,l>a&&n._sort&&o._ts&&!n._lock?(n._lock=1,ri(n,o,l-o._delay,1)._lock=0):a=l,l<0&&o._ts&&(s-=l,(!c&&!n._dp||c&&c.smoothChildTiming)&&(n._start+=l/n._ts,n._time-=l,n._tTime-=l),n.shiftChildren(-l,!1,-1/0),a=0),o._end>s&&o._ts&&(s=o._end),o=h;_n(n,n===$e&&n._time>s?n._time:s,1,1),n._dirty=0}return n._tDur},e.updateRoot=function(r){if($e._ts&&(mo($e,nr(r,$e)),fo=kt.frame),kt.frame>=xs){xs+=Nt.autoSleep||120;var s=$e._first;if((!s||!s._ts)&&Nt.autoSleep&&kt._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||kt.sleep()}}},e}(Vn);Kt(gt.prototype,{_lock:0,_hasPause:0,_forcing:0});var Nl=function(e,t,i,r,s,n,o){var a=new Mt(this._pt,e,t,0,1,Uo,null,s),h=0,l=0,c,u,d,p,f,v,m,g;for(a.b=i,a.e=r,i+="",r+="",(m=~r.indexOf("random("))&&(r=Nn(r)),n&&(g=[i,r],n(g,e,t),i=g[0],r=g[1]),u=i.match(mr)||[];c=mr.exec(r);)p=c[0],f=r.substring(h,c.index),d?d=(d+1)%5:f.substr(-5)==="rgba("&&(d=1),p!==u[l++]&&(v=parseFloat(u[l-1])||0,a._pt={_next:a._pt,p:f||l===1?f:",",s:v,c:p.charAt(1)==="="?fn(v,p)-v:parseFloat(p)-v,m:d&&d<4?Math.round:0},h=mr.lastIndex);return a.c=h<r.length?r.substring(h,r.length):"",a.fp=o,(lo.test(r)||m)&&(a.e=0),this._pt=a,a},ss=function(e,t,i,r,s,n,o,a,h,l){Ke(r)&&(r=r(s||0,e,n));var c=e[t],u=i!=="get"?i:Ke(c)?h?e[t.indexOf("set")||!Ke(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():c,d=Ke(c)?h?Gl:Go:as,p;if(rt(r)&&(~r.indexOf("random(")&&(r=Nn(r)),r.charAt(1)==="="&&(p=fn(u,r)+(ht(u)||0),(p||p===0)&&(r=p))),!l||u!==r||Dr)return!isNaN(u*r)&&r!==""?(p=new Mt(this._pt,e,t,+u||0,r-(u||0),typeof c=="boolean"?Ul:Ho,0,d),h&&(p.fp=h),o&&p.modifier(o,this,e),this._pt=p):(!c&&!(t in e)&&ts(t,r),Nl.call(this,e,t,u,r,d,a||Nt.stringFilter,h))},Ol=function(e,t,i,r,s){if(Ke(e)&&(e=Fn(e,s,t,i,r)),!ci(e)||e.style&&e.nodeType||dt(e)||oo(e))return rt(e)?Fn(e,s,t,i,r):e;var n={},o;for(o in e)n[o]=Fn(e[o],s,t,i,r);return n},Vo=function(e,t,i,r,s,n){var o,a,h,l;if(Ft[e]&&(o=new Ft[e]).init(s,o.rawVars?t[e]:Ol(t[e],r,s,n,i),i,r,n)!==!1&&(i._pt=a=new Mt(i._pt,s,e,0,1,o.render,o,0,o.priority),i!==pn))for(h=i._ptLookup[i._targets.indexOf(s)],l=o._props.length;l--;)h[o._props[l]]=a;return o},Ri,Dr,os=function y(e,t,i){var r=e.vars,s=r.ease,n=r.startAt,o=r.immediateRender,a=r.lazy,h=r.onUpdate,l=r.runBackwards,c=r.yoyoEase,u=r.keyframes,d=r.autoRevert,p=e._dur,f=e._startAt,v=e._targets,m=e.parent,g=m&&m.data==="nested"?m.vars.targets:v,_=e._overwrite==="auto"&&!Qr,w=e.timeline,x,E,L,A,T,R,C,B,F,W,G,j,z;if(w&&(!u||!s)&&(s="none"),e._ease=tn(s,yn.ease),e._yEase=c?ko(tn(c===!0?s:c,yn.ease)):0,c&&e._yoyo&&!e._repeat&&(c=e._yEase,e._yEase=e._ease,e._ease=c),e._from=!w&&!!r.runBackwards,!w||u&&!r.stagger){if(B=v[0]?Ji(v[0]).harness:0,j=B&&r[B.prop],x=ir(r,is),f&&(f._zTime<0&&f.progress(1),t<0&&l&&o&&!d?f.render(-1,!0):f.revert(l&&p?jn:dl),f._lazy=0),n){if(Ni(e._startAt=Ze.set(v,Kt({data:"isStart",overwrite:!1,parent:m,immediateRender:!0,lazy:!f&&St(a),startAt:null,delay:0,onUpdate:h&&function(){return zt(e,"onUpdate")},stagger:0},n))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ut||!o&&!d)&&e._startAt.revert(jn),o&&p&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(l&&p&&!f){if(t&&(o=!1),L=Kt({overwrite:!1,data:"isFromStart",lazy:o&&!f&&St(a),immediateRender:o,stagger:0,parent:m},x),j&&(L[B.prop]=j),Ni(e._startAt=Ze.set(v,L)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ut?e._startAt.revert(jn):e._startAt.render(-1,!0)),e._zTime=t,!o)y(e._startAt,We,We);else if(!t)return}for(e._pt=e._ptCache=0,a=p&&St(a)||a&&!p,E=0;E<v.length;E++){if(T=v[E],C=T._gsap||rs(v)[E]._gsap,e._ptLookup[E]=W={},Ir[C.id]&&Fi.length&&tr(),G=g===v?E:g.indexOf(T),B&&(F=new B).init(T,j||x,e,G,g)!==!1&&(e._pt=A=new Mt(e._pt,T,F.name,0,1,F.render,F,0,F.priority),F._props.forEach(function(I){W[I]=A}),F.priority&&(R=1)),!B||j)for(L in x)Ft[L]&&(F=Vo(L,x,e,G,T,g))?F.priority&&(R=1):W[L]=A=ss.call(e,T,L,"get",x[L],G,g,0,r.stringFilter);e._op&&e._op[E]&&e.kill(T,e._op[E]),_&&e._pt&&(Ri=e,$e.killTweensOf(T,W,e.globalTime(t)),z=!e.parent,Ri=0),e._pt&&a&&(Ir[C.id]=1)}R&&qo(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!z,u&&t<=0&&w.render(Yt,!0,!0)},Vl=function(e,t,i,r,s,n,o,a){var h=(e._pt&&e._ptCache||(e._ptCache={}))[t],l,c,u,d;if(!h)for(h=e._ptCache[t]=[],u=e._ptLookup,d=e._targets.length;d--;){if(l=u[d][t],l&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return Dr=1,e.vars[t]="+=0",os(e,o),Dr=0,a?kn(t+" not eligible for reset"):1;h.push(l)}for(d=h.length;d--;)c=h[d],l=c._pt||c,l.s=(r||r===0)&&!s?r:l.s+(r||0)+n*l.c,l.c=i-l.s,c.e&&(c.e=Qe(i)+ht(c.e)),c.b&&(c.b=l.s+ht(c.b))},Dl=function(e,t){var i=e[0]?Ji(e[0]).harness:0,r=i&&i.aliases,s,n,o,a;if(!r)return t;s=sn({},t);for(n in r)if(n in s)for(a=r[n].split(","),o=a.length;o--;)s[a[o]]=s[n];return s},Wl=function(e,t,i,r){var s=t.ease||r||"power1.inOut",n,o;if(dt(t))o=i[e]||(i[e]=[]),t.forEach(function(a,h){return o.push({t:h/(t.length-1)*100,v:a,e:s})});else for(n in t)o=i[n]||(i[n]=[]),n==="ease"||o.push({t:parseFloat(e),v:t[n],e:s})},Fn=function(e,t,i,r,s){return Ke(e)?e.call(t,i,r,s):rt(e)&&~e.indexOf("random(")?Nn(e):e},Do=ns+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Wo={};Ct(Do+",id,stagger,delay,duration,paused,scrollTrigger",function(y){return Wo[y]=1});var Ze=function(y){ro(e,y);function e(i,r,s,n){var o;typeof r=="number"&&(s.duration=r,r=s,s=null),o=y.call(this,n?r:Ln(r))||this;var a=o.vars,h=a.duration,l=a.delay,c=a.immediateRender,u=a.stagger,d=a.overwrite,p=a.keyframes,f=a.defaults,v=a.scrollTrigger,m=a.yoyoEase,g=r.parent||$e,_=(dt(i)||oo(i)?Ai(i[0]):"length"in r)?[i]:jt(i),w,x,E,L,A,T,R,C;if(o._targets=_.length?rs(_):kn("GSAP target "+i+" not found. https://gsap.com",!Nt.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=d,p||u||Xn(h)||Xn(l)){if(r=o.vars,w=o.timeline=new gt({data:"nested",defaults:f||{},targets:g&&g.data==="nested"?g.vars.targets:_}),w.kill(),w.parent=w._dp=wi(o),w._start=0,u||Xn(h)||Xn(l)){if(L=_.length,R=u&&Eo(u),ci(u))for(A in u)~Do.indexOf(A)&&(C||(C={}),C[A]=u[A]);for(x=0;x<L;x++)E=ir(r,Wo),E.stagger=0,m&&(E.yoyoEase=m),C&&sn(E,C),T=_[x],E.duration=+Fn(h,wi(o),x,T,_),E.delay=(+Fn(l,wi(o),x,T,_)||0)-o._delay,!u&&L===1&&E.delay&&(o._delay=l=E.delay,o._start+=l,E.delay=0),w.to(T,E,R?R(x,T,_):0),w._ease=Re.none;w.duration()?h=l=0:o.timeline=0}else if(p){Ln(Kt(w.vars.defaults,{ease:"none"})),w._ease=tn(p.ease||r.ease||"none");var B=0,F,W,G;if(dt(p))p.forEach(function(j){return w.to(_,j,">")}),w.duration();else{E={};for(A in p)A==="ease"||A==="easeEach"||Wl(A,p[A],E,p.easeEach);for(A in E)for(F=E[A].sort(function(j,z){return j.t-z.t}),B=0,x=0;x<F.length;x++)W=F[x],G={ease:W.e,duration:(W.t-(x?F[x-1].t:0))/100*h},G[A]=W.v,w.to(_,G,B),B+=G.duration;w.duration()<h&&w.to({},{duration:h-w.duration()})}}h||o.duration(h=w.duration())}else o.timeline=0;return d===!0&&!Qr&&(Ri=wi(o),$e.killTweensOf(_),Ri=0),ri(g,wi(o),s),r.reversed&&o.reverse(),r.paused&&o.paused(!0),(c||!h&&!p&&o._start===it(g._time)&&St(c)&&yl(wi(o))&&g.data!=="nested")&&(o._tTime=-We,o.render(Math.max(0,-l)||0)),v&&xo(wi(o),v),o}var t=e.prototype;return t.render=function(r,s,n){var o=this._time,a=this._tDur,h=this._dur,l=r<0,c=r>a-We&&!l?a:r<We?0:r,u,d,p,f,v,m,g,_,w;if(!h)_l(this,r,s,n);else if(c!==this._tTime||!r||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==l){if(u=c,_=this.timeline,this._repeat){if(f=h+this._rDelay,this._repeat<-1&&l)return this.totalTime(f*100+r,s,n);if(u=it(c%f),c===a?(p=this._repeat,u=h):(p=~~(c/f),p&&p===it(c/f)&&(u=h,p--),u>h&&(u=h)),m=this._yoyo&&p&1,m&&(w=this._yEase,u=h-u),v=wn(this._tTime,f),u===o&&!n&&this._initted&&p===v)return this._tTime=c,this;p!==v&&(_&&this._yEase&&zo(_,m),this.vars.repeatRefresh&&!m&&!this._lock&&this._time!==f&&this._initted&&(this._lock=n=1,this.render(it(f*p),!0).invalidate()._lock=0))}if(!this._initted){if(Ao(this,l?r:u,n,s,c))return this._tTime=0,this;if(o!==this._time&&!(n&&this.vars.repeatRefresh&&p!==v))return this;if(h!==this._dur)return this.render(r,s,n)}if(this._tTime=c,this._time=u,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=g=(w||this._ease)(u/h),this._from&&(this.ratio=g=1-g),u&&!o&&!s&&!p&&(zt(this,"onStart"),this._tTime!==c))return this;for(d=this._pt;d;)d.r(g,d.d),d=d._next;_&&_.render(r<0?r:_._dur*_._ease(u/this._dur),s,n)||this._startAt&&(this._zTime=r),this._onUpdate&&!s&&(l&&kr(this,r,s,n),zt(this,"onUpdate")),this._repeat&&p!==v&&this.vars.onRepeat&&!s&&this.parent&&zt(this,"onRepeat"),(c===this._tDur||!c)&&this._tTime===c&&(l&&!this._onUpdate&&kr(this,r,!0,!0),(r||!h)&&(c===this._tDur&&this._ts>0||!c&&this._ts<0)&&Ni(this,1),!s&&!(l&&!o)&&(c||o||m)&&(zt(this,c===a?"onComplete":"onReverseComplete",!0),this._prom&&!(c<a&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(r){return(!r||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(r),y.prototype.invalidate.call(this,r)},t.resetTo=function(r,s,n,o,a){On||kt.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),l;return this._initted||os(this,h),l=this._ease(h/this._dur),Vl(this,r,s,n,o,l,h,a)?this.resetTo(r,s,n,o,1):(pr(this,0),this.parent||wo(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(r,s){if(s===void 0&&(s="all"),!r&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Cn(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(r,s,Ri&&Ri.vars.overwrite!==!0)._first||Cn(this),this.parent&&n!==this.timeline.totalDuration()&&_n(this,this._dur*this.timeline._tDur/n,0,1),this}var o=this._targets,a=r?jt(r):o,h=this._ptLookup,l=this._pt,c,u,d,p,f,v,m;if((!s||s==="all")&&ml(o,a))return s==="all"&&(this._pt=0),Cn(this);for(c=this._op=this._op||[],s!=="all"&&(rt(s)&&(f={},Ct(s,function(g){return f[g]=1}),s=f),s=Dl(o,s)),m=o.length;m--;)if(~a.indexOf(o[m])){u=h[m],s==="all"?(c[m]=s,p=u,d={}):(d=c[m]=c[m]||{},p=s);for(f in p)v=u&&u[f],v&&((!("kill"in v.d)||v.d.kill(f)===!0)&&ur(this,v,"_pt"),delete u[f]),d!=="all"&&(d[f]=1)}return this._initted&&!this._pt&&l&&Cn(this),this},e.to=function(r,s){return new e(r,s,arguments[2])},e.from=function(r,s){return Bn(1,arguments)},e.delayedCall=function(r,s,n,o){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:r,onComplete:s,onReverseComplete:s,onCompleteParams:n,onReverseCompleteParams:n,callbackScope:o})},e.fromTo=function(r,s,n){return Bn(2,arguments)},e.set=function(r,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(r,s)},e.killTweensOf=function(r,s,n){return $e.killTweensOf(r,s,n)},e}(Vn);Kt(Ze.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ct("staggerTo,staggerFrom,staggerFromTo",function(y){Ze[y]=function(){var e=new gt,t=Nr.call(arguments,0);return t.splice(y==="staggerFromTo"?5:4,0,0),e[y].apply(e,t)}});var as=function(e,t,i){return e[t]=i},Go=function(e,t,i){return e[t](i)},Gl=function(e,t,i,r){return e[t](r.fp,i)},Hl=function(e,t,i){return e.setAttribute(t,i)},ls=function(e,t){return Ke(e[t])?Go:Zr(e[t])&&e.setAttribute?Hl:as},Ho=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},Ul=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Uo=function(e,t){var i=t._pt,r="";if(!e&&t.b)r=t.b;else if(e===1&&t.e)r=t.e;else{for(;i;)r=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+r,i=i._next;r+=t.c}t.set(t.t,t.p,r,t)},cs=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},ql=function(e,t,i,r){for(var s=this._pt,n;s;)n=s._next,s.p===r&&s.modifier(e,t,i),s=n},$l=function(e){for(var t=this._pt,i,r;t;)r=t._next,t.p===e&&!t.op||t.op===e?ur(this,t,"_pt"):t.dep||(i=1),t=r;return!i},Xl=function(e,t,i,r){r.mSet(e,t,r.m.call(r.tween,i,r.mt),r)},qo=function(e){for(var t=e._pt,i,r,s,n;t;){for(i=t._next,r=s;r&&r.pr>t.pr;)r=r._next;(t._prev=r?r._prev:n)?t._prev._next=t:s=t,(t._next=r)?r._prev=t:n=t,t=i}e._pt=s},Mt=function(){function y(t,i,r,s,n,o,a,h,l){this.t=i,this.s=s,this.c=n,this.p=r,this.r=o||Ho,this.d=a||this,this.set=h||as,this.pr=l||0,this._next=t,t&&(t._prev=this)}var e=y.prototype;return e.modifier=function(i,r,s){this.mSet=this.mSet||this.set,this.set=Xl,this.m=i,this.mt=s,this.tween=r},y}();Ct(ns+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(y){return is[y]=1});Ot.TweenMax=Ot.TweenLite=Ze;Ot.TimelineLite=Ot.TimelineMax=gt;$e=new gt({sortChildren:!1,defaults:yn,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Nt.stringFilter=Io;var nn=[],Qn={},Yl=[],Cs=0,jl=0,xr=function(e){return(Qn[e]||Yl).map(function(t){return t()})},Wr=function(){var e=Date.now(),t=[];e-Cs>2&&(xr("matchMediaInit"),nn.forEach(function(i){var r=i.queries,s=i.conditions,n,o,a,h;for(o in r)n=ni.matchMedia(r[o]).matches,n&&(a=1),n!==s[o]&&(s[o]=n,h=1);h&&(i.revert(),a&&t.push(i))}),xr("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(r){return i.add(null,r)})}),Cs=e,xr("matchMedia"))},$o=function(){function y(t,i){this.selector=i&&Or(i),this.data=[],this._r=[],this.isReverted=!1,this.id=jl++,t&&this.add(t)}var e=y.prototype;return e.add=function(i,r,s){Ke(i)&&(s=r,r=i,i=Ke);var n=this,o=function(){var h=qe,l=n.selector,c;return h&&h!==n&&h.data.push(n),s&&(n.selector=Or(s)),qe=n,c=r.apply(n,arguments),Ke(c)&&n._r.push(c),qe=h,n.selector=l,n.isReverted=!1,c};return n.last=o,i===Ke?o(n,function(a){return n.add(null,a)}):i?n[i]=o:o},e.ignore=function(i){var r=qe;qe=null,i(this),qe=r},e.getTweens=function(){var i=[];return this.data.forEach(function(r){return r instanceof y?i.push.apply(i,r.getTweens()):r instanceof Ze&&!(r.parent&&r.parent.data==="nested")&&i.push(r)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,r){var s=this;if(i?function(){for(var o=s.getTweens(),a=s.data.length,h;a--;)h=s.data[a],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(l){return o.splice(o.indexOf(l),1)}));for(o.map(function(l){return{g:l._dur||l._delay||l._sat&&!l._sat.vars.immediateRender?l.globalTime(0):-1/0,t:l}}).sort(function(l,c){return c.g-l.g||-1/0}).forEach(function(l){return l.t.revert(i)}),a=s.data.length;a--;)h=s.data[a],h instanceof gt?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof Ze)&&h.revert&&h.revert(i);s._r.forEach(function(l){return l(i,s)}),s.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),r)for(var n=nn.length;n--;)nn[n].id===this.id&&nn.splice(n,1)},e.revert=function(i){this.kill(i||{})},y}(),Kl=function(){function y(t){this.contexts=[],this.scope=t,qe&&qe.data.push(this)}var e=y.prototype;return e.add=function(i,r,s){ci(i)||(i={matches:i});var n=new $o(0,s||this.scope),o=n.conditions={},a,h,l;qe&&!n.selector&&(n.selector=qe.selector),this.contexts.push(n),r=n.add("onMatch",r),n.queries=i;for(h in i)h==="all"?l=1:(a=ni.matchMedia(i[h]),a&&(nn.indexOf(n)<0&&nn.push(n),(o[h]=a.matches)&&(l=1),a.addListener?a.addListener(Wr):a.addEventListener("change",Wr)));return l&&r(n,function(c){return n.add(null,c)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(r){return r.kill(i,!0)})},y}(),rr={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(r){return Lo(r)})},timeline:function(e){return new gt(e)},getTweensOf:function(e,t){return $e.getTweensOf(e,t)},getProperty:function(e,t,i,r){rt(e)&&(e=jt(e)[0]);var s=Ji(e||{}).get,n=i?yo:go;return i==="native"&&(i=""),e&&(t?n((Ft[t]&&Ft[t].get||s)(e,t,i,r)):function(o,a,h){return n((Ft[o]&&Ft[o].get||s)(e,o,a,h))})},quickSetter:function(e,t,i){if(e=jt(e),e.length>1){var r=e.map(function(l){return Pt.quickSetter(l,t,i)}),s=r.length;return function(l){for(var c=s;c--;)r[c](l)}}e=e[0]||{};var n=Ft[t],o=Ji(e),a=o.harness&&(o.harness.aliases||{})[t]||t,h=n?function(l){var c=new n;pn._pt=0,c.init(e,i?l+i:l,pn,0,[e]),c.render(1,c),pn._pt&&cs(1,pn)}:o.set(e,a);return n?h:function(l){return h(e,a,i?l+i:l,o,1)}},quickTo:function(e,t,i){var r,s=Pt.to(e,sn((r={},r[t]="+=0.1",r.paused=!0,r),i||{})),n=function(a,h,l){return s.resetTo(t,a,h,l)};return n.tween=s,n},isTweening:function(e){return $e.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=tn(e.ease,yn.ease)),As(yn,e||{})},config:function(e){return As(Nt,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,r=e.plugins,s=e.defaults,n=e.extendTimeline;(r||"").split(",").forEach(function(o){return o&&!Ft[o]&&!Ot[o]&&kn(t+" effect requires "+o+" plugin.")}),gr[t]=function(o,a,h){return i(jt(o),Kt(a||{},s),h)},n&&(gt.prototype[t]=function(o,a,h){return this.add(gr[t](o,ci(a)?a:(h=a)&&{},this),h)})},registerEase:function(e,t){Re[e]=tn(t)},parseEase:function(e,t){return arguments.length?tn(e,t):Re},getById:function(e){return $e.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new gt(e),r,s;for(i.smoothChildTiming=St(e.smoothChildTiming),$e.remove(i),i._dp=0,i._time=i._tTime=$e._time,r=$e._first;r;)s=r._next,(t||!(!r._dur&&r instanceof Ze&&r.vars.onComplete===r._targets[0]))&&ri(i,r,r._start-r._delay),r=s;return ri($e,i,0),i},context:function(e,t){return e?new $o(e,t):qe},matchMedia:function(e){return new Kl(e)},matchMediaRefresh:function(){return nn.forEach(function(e){var t=e.conditions,i,r;for(r in t)t[r]&&(t[r]=!1,i=1);i&&e.revert()})||Wr()},addEventListener:function(e,t){var i=Qn[e]||(Qn[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Qn[e],r=i&&i.indexOf(t);r>=0&&i.splice(r,1)},utils:{wrap:Ml,wrapYoyo:Rl,distribute:Eo,random:Co,snap:So,normalize:Cl,getUnit:ht,clamp:bl,splitColor:Bo,toArray:jt,selector:Or,mapRange:Ro,pipe:El,unitize:Sl,interpolate:Pl,shuffle:To},install:uo,effects:gr,ticker:kt,updateRoot:gt.updateRoot,plugins:Ft,globalTimeline:$e,core:{PropTween:Mt,globals:po,Tween:Ze,Timeline:gt,Animation:Vn,getCache:Ji,_removeLinkedListItem:ur,reverting:function(){return ut},context:function(e){return e&&qe&&(qe.data.push(e),e._ctx=qe),qe},suppressOverwrites:function(e){return Qr=e}}};Ct("to,from,fromTo,delayedCall,set,killTweensOf",function(y){return rr[y]=Ze[y]});kt.add(gt.updateRoot);pn=rr.to({},{duration:0});var Ql=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},Zl=function(e,t){var i=e._targets,r,s,n;for(r in t)for(s=i.length;s--;)n=e._ptLookup[s][r],n&&(n=n.d)&&(n._pt&&(n=Ql(n,r)),n&&n.modifier&&n.modifier(t[r],e,i[s],r))},Ar=function(e,t){return{name:e,rawVars:1,init:function(r,s,n){n._onInit=function(o){var a,h;if(rt(s)&&(a={},Ct(s,function(l){return a[l]=1}),s=a),t){a={};for(h in s)a[h]=t(s[h]);s=a}Zl(o,s)}}}},Pt=rr.registerPlugin({name:"attr",init:function(e,t,i,r,s){var n,o,a;this.tween=i;for(n in t)a=e.getAttribute(n)||"",o=this.add(e,"setAttribute",(a||0)+"",t[n],r,s,0,0,n),o.op=n,o.b=a,this._props.push(n)},render:function(e,t){for(var i=t._pt;i;)ut?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Ar("roundProps",Vr),Ar("modifiers"),Ar("snap",So))||rr;Ze.version=gt.version=Pt.version="3.12.5";ho=1;Jr()&&xn();Re.Power0;Re.Power1;Re.Power2;Re.Power3;Re.Power4;Re.Linear;Re.Quad;Re.Cubic;Re.Quart;Re.Quint;Re.Strong;Re.Elastic;Re.Back;Re.SteppedEase;Re.Bounce;Re.Sine;Re.Expo;Re.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ms,Pi,vn,hs,Qi,Rs,us,Jl=function(){return typeof window<"u"},bi={},ji=180/Math.PI,mn=Math.PI/180,un=Math.atan2,Ps=1e8,ds=/([A-Z])/g,ec=/(left|right|width|margin|padding|x)/i,tc=/[\s,\(]\S/,si={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Gr=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},ic=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},nc=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},rc=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Xo=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},Yo=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},sc=function(e,t,i){return e.style[t]=i},oc=function(e,t,i){return e.style.setProperty(t,i)},ac=function(e,t,i){return e._gsap[t]=i},lc=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},cc=function(e,t,i,r,s){var n=e._gsap;n.scaleX=n.scaleY=i,n.renderTransform(s,n)},hc=function(e,t,i,r,s){var n=e._gsap;n[t]=i,n.renderTransform(s,n)},Xe="transform",Rt=Xe+"Origin",uc=function y(e,t){var i=this,r=this.target,s=r.style,n=r._gsap;if(e in bi&&s){if(this.tfm=this.tfm||{},e!=="transform")e=si[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=_i(r,o)}):this.tfm[e]=n.x?n[e]:_i(r,e),e===Rt&&(this.tfm.zOrigin=n.zOrigin);else return si.transform.split(",").forEach(function(o){return y.call(i,o,t)});if(this.props.indexOf(Xe)>=0)return;n.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(Rt,t,"")),e=Xe}(s||t)&&this.props.push(e,t,s[e])},jo=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},dc=function(){var e=this.props,t=this.target,i=t.style,r=t._gsap,s,n;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(ds,"-$1").toLowerCase());if(this.tfm){for(n in this.tfm)r[n]=this.tfm[n];r.svg&&(r.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=us(),(!s||!s.isStart)&&!i[Xe]&&(jo(i),r.zOrigin&&i[Rt]&&(i[Rt]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},Ko=function(e,t){var i={target:e,props:[],revert:dc,save:uc};return e._gsap||Pt.core.getCache(e),t&&t.split(",").forEach(function(r){return i.save(r)}),i},Qo,Hr=function(e,t){var i=Pi.createElementNS?Pi.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Pi.createElement(e);return i&&i.style?i:Pi.createElement(e)},ai=function y(e,t,i){var r=getComputedStyle(e);return r[t]||r.getPropertyValue(t.replace(ds,"-$1").toLowerCase())||r.getPropertyValue(t)||!i&&y(e,An(t)||t,1)||""},Ls="O,Moz,ms,Ms,Webkit".split(","),An=function(e,t,i){var r=t||Qi,s=r.style,n=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);n--&&!(Ls[n]+e in s););return n<0?null:(n===3?"ms":n>=0?Ls[n]:"")+e},Ur=function(){Jl()&&window.document&&(Ms=window,Pi=Ms.document,vn=Pi.documentElement,Qi=Hr("div")||{style:{}},Hr("div"),Xe=An(Xe),Rt=Xe+"Origin",Qi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Qo=!!An("perspective"),us=Pt.core.reverting,hs=1)},br=function y(e){var t=Hr("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,r=this.nextSibling,s=this.style.cssText,n;if(vn.appendChild(t),t.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=y}catch{}else this._gsapBBox&&(n=this._gsapBBox());return i&&(r?i.insertBefore(this,r):i.appendChild(this)),vn.removeChild(t),this.style.cssText=s,n},Bs=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Zo=function(e){var t;try{t=e.getBBox()}catch{t=br.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===br||(t=br.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+Bs(e,["x","cx","x1"])||0,y:+Bs(e,["y","cy","y1"])||0,width:0,height:0}:t},Jo=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Zo(e))},on=function(e,t){if(t){var i=e.style,r;t in bi&&t!==Rt&&(t=Xe),i.removeProperty?(r=t.substr(0,2),(r==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(r==="--"?t:t.replace(ds,"-$1").toLowerCase())):i.removeAttribute(t)}},Li=function(e,t,i,r,s,n){var o=new Mt(e._pt,t,i,0,1,n?Yo:Xo);return e._pt=o,o.b=r,o.e=s,e._props.push(i),o},Fs={deg:1,rad:1,turn:1},pc={grid:1,flex:1},Oi=function y(e,t,i,r){var s=parseFloat(i)||0,n=(i+"").trim().substr((s+"").length)||"px",o=Qi.style,a=ec.test(t),h=e.tagName.toLowerCase()==="svg",l=(h?"client":"offset")+(a?"Width":"Height"),c=100,u=r==="px",d=r==="%",p,f,v,m;if(r===n||!s||Fs[r]||Fs[n])return s;if(n!=="px"&&!u&&(s=y(e,t,i,"px")),m=e.getCTM&&Jo(e),(d||n==="%")&&(bi[t]||~t.indexOf("adius")))return p=m?e.getBBox()[a?"width":"height"]:e[l],Qe(d?s/p*c:s/100*p);if(o[a?"width":"height"]=c+(u?n:r),f=~t.indexOf("adius")||r==="em"&&e.appendChild&&!h?e:e.parentNode,m&&(f=(e.ownerSVGElement||{}).parentNode),(!f||f===Pi||!f.appendChild)&&(f=Pi.body),v=f._gsap,v&&d&&v.width&&a&&v.time===kt.time&&!v.uncache)return Qe(s/v.width*c);if(d&&(t==="height"||t==="width")){var g=e.style[t];e.style[t]=c+r,p=e[l],g?e.style[t]=g:on(e,t)}else(d||n==="%")&&!pc[ai(f,"display")]&&(o.position=ai(e,"position")),f===e&&(o.position="static"),f.appendChild(Qi),p=Qi[l],f.removeChild(Qi),o.position="absolute";return a&&d&&(v=Ji(f),v.time=kt.time,v.width=f[l]),Qe(u?p*s/c:p&&s?c/p*s:0)},_i=function(e,t,i,r){var s;return hs||Ur(),t in si&&t!=="transform"&&(t=si[t],~t.indexOf(",")&&(t=t.split(",")[0])),bi[t]&&t!=="transform"?(s=Wn(e,r),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:or(ai(e,Rt))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||r||~(s+"").indexOf("calc("))&&(s=sr[t]&&sr[t](e,t,i)||ai(e,t)||vo(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?Oi(e,t,s,i)+i:s},fc=function(e,t,i,r){if(!i||i==="none"){var s=An(t,e,1),n=s&&ai(e,s,1);n&&n!==i?(t=s,i=n):t==="borderColor"&&(i=ai(e,"borderTopColor"))}var o=new Mt(this._pt,e.style,t,0,1,Uo),a=0,h=0,l,c,u,d,p,f,v,m,g,_,w,x;if(o.b=i,o.e=r,i+="",r+="",r==="auto"&&(f=e.style[t],e.style[t]=r,r=ai(e,t)||r,f?e.style[t]=f:on(e,t)),l=[i,r],Io(l),i=l[0],r=l[1],u=i.match(dn)||[],x=r.match(dn)||[],x.length){for(;c=dn.exec(r);)v=c[0],g=r.substring(a,c.index),p?p=(p+1)%5:(g.substr(-5)==="rgba("||g.substr(-5)==="hsla(")&&(p=1),v!==(f=u[h++]||"")&&(d=parseFloat(f)||0,w=f.substr((d+"").length),v.charAt(1)==="="&&(v=fn(d,v)+w),m=parseFloat(v),_=v.substr((m+"").length),a=dn.lastIndex-_.length,_||(_=_||Nt.units[t]||w,a===r.length&&(r+=_,o.e+=_)),w!==_&&(d=Oi(e,t,f,_)||0),o._pt={_next:o._pt,p:g||h===1?g:",",s:d,c:m-d,m:p&&p<4||t==="zIndex"?Math.round:0});o.c=a<r.length?r.substring(a,r.length):""}else o.r=t==="display"&&r==="none"?Yo:Xo;return lo.test(r)&&(o.e=0),this._pt=o,o},Is={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},vc=function(e){var t=e.split(" "),i=t[0],r=t[1]||"50%";return(i==="top"||i==="bottom"||r==="left"||r==="right")&&(e=i,i=r,r=e),t[0]=Is[i]||i,t[1]=Is[r]||r,t.join(" ")},mc=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,r=i.style,s=t.u,n=i._gsap,o,a,h;if(s==="all"||s===!0)r.cssText="",a=1;else for(s=s.split(","),h=s.length;--h>-1;)o=s[h],bi[o]&&(a=1,o=o==="transformOrigin"?Rt:Xe),on(i,o);a&&(on(i,Xe),n&&(n.svg&&i.removeAttribute("transform"),Wn(i,1),n.uncache=1,jo(r)))}},sr={clearProps:function(e,t,i,r,s){if(s.data!=="isFromStart"){var n=e._pt=new Mt(e._pt,t,i,0,0,mc);return n.u=r,n.pr=-10,n.tween=s,e._props.push(i),1}}},Dn=[1,0,0,1,0,0],ea={},ta=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},ks=function(e){var t=ai(e,Xe);return ta(t)?Dn:t.substr(7).match(ao).map(Qe)},ps=function(e,t){var i=e._gsap||Ji(e),r=e.style,s=ks(e),n,o,a,h;return i.svg&&e.getAttribute("transform")?(a=e.transform.baseVal.consolidate().matrix,s=[a.a,a.b,a.c,a.d,a.e,a.f],s.join(",")==="1,0,0,1,0,0"?Dn:s):(s===Dn&&!e.offsetParent&&e!==vn&&!i.svg&&(a=r.display,r.display="block",n=e.parentNode,(!n||!e.offsetParent)&&(h=1,o=e.nextElementSibling,vn.appendChild(e)),s=ks(e),a?r.display=a:on(e,"display"),h&&(o?n.insertBefore(e,o):n?n.appendChild(e):vn.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},qr=function(e,t,i,r,s,n){var o=e._gsap,a=s||ps(e,!0),h=o.xOrigin||0,l=o.yOrigin||0,c=o.xOffset||0,u=o.yOffset||0,d=a[0],p=a[1],f=a[2],v=a[3],m=a[4],g=a[5],_=t.split(" "),w=parseFloat(_[0])||0,x=parseFloat(_[1])||0,E,L,A,T;i?a!==Dn&&(L=d*v-p*f)&&(A=w*(v/L)+x*(-f/L)+(f*g-v*m)/L,T=w*(-p/L)+x*(d/L)-(d*g-p*m)/L,w=A,x=T):(E=Zo(e),w=E.x+(~_[0].indexOf("%")?w/100*E.width:w),x=E.y+(~(_[1]||_[0]).indexOf("%")?x/100*E.height:x)),r||r!==!1&&o.smooth?(m=w-h,g=x-l,o.xOffset=c+(m*d+g*f)-m,o.yOffset=u+(m*p+g*v)-g):o.xOffset=o.yOffset=0,o.xOrigin=w,o.yOrigin=x,o.smooth=!!r,o.origin=t,o.originIsAbsolute=!!i,e.style[Rt]="0px 0px",n&&(Li(n,o,"xOrigin",h,w),Li(n,o,"yOrigin",l,x),Li(n,o,"xOffset",c,o.xOffset),Li(n,o,"yOffset",u,o.yOffset)),e.setAttribute("data-svg-origin",w+" "+x)},Wn=function(e,t){var i=e._gsap||new Oo(e);if("x"in i&&!t&&!i.uncache)return i;var r=e.style,s=i.scaleX<0,n="px",o="deg",a=getComputedStyle(e),h=ai(e,Rt)||"0",l,c,u,d,p,f,v,m,g,_,w,x,E,L,A,T,R,C,B,F,W,G,j,z,I,q,V,P,k,M,S,b;return l=c=u=f=v=m=g=_=w=0,d=p=1,i.svg=!!(e.getCTM&&Jo(e)),a.translate&&((a.translate!=="none"||a.scale!=="none"||a.rotate!=="none")&&(r[Xe]=(a.translate!=="none"?"translate3d("+(a.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(a.rotate!=="none"?"rotate("+a.rotate+") ":"")+(a.scale!=="none"?"scale("+a.scale.split(" ").join(",")+") ":"")+(a[Xe]!=="none"?a[Xe]:"")),r.scale=r.rotate=r.translate="none"),L=ps(e,i.svg),i.svg&&(i.uncache?(I=e.getBBox(),h=i.xOrigin-I.x+"px "+(i.yOrigin-I.y)+"px",z=""):z=!t&&e.getAttribute("data-svg-origin"),qr(e,z||h,!!z||i.originIsAbsolute,i.smooth!==!1,L)),x=i.xOrigin||0,E=i.yOrigin||0,L!==Dn&&(C=L[0],B=L[1],F=L[2],W=L[3],l=G=L[4],c=j=L[5],L.length===6?(d=Math.sqrt(C*C+B*B),p=Math.sqrt(W*W+F*F),f=C||B?un(B,C)*ji:0,g=F||W?un(F,W)*ji+f:0,g&&(p*=Math.abs(Math.cos(g*mn))),i.svg&&(l-=x-(x*C+E*F),c-=E-(x*B+E*W))):(b=L[6],M=L[7],V=L[8],P=L[9],k=L[10],S=L[11],l=L[12],c=L[13],u=L[14],A=un(b,k),v=A*ji,A&&(T=Math.cos(-A),R=Math.sin(-A),z=G*T+V*R,I=j*T+P*R,q=b*T+k*R,V=G*-R+V*T,P=j*-R+P*T,k=b*-R+k*T,S=M*-R+S*T,G=z,j=I,b=q),A=un(-F,k),m=A*ji,A&&(T=Math.cos(-A),R=Math.sin(-A),z=C*T-V*R,I=B*T-P*R,q=F*T-k*R,S=W*R+S*T,C=z,B=I,F=q),A=un(B,C),f=A*ji,A&&(T=Math.cos(A),R=Math.sin(A),z=C*T+B*R,I=G*T+j*R,B=B*T-C*R,j=j*T-G*R,C=z,G=I),v&&Math.abs(v)+Math.abs(f)>359.9&&(v=f=0,m=180-m),d=Qe(Math.sqrt(C*C+B*B+F*F)),p=Qe(Math.sqrt(j*j+b*b)),A=un(G,j),g=Math.abs(A)>2e-4?A*ji:0,w=S?1/(S<0?-S:S):0),i.svg&&(z=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!ta(ai(e,Xe)),z&&e.setAttribute("transform",z))),Math.abs(g)>90&&Math.abs(g)<270&&(s?(d*=-1,g+=f<=0?180:-180,f+=f<=0?180:-180):(p*=-1,g+=g<=0?180:-180)),t=t||i.uncache,i.x=l-((i.xPercent=l&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-l)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+n,i.y=c-((i.yPercent=c&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-c)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+n,i.z=u+n,i.scaleX=Qe(d),i.scaleY=Qe(p),i.rotation=Qe(f)+o,i.rotationX=Qe(v)+o,i.rotationY=Qe(m)+o,i.skewX=g+o,i.skewY=_+o,i.transformPerspective=w+n,(i.zOrigin=parseFloat(h.split(" ")[2])||!t&&i.zOrigin||0)&&(r[Rt]=or(h)),i.xOffset=i.yOffset=0,i.force3D=Nt.force3D,i.renderTransform=i.svg?yc:Qo?ia:gc,i.uncache=0,i},or=function(e){return(e=e.split(" "))[0]+" "+e[1]},Tr=function(e,t,i){var r=ht(t);return Qe(parseFloat(t)+parseFloat(Oi(e,"x",i+"px",r)))+r},gc=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,ia(e,t)},$i="0deg",Tn="0px",Xi=") ",ia=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,n=i.x,o=i.y,a=i.z,h=i.rotation,l=i.rotationY,c=i.rotationX,u=i.skewX,d=i.skewY,p=i.scaleX,f=i.scaleY,v=i.transformPerspective,m=i.force3D,g=i.target,_=i.zOrigin,w="",x=m==="auto"&&e&&e!==1||m===!0;if(_&&(c!==$i||l!==$i)){var E=parseFloat(l)*mn,L=Math.sin(E),A=Math.cos(E),T;E=parseFloat(c)*mn,T=Math.cos(E),n=Tr(g,n,L*T*-_),o=Tr(g,o,-Math.sin(E)*-_),a=Tr(g,a,A*T*-_+_)}v!==Tn&&(w+="perspective("+v+Xi),(r||s)&&(w+="translate("+r+"%, "+s+"%) "),(x||n!==Tn||o!==Tn||a!==Tn)&&(w+=a!==Tn||x?"translate3d("+n+", "+o+", "+a+") ":"translate("+n+", "+o+Xi),h!==$i&&(w+="rotate("+h+Xi),l!==$i&&(w+="rotateY("+l+Xi),c!==$i&&(w+="rotateX("+c+Xi),(u!==$i||d!==$i)&&(w+="skew("+u+", "+d+Xi),(p!==1||f!==1)&&(w+="scale("+p+", "+f+Xi),g.style[Xe]=w||"translate(0, 0)"},yc=function(e,t){var i=t||this,r=i.xPercent,s=i.yPercent,n=i.x,o=i.y,a=i.rotation,h=i.skewX,l=i.skewY,c=i.scaleX,u=i.scaleY,d=i.target,p=i.xOrigin,f=i.yOrigin,v=i.xOffset,m=i.yOffset,g=i.forceCSS,_=parseFloat(n),w=parseFloat(o),x,E,L,A,T;a=parseFloat(a),h=parseFloat(h),l=parseFloat(l),l&&(l=parseFloat(l),h+=l,a+=l),a||h?(a*=mn,h*=mn,x=Math.cos(a)*c,E=Math.sin(a)*c,L=Math.sin(a-h)*-u,A=Math.cos(a-h)*u,h&&(l*=mn,T=Math.tan(h-l),T=Math.sqrt(1+T*T),L*=T,A*=T,l&&(T=Math.tan(l),T=Math.sqrt(1+T*T),x*=T,E*=T)),x=Qe(x),E=Qe(E),L=Qe(L),A=Qe(A)):(x=c,A=u,E=L=0),(_&&!~(n+"").indexOf("px")||w&&!~(o+"").indexOf("px"))&&(_=Oi(d,"x",n,"px"),w=Oi(d,"y",o,"px")),(p||f||v||m)&&(_=Qe(_+p-(p*x+f*L)+v),w=Qe(w+f-(p*E+f*A)+m)),(r||s)&&(T=d.getBBox(),_=Qe(_+r/100*T.width),w=Qe(w+s/100*T.height)),T="matrix("+x+","+E+","+L+","+A+","+_+","+w+")",d.setAttribute("transform",T),g&&(d.style[Xe]=T)},wc=function(e,t,i,r,s){var n=360,o=rt(s),a=parseFloat(s)*(o&&~s.indexOf("rad")?ji:1),h=a-r,l=r+h+"deg",c,u;return o&&(c=s.split("_")[1],c==="short"&&(h%=n,h!==h%(n/2)&&(h+=h<0?n:-n)),c==="cw"&&h<0?h=(h+n*Ps)%n-~~(h/n)*n:c==="ccw"&&h>0&&(h=(h-n*Ps)%n-~~(h/n)*n)),e._pt=u=new Mt(e._pt,t,i,r,h,ic),u.e=l,u.u="deg",e._props.push(i),u},zs=function(e,t){for(var i in t)e[i]=t[i];return e},_c=function(e,t,i){var r=zs({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",n=i.style,o,a,h,l,c,u,d,p;r.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),n[Xe]=t,o=Wn(i,1),on(i,Xe),i.setAttribute("transform",h)):(h=getComputedStyle(i)[Xe],n[Xe]=t,o=Wn(i,1),n[Xe]=h);for(a in bi)h=r[a],l=o[a],h!==l&&s.indexOf(a)<0&&(d=ht(h),p=ht(l),c=d!==p?Oi(i,a,h,p):parseFloat(h),u=parseFloat(l),e._pt=new Mt(e._pt,o,a,c,u-c,Gr),e._pt.u=p||0,e._props.push(a));zs(o,r)};Ct("padding,margin,Width,Radius",function(y,e){var t="Top",i="Right",r="Bottom",s="Left",n=(e<3?[t,i,r,s]:[t+s,t+i,r+i,r+s]).map(function(o){return e<2?y+o:"border"+o+y});sr[e>1?"border"+y:y]=function(o,a,h,l,c){var u,d;if(arguments.length<4)return u=n.map(function(p){return _i(o,p,h)}),d=u.join(" "),d.split(u[0]).length===5?u[0]:d;u=(l+"").split(" "),d={},n.forEach(function(p,f){return d[p]=u[f]=u[f]||u[(f-1)/2|0]}),o.init(a,d,c)}});var na={name:"css",register:Ur,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,r,s){var n=this._props,o=e.style,a=i.vars.startAt,h,l,c,u,d,p,f,v,m,g,_,w,x,E,L,A;hs||Ur(),this.styles=this.styles||Ko(e),A=this.styles.props,this.tween=i;for(f in t)if(f!=="autoRound"&&(l=t[f],!(Ft[f]&&Vo(f,t,i,r,e,s)))){if(d=typeof l,p=sr[f],d==="function"&&(l=l.call(i,r,e,s),d=typeof l),d==="string"&&~l.indexOf("random(")&&(l=Nn(l)),p)p(this,e,f,l,i)&&(L=1);else if(f.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(f)+"").trim(),l+="",Ii.lastIndex=0,Ii.test(h)||(v=ht(h),m=ht(l)),m?v!==m&&(h=Oi(e,f,h,m)+m):v&&(l+=v),this.add(o,"setProperty",h,l,r,s,0,0,f),n.push(f),A.push(f,0,o[f]);else if(d!=="undefined"){if(a&&f in a?(h=typeof a[f]=="function"?a[f].call(i,r,e,s):a[f],rt(h)&&~h.indexOf("random(")&&(h=Nn(h)),ht(h+"")||h==="auto"||(h+=Nt.units[f]||ht(_i(e,f))||""),(h+"").charAt(1)==="="&&(h=_i(e,f))):h=_i(e,f),u=parseFloat(h),g=d==="string"&&l.charAt(1)==="="&&l.substr(0,2),g&&(l=l.substr(2)),c=parseFloat(l),f in si&&(f==="autoAlpha"&&(u===1&&_i(e,"visibility")==="hidden"&&c&&(u=0),A.push("visibility",0,o.visibility),Li(this,o,"visibility",u?"inherit":"hidden",c?"inherit":"hidden",!c)),f!=="scale"&&f!=="transform"&&(f=si[f],~f.indexOf(",")&&(f=f.split(",")[0]))),_=f in bi,_){if(this.styles.save(f),w||(x=e._gsap,x.renderTransform&&!t.parseTransform||Wn(e,t.parseTransform),E=t.smoothOrigin!==!1&&x.smooth,w=this._pt=new Mt(this._pt,o,Xe,0,1,x.renderTransform,x,0,-1),w.dep=1),f==="scale")this._pt=new Mt(this._pt,x,"scaleY",x.scaleY,(g?fn(x.scaleY,g+c):c)-x.scaleY||0,Gr),this._pt.u=0,n.push("scaleY",f),f+="X";else if(f==="transformOrigin"){A.push(Rt,0,o[Rt]),l=vc(l),x.svg?qr(e,l,0,E,0,this):(m=parseFloat(l.split(" ")[2])||0,m!==x.zOrigin&&Li(this,x,"zOrigin",x.zOrigin,m),Li(this,o,f,or(h),or(l)));continue}else if(f==="svgOrigin"){qr(e,l,1,E,0,this);continue}else if(f in ea){wc(this,x,f,u,g?fn(u,g+l):l);continue}else if(f==="smoothOrigin"){Li(this,x,"smooth",x.smooth,l);continue}else if(f==="force3D"){x[f]=l;continue}else if(f==="transform"){_c(this,l,e);continue}}else f in o||(f=An(f)||f);if(_||(c||c===0)&&(u||u===0)&&!tc.test(l)&&f in o)v=(h+"").substr((u+"").length),c||(c=0),m=ht(l)||(f in Nt.units?Nt.units[f]:v),v!==m&&(u=Oi(e,f,h,m)),this._pt=new Mt(this._pt,_?x:o,f,u,(g?fn(u,g+c):c)-u,!_&&(m==="px"||f==="zIndex")&&t.autoRound!==!1?rc:Gr),this._pt.u=m||0,v!==m&&m!=="%"&&(this._pt.b=h,this._pt.r=nc);else if(f in o)fc.call(this,e,f,h,g?g+l:l);else if(f in e)this.add(e,f,h||e[f],g?g+l:l,r,s);else if(f!=="parseTransform"){ts(f,l);continue}_||(f in o?A.push(f,0,o[f]):A.push(f,1,h||e[f])),n.push(f)}}L&&qo(this)},render:function(e,t){if(t.tween._time||!us())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:_i,aliases:si,getSetter:function(e,t,i){var r=si[t];return r&&r.indexOf(",")<0&&(t=r),t in bi&&t!==Rt&&(e._gsap.x||_i(e,"x"))?i&&Rs===i?t==="scale"?lc:ac:(Rs=i||{})&&(t==="scale"?cc:hc):e.style&&!Zr(e.style[t])?sc:~t.indexOf("-")?oc:ls(e,t)},core:{_removeProperty:on,_getMatrix:ps}};Pt.utils.checkPrefix=An;Pt.core.getStyleSaver=Ko;(function(y,e,t,i){var r=Ct(y+","+e+","+t,function(s){bi[s]=1});Ct(e,function(s){Nt.units[s]="deg",ea[s]=1}),si[r[13]]=y+","+e,Ct(i,function(s){var n=s.split(":");si[n[1]]=r[n[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ct("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(y){Nt.units[y]="px"});Pt.registerPlugin(na);var ar=Pt.registerPlugin(na)||Pt;ar.core.Tween;/**
 * lil-gui
 * https://lil-gui.georgealways.com
 * @version 0.19.2
 * @author George Michael Brower
 * @license MIT
 */class li{constructor(e,t,i,r,s="div"){this.parent=e,this.object=t,this.property=i,this._disabled=!1,this._hidden=!1,this.initialValue=this.getValue(),this.domElement=document.createElement(s),this.domElement.classList.add("controller"),this.domElement.classList.add(r),this.$name=document.createElement("div"),this.$name.classList.add("name"),li.nextNameID=li.nextNameID||0,this.$name.id=`lil-gui-name-${++li.nextNameID}`,this.$widget=document.createElement("div"),this.$widget.classList.add("widget"),this.$disable=this.$widget,this.domElement.appendChild(this.$name),this.domElement.appendChild(this.$widget),this.domElement.addEventListener("keydown",n=>n.stopPropagation()),this.domElement.addEventListener("keyup",n=>n.stopPropagation()),this.parent.children.push(this),this.parent.controllers.push(this),this.parent.$children.appendChild(this.domElement),this._listenCallback=this._listenCallback.bind(this),this.name(i)}name(e){return this._name=e,this.$name.textContent=e,this}onChange(e){return this._onChange=e,this}_callOnChange(){this.parent._callOnChange(this),this._onChange!==void 0&&this._onChange.call(this,this.getValue()),this._changed=!0}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(){this._changed&&(this.parent._callOnFinishChange(this),this._onFinishChange!==void 0&&this._onFinishChange.call(this,this.getValue())),this._changed=!1}reset(){return this.setValue(this.initialValue),this._callOnFinishChange(),this}enable(e=!0){return this.disable(!e)}disable(e=!0){return e===this._disabled?this:(this._disabled=e,this.domElement.classList.toggle("disabled",e),this.$disable.toggleAttribute("disabled",e),this)}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}options(e){const t=this.parent.add(this.object,this.property,e);return t.name(this._name),this.destroy(),t}min(e){return this}max(e){return this}step(e){return this}decimals(e){return this}listen(e=!0){return this._listening=e,this._listenCallbackID!==void 0&&(cancelAnimationFrame(this._listenCallbackID),this._listenCallbackID=void 0),this._listening&&this._listenCallback(),this}_listenCallback(){this._listenCallbackID=requestAnimationFrame(this._listenCallback);const e=this.save();e!==this._listenPrevValue&&this.updateDisplay(),this._listenPrevValue=e}getValue(){return this.object[this.property]}setValue(e){return this.getValue()!==e&&(this.object[this.property]=e,this._callOnChange(),this.updateDisplay()),this}updateDisplay(){return this}load(e){return this.setValue(e),this._callOnFinishChange(),this}save(){return this.getValue()}destroy(){this.listen(!1),this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.controllers.splice(this.parent.controllers.indexOf(this),1),this.parent.$children.removeChild(this.domElement)}}class xc extends li{constructor(e,t,i){super(e,t,i,"boolean","label"),this.$input=document.createElement("input"),this.$input.setAttribute("type","checkbox"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$widget.appendChild(this.$input),this.$input.addEventListener("change",()=>{this.setValue(this.$input.checked),this._callOnFinishChange()}),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.checked=this.getValue(),this}}function $r(y){let e,t;return(e=y.match(/(#|0x)?([a-f0-9]{6})/i))?t=e[2]:(e=y.match(/rgb\(\s*(\d*)\s*,\s*(\d*)\s*,\s*(\d*)\s*\)/))?t=parseInt(e[1]).toString(16).padStart(2,0)+parseInt(e[2]).toString(16).padStart(2,0)+parseInt(e[3]).toString(16).padStart(2,0):(e=y.match(/^#?([a-f0-9])([a-f0-9])([a-f0-9])$/i))&&(t=e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),t?"#"+t:!1}const Ac={isPrimitive:!0,match:y=>typeof y=="string",fromHexString:$r,toHexString:$r},Gn={isPrimitive:!0,match:y=>typeof y=="number",fromHexString:y=>parseInt(y.substring(1),16),toHexString:y=>"#"+y.toString(16).padStart(6,0)},bc={isPrimitive:!1,match:y=>Array.isArray(y),fromHexString(y,e,t=1){const i=Gn.fromHexString(y);e[0]=(i>>16&255)/255*t,e[1]=(i>>8&255)/255*t,e[2]=(i&255)/255*t},toHexString([y,e,t],i=1){i=255/i;const r=y*i<<16^e*i<<8^t*i<<0;return Gn.toHexString(r)}},Tc={isPrimitive:!1,match:y=>Object(y)===y,fromHexString(y,e,t=1){const i=Gn.fromHexString(y);e.r=(i>>16&255)/255*t,e.g=(i>>8&255)/255*t,e.b=(i&255)/255*t},toHexString({r:y,g:e,b:t},i=1){i=255/i;const r=y*i<<16^e*i<<8^t*i<<0;return Gn.toHexString(r)}},Ec=[Ac,Gn,bc,Tc];function Sc(y){return Ec.find(e=>e.match(y))}class Cc extends li{constructor(e,t,i,r){super(e,t,i,"color"),this.$input=document.createElement("input"),this.$input.setAttribute("type","color"),this.$input.setAttribute("tabindex",-1),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$text=document.createElement("input"),this.$text.setAttribute("type","text"),this.$text.setAttribute("spellcheck","false"),this.$text.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$display.appendChild(this.$input),this.$widget.appendChild(this.$display),this.$widget.appendChild(this.$text),this._format=Sc(this.initialValue),this._rgbScale=r,this._initialValueHexString=this.save(),this._textFocused=!1,this.$input.addEventListener("input",()=>{this._setValueFromHexString(this.$input.value)}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$text.addEventListener("input",()=>{const s=$r(this.$text.value);s&&this._setValueFromHexString(s)}),this.$text.addEventListener("focus",()=>{this._textFocused=!0,this.$text.select()}),this.$text.addEventListener("blur",()=>{this._textFocused=!1,this.updateDisplay(),this._callOnFinishChange()}),this.$disable=this.$text,this.updateDisplay()}reset(){return this._setValueFromHexString(this._initialValueHexString),this}_setValueFromHexString(e){if(this._format.isPrimitive){const t=this._format.fromHexString(e);this.setValue(t)}else this._format.fromHexString(e,this.getValue(),this._rgbScale),this._callOnChange(),this.updateDisplay()}save(){return this._format.toHexString(this.getValue(),this._rgbScale)}load(e){return this._setValueFromHexString(e),this._callOnFinishChange(),this}updateDisplay(){return this.$input.value=this._format.toHexString(this.getValue(),this._rgbScale),this._textFocused||(this.$text.value=this.$input.value.substring(1)),this.$display.style.backgroundColor=this.$input.value,this}}class Er extends li{constructor(e,t,i){super(e,t,i,"function"),this.$button=document.createElement("button"),this.$button.appendChild(this.$name),this.$widget.appendChild(this.$button),this.$button.addEventListener("click",r=>{r.preventDefault(),this.getValue().call(this.object),this._callOnChange()}),this.$button.addEventListener("touchstart",()=>{},{passive:!0}),this.$disable=this.$button}}class Mc extends li{constructor(e,t,i,r,s,n){super(e,t,i,"number"),this._initInput(),this.min(r),this.max(s);const o=n!==void 0;this.step(o?n:this._getImplicitStep(),o),this.updateDisplay()}decimals(e){return this._decimals=e,this.updateDisplay(),this}min(e){return this._min=e,this._onUpdateMinMax(),this}max(e){return this._max=e,this._onUpdateMinMax(),this}step(e,t=!0){return this._step=e,this._stepExplicit=t,this}updateDisplay(){const e=this.getValue();if(this._hasSlider){let t=(e-this._min)/(this._max-this._min);t=Math.max(0,Math.min(t,1)),this.$fill.style.width=t*100+"%"}return this._inputFocused||(this.$input.value=this._decimals===void 0?e:e.toFixed(this._decimals)),this}_initInput(){this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("aria-labelledby",this.$name.id),window.matchMedia("(pointer: coarse)").matches&&(this.$input.setAttribute("type","number"),this.$input.setAttribute("step","any")),this.$widget.appendChild(this.$input),this.$disable=this.$input;const t=()=>{let g=parseFloat(this.$input.value);isNaN(g)||(this._stepExplicit&&(g=this._snap(g)),this.setValue(this._clamp(g)))},i=g=>{const _=parseFloat(this.$input.value);isNaN(_)||(this._snapClampSetValue(_+g),this.$input.value=this.getValue())},r=g=>{g.key==="Enter"&&this.$input.blur(),g.code==="ArrowUp"&&(g.preventDefault(),i(this._step*this._arrowKeyMultiplier(g))),g.code==="ArrowDown"&&(g.preventDefault(),i(this._step*this._arrowKeyMultiplier(g)*-1))},s=g=>{this._inputFocused&&(g.preventDefault(),i(this._step*this._normalizeMouseWheel(g)))};let n=!1,o,a,h,l,c;const u=5,d=g=>{o=g.clientX,a=h=g.clientY,n=!0,l=this.getValue(),c=0,window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)},p=g=>{if(n){const _=g.clientX-o,w=g.clientY-a;Math.abs(w)>u?(g.preventDefault(),this.$input.blur(),n=!1,this._setDraggingStyle(!0,"vertical")):Math.abs(_)>u&&f()}if(!n){const _=g.clientY-h;c-=_*this._step*this._arrowKeyMultiplier(g),l+c>this._max?c=this._max-l:l+c<this._min&&(c=this._min-l),this._snapClampSetValue(l+c)}h=g.clientY},f=()=>{this._setDraggingStyle(!1,"vertical"),this._callOnFinishChange(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)},v=()=>{this._inputFocused=!0},m=()=>{this._inputFocused=!1,this.updateDisplay(),this._callOnFinishChange()};this.$input.addEventListener("input",t),this.$input.addEventListener("keydown",r),this.$input.addEventListener("wheel",s,{passive:!1}),this.$input.addEventListener("mousedown",d),this.$input.addEventListener("focus",v),this.$input.addEventListener("blur",m)}_initSlider(){this._hasSlider=!0,this.$slider=document.createElement("div"),this.$slider.classList.add("slider"),this.$fill=document.createElement("div"),this.$fill.classList.add("fill"),this.$slider.appendChild(this.$fill),this.$widget.insertBefore(this.$slider,this.$input),this.domElement.classList.add("hasSlider");const e=(m,g,_,w,x)=>(m-g)/(_-g)*(x-w)+w,t=m=>{const g=this.$slider.getBoundingClientRect();let _=e(m,g.left,g.right,this._min,this._max);this._snapClampSetValue(_)},i=m=>{this._setDraggingStyle(!0),t(m.clientX),window.addEventListener("mousemove",r),window.addEventListener("mouseup",s)},r=m=>{t(m.clientX)},s=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("mousemove",r),window.removeEventListener("mouseup",s)};let n=!1,o,a;const h=m=>{m.preventDefault(),this._setDraggingStyle(!0),t(m.touches[0].clientX),n=!1},l=m=>{m.touches.length>1||(this._hasScrollBar?(o=m.touches[0].clientX,a=m.touches[0].clientY,n=!0):h(m),window.addEventListener("touchmove",c,{passive:!1}),window.addEventListener("touchend",u))},c=m=>{if(n){const g=m.touches[0].clientX-o,_=m.touches[0].clientY-a;Math.abs(g)>Math.abs(_)?h(m):(window.removeEventListener("touchmove",c),window.removeEventListener("touchend",u))}else m.preventDefault(),t(m.touches[0].clientX)},u=()=>{this._callOnFinishChange(),this._setDraggingStyle(!1),window.removeEventListener("touchmove",c),window.removeEventListener("touchend",u)},d=this._callOnFinishChange.bind(this),p=400;let f;const v=m=>{if(Math.abs(m.deltaX)<Math.abs(m.deltaY)&&this._hasScrollBar)return;m.preventDefault();const _=this._normalizeMouseWheel(m)*this._step;this._snapClampSetValue(this.getValue()+_),this.$input.value=this.getValue(),clearTimeout(f),f=setTimeout(d,p)};this.$slider.addEventListener("mousedown",i),this.$slider.addEventListener("touchstart",l,{passive:!1}),this.$slider.addEventListener("wheel",v,{passive:!1})}_setDraggingStyle(e,t="horizontal"){this.$slider&&this.$slider.classList.toggle("active",e),document.body.classList.toggle("lil-gui-dragging",e),document.body.classList.toggle(`lil-gui-${t}`,e)}_getImplicitStep(){return this._hasMin&&this._hasMax?(this._max-this._min)/1e3:.1}_onUpdateMinMax(){!this._hasSlider&&this._hasMin&&this._hasMax&&(this._stepExplicit||this.step(this._getImplicitStep(),!1),this._initSlider(),this.updateDisplay())}_normalizeMouseWheel(e){let{deltaX:t,deltaY:i}=e;return Math.floor(e.deltaY)!==e.deltaY&&e.wheelDelta&&(t=0,i=-e.wheelDelta/120,i*=this._stepExplicit?1:10),t+-i}_arrowKeyMultiplier(e){let t=this._stepExplicit?1:10;return e.shiftKey?t*=10:e.altKey&&(t/=10),t}_snap(e){const t=Math.round(e/this._step)*this._step;return parseFloat(t.toPrecision(15))}_clamp(e){return e<this._min&&(e=this._min),e>this._max&&(e=this._max),e}_snapClampSetValue(e){this.setValue(this._clamp(this._snap(e)))}get _hasScrollBar(){const e=this.parent.root.$children;return e.scrollHeight>e.clientHeight}get _hasMin(){return this._min!==void 0}get _hasMax(){return this._max!==void 0}}class Rc extends li{constructor(e,t,i,r){super(e,t,i,"option"),this.$select=document.createElement("select"),this.$select.setAttribute("aria-labelledby",this.$name.id),this.$display=document.createElement("div"),this.$display.classList.add("display"),this.$select.addEventListener("change",()=>{this.setValue(this._values[this.$select.selectedIndex]),this._callOnFinishChange()}),this.$select.addEventListener("focus",()=>{this.$display.classList.add("focus")}),this.$select.addEventListener("blur",()=>{this.$display.classList.remove("focus")}),this.$widget.appendChild(this.$select),this.$widget.appendChild(this.$display),this.$disable=this.$select,this.options(r)}options(e){return this._values=Array.isArray(e)?e:Object.values(e),this._names=Array.isArray(e)?e:Object.keys(e),this.$select.replaceChildren(),this._names.forEach(t=>{const i=document.createElement("option");i.textContent=t,this.$select.appendChild(i)}),this.updateDisplay(),this}updateDisplay(){const e=this.getValue(),t=this._values.indexOf(e);return this.$select.selectedIndex=t,this.$display.textContent=t===-1?e:this._names[t],this}}class Pc extends li{constructor(e,t,i){super(e,t,i,"string"),this.$input=document.createElement("input"),this.$input.setAttribute("type","text"),this.$input.setAttribute("spellcheck","false"),this.$input.setAttribute("aria-labelledby",this.$name.id),this.$input.addEventListener("input",()=>{this.setValue(this.$input.value)}),this.$input.addEventListener("keydown",r=>{r.code==="Enter"&&this.$input.blur()}),this.$input.addEventListener("blur",()=>{this._callOnFinishChange()}),this.$widget.appendChild(this.$input),this.$disable=this.$input,this.updateDisplay()}updateDisplay(){return this.$input.value=this.getValue(),this}}const Lc=`.lil-gui {
  font-family: var(--font-family);
  font-size: var(--font-size);
  line-height: 1;
  font-weight: normal;
  font-style: normal;
  text-align: left;
  color: var(--text-color);
  user-select: none;
  -webkit-user-select: none;
  touch-action: manipulation;
  --background-color: #1f1f1f;
  --text-color: #ebebeb;
  --title-background-color: #111111;
  --title-text-color: #ebebeb;
  --widget-color: #424242;
  --hover-color: #4f4f4f;
  --focus-color: #595959;
  --number-color: #2cc9ff;
  --string-color: #a2db3c;
  --font-size: 11px;
  --input-font-size: 11px;
  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif;
  --font-family-mono: Menlo, Monaco, Consolas, "Droid Sans Mono", monospace;
  --padding: 4px;
  --spacing: 4px;
  --widget-height: 20px;
  --title-height: calc(var(--widget-height) + var(--spacing) * 1.25);
  --name-width: 45%;
  --slider-knob-width: 2px;
  --slider-input-width: 27%;
  --color-input-width: 27%;
  --slider-input-min-width: 45px;
  --color-input-min-width: 45px;
  --folder-indent: 7px;
  --widget-padding: 0 0 0 3px;
  --widget-border-radius: 2px;
  --checkbox-size: calc(0.75 * var(--widget-height));
  --scrollbar-width: 5px;
}
.lil-gui, .lil-gui * {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}
.lil-gui.root {
  width: var(--width, 245px);
  display: flex;
  flex-direction: column;
  background: var(--background-color);
}
.lil-gui.root > .title {
  background: var(--title-background-color);
  color: var(--title-text-color);
}
.lil-gui.root > .children {
  overflow-x: hidden;
  overflow-y: auto;
}
.lil-gui.root > .children::-webkit-scrollbar {
  width: var(--scrollbar-width);
  height: var(--scrollbar-width);
  background: var(--background-color);
}
.lil-gui.root > .children::-webkit-scrollbar-thumb {
  border-radius: var(--scrollbar-width);
  background: var(--focus-color);
}
@media (pointer: coarse) {
  .lil-gui.allow-touch-styles, .lil-gui.allow-touch-styles .lil-gui {
    --widget-height: 28px;
    --padding: 6px;
    --spacing: 6px;
    --font-size: 13px;
    --input-font-size: 16px;
    --folder-indent: 10px;
    --scrollbar-width: 7px;
    --slider-input-min-width: 50px;
    --color-input-min-width: 65px;
  }
}
.lil-gui.force-touch-styles, .lil-gui.force-touch-styles .lil-gui {
  --widget-height: 28px;
  --padding: 6px;
  --spacing: 6px;
  --font-size: 13px;
  --input-font-size: 16px;
  --folder-indent: 10px;
  --scrollbar-width: 7px;
  --slider-input-min-width: 50px;
  --color-input-min-width: 65px;
}
.lil-gui.autoPlace {
  max-height: 100%;
  position: fixed;
  top: 0;
  right: 15px;
  z-index: 1001;
}

.lil-gui .controller {
  display: flex;
  align-items: center;
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
}
.lil-gui .controller.disabled {
  opacity: 0.5;
}
.lil-gui .controller.disabled, .lil-gui .controller.disabled * {
  pointer-events: none !important;
}
.lil-gui .controller > .name {
  min-width: var(--name-width);
  flex-shrink: 0;
  white-space: pre;
  padding-right: var(--spacing);
  line-height: var(--widget-height);
}
.lil-gui .controller .widget {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
  min-height: var(--widget-height);
}
.lil-gui .controller.string input {
  color: var(--string-color);
}
.lil-gui .controller.boolean {
  cursor: pointer;
}
.lil-gui .controller.color .display {
  width: 100%;
  height: var(--widget-height);
  border-radius: var(--widget-border-radius);
  position: relative;
}
@media (hover: hover) {
  .lil-gui .controller.color .display:hover:before {
    content: " ";
    display: block;
    position: absolute;
    border-radius: var(--widget-border-radius);
    border: 1px solid #fff9;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
  }
}
.lil-gui .controller.color input[type=color] {
  opacity: 0;
  width: 100%;
  height: 100%;
  cursor: pointer;
}
.lil-gui .controller.color input[type=text] {
  margin-left: var(--spacing);
  font-family: var(--font-family-mono);
  min-width: var(--color-input-min-width);
  width: var(--color-input-width);
  flex-shrink: 0;
}
.lil-gui .controller.option select {
  opacity: 0;
  position: absolute;
  width: 100%;
  max-width: 100%;
}
.lil-gui .controller.option .display {
  position: relative;
  pointer-events: none;
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  line-height: var(--widget-height);
  max-width: 100%;
  overflow: hidden;
  word-break: break-all;
  padding-left: 0.55em;
  padding-right: 1.75em;
  background: var(--widget-color);
}
@media (hover: hover) {
  .lil-gui .controller.option .display.focus {
    background: var(--focus-color);
  }
}
.lil-gui .controller.option .display.active {
  background: var(--focus-color);
}
.lil-gui .controller.option .display:after {
  font-family: "lil-gui";
  content: "↕";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  padding-right: 0.375em;
}
.lil-gui .controller.option .widget,
.lil-gui .controller.option select {
  cursor: pointer;
}
@media (hover: hover) {
  .lil-gui .controller.option .widget:hover .display {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number input {
  color: var(--number-color);
}
.lil-gui .controller.number.hasSlider input {
  margin-left: var(--spacing);
  width: var(--slider-input-width);
  min-width: var(--slider-input-min-width);
  flex-shrink: 0;
}
.lil-gui .controller.number .slider {
  width: 100%;
  height: var(--widget-height);
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  padding-right: var(--slider-knob-width);
  overflow: hidden;
  cursor: ew-resize;
  touch-action: pan-y;
}
@media (hover: hover) {
  .lil-gui .controller.number .slider:hover {
    background: var(--hover-color);
  }
}
.lil-gui .controller.number .slider.active {
  background: var(--focus-color);
}
.lil-gui .controller.number .slider.active .fill {
  opacity: 0.95;
}
.lil-gui .controller.number .fill {
  height: 100%;
  border-right: var(--slider-knob-width) solid var(--number-color);
  box-sizing: content-box;
}

.lil-gui-dragging .lil-gui {
  --hover-color: var(--widget-color);
}
.lil-gui-dragging * {
  cursor: ew-resize !important;
}

.lil-gui-dragging.lil-gui-vertical * {
  cursor: ns-resize !important;
}

.lil-gui .title {
  height: var(--title-height);
  line-height: calc(var(--title-height) - 4px);
  font-weight: 600;
  padding: 0 var(--padding);
  -webkit-tap-highlight-color: transparent;
  cursor: pointer;
  outline: none;
  text-decoration-skip: objects;
}
.lil-gui .title:before {
  font-family: "lil-gui";
  content: "▾";
  padding-right: 2px;
  display: inline-block;
}
.lil-gui .title:active {
  background: var(--title-background-color);
  opacity: 0.75;
}
@media (hover: hover) {
  body:not(.lil-gui-dragging) .lil-gui .title:hover {
    background: var(--title-background-color);
    opacity: 0.85;
  }
  .lil-gui .title:focus {
    text-decoration: underline var(--focus-color);
  }
}
.lil-gui.root > .title:focus {
  text-decoration: none !important;
}
.lil-gui.closed > .title:before {
  content: "▸";
}
.lil-gui.closed > .children {
  transform: translateY(-7px);
  opacity: 0;
}
.lil-gui.closed:not(.transition) > .children {
  display: none;
}
.lil-gui.transition > .children {
  transition-duration: 300ms;
  transition-property: height, opacity, transform;
  transition-timing-function: cubic-bezier(0.2, 0.6, 0.35, 1);
  overflow: hidden;
  pointer-events: none;
}
.lil-gui .children:empty:before {
  content: "Empty";
  padding: 0 var(--padding);
  margin: var(--spacing) 0;
  display: block;
  height: var(--widget-height);
  font-style: italic;
  line-height: var(--widget-height);
  opacity: 0.5;
}
.lil-gui.root > .children > .lil-gui > .title {
  border: 0 solid var(--widget-color);
  border-width: 1px 0;
  transition: border-color 300ms;
}
.lil-gui.root > .children > .lil-gui.closed > .title {
  border-bottom-color: transparent;
}
.lil-gui + .controller {
  border-top: 1px solid var(--widget-color);
  margin-top: 0;
  padding-top: var(--spacing);
}
.lil-gui .lil-gui .lil-gui > .title {
  border: none;
}
.lil-gui .lil-gui .lil-gui > .children {
  border: none;
  margin-left: var(--folder-indent);
  border-left: 2px solid var(--widget-color);
}
.lil-gui .lil-gui .controller {
  border: none;
}

.lil-gui label, .lil-gui input, .lil-gui button {
  -webkit-tap-highlight-color: transparent;
}
.lil-gui input {
  border: 0;
  outline: none;
  font-family: var(--font-family);
  font-size: var(--input-font-size);
  border-radius: var(--widget-border-radius);
  height: var(--widget-height);
  background: var(--widget-color);
  color: var(--text-color);
  width: 100%;
}
@media (hover: hover) {
  .lil-gui input:hover {
    background: var(--hover-color);
  }
  .lil-gui input:active {
    background: var(--focus-color);
  }
}
.lil-gui input:disabled {
  opacity: 1;
}
.lil-gui input[type=text],
.lil-gui input[type=number] {
  padding: var(--widget-padding);
  -moz-appearance: textfield;
}
.lil-gui input[type=text]:focus,
.lil-gui input[type=number]:focus {
  background: var(--focus-color);
}
.lil-gui input[type=checkbox] {
  appearance: none;
  width: var(--checkbox-size);
  height: var(--checkbox-size);
  border-radius: var(--widget-border-radius);
  text-align: center;
  cursor: pointer;
}
.lil-gui input[type=checkbox]:checked:before {
  font-family: "lil-gui";
  content: "✓";
  font-size: var(--checkbox-size);
  line-height: var(--checkbox-size);
}
@media (hover: hover) {
  .lil-gui input[type=checkbox]:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button {
  outline: none;
  cursor: pointer;
  font-family: var(--font-family);
  font-size: var(--font-size);
  color: var(--text-color);
  width: 100%;
  height: var(--widget-height);
  text-transform: none;
  background: var(--widget-color);
  border-radius: var(--widget-border-radius);
  border: none;
}
@media (hover: hover) {
  .lil-gui button:hover {
    background: var(--hover-color);
  }
  .lil-gui button:focus {
    box-shadow: inset 0 0 0 1px var(--focus-color);
  }
}
.lil-gui button:active {
  background: var(--focus-color);
}

@font-face {
  font-family: "lil-gui";
  src: url("data:application/font-woff;charset=utf-8;base64,d09GRgABAAAAAAUsAAsAAAAACJwAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABHU1VCAAABCAAAAH4AAADAImwmYE9TLzIAAAGIAAAAPwAAAGBKqH5SY21hcAAAAcgAAAD0AAACrukyyJBnbHlmAAACvAAAAF8AAACEIZpWH2hlYWQAAAMcAAAAJwAAADZfcj2zaGhlYQAAA0QAAAAYAAAAJAC5AHhobXR4AAADXAAAABAAAABMAZAAAGxvY2EAAANsAAAAFAAAACgCEgIybWF4cAAAA4AAAAAeAAAAIAEfABJuYW1lAAADoAAAASIAAAIK9SUU/XBvc3QAAATEAAAAZgAAAJCTcMc2eJxVjbEOgjAURU+hFRBK1dGRL+ALnAiToyMLEzFpnPz/eAshwSa97517c/MwwJmeB9kwPl+0cf5+uGPZXsqPu4nvZabcSZldZ6kfyWnomFY/eScKqZNWupKJO6kXN3K9uCVoL7iInPr1X5baXs3tjuMqCtzEuagm/AAlzQgPAAB4nGNgYRBlnMDAysDAYM/gBiT5oLQBAwuDJAMDEwMrMwNWEJDmmsJwgCFeXZghBcjlZMgFCzOiKOIFAB71Bb8AeJy1kjFuwkAQRZ+DwRAwBtNQRUGKQ8OdKCAWUhAgKLhIuAsVSpWz5Bbkj3dEgYiUIszqWdpZe+Z7/wB1oCYmIoboiwiLT2WjKl/jscrHfGg/pKdMkyklC5Zs2LEfHYpjcRoPzme9MWWmk3dWbK9ObkWkikOetJ554fWyoEsmdSlt+uR0pCJR34b6t/TVg1SY3sYvdf8vuiKrpyaDXDISiegp17p7579Gp3p++y7HPAiY9pmTibljrr85qSidtlg4+l25GLCaS8e6rRxNBmsnERunKbaOObRz7N72ju5vdAjYpBXHgJylOAVsMseDAPEP8LYoUHicY2BiAAEfhiAGJgZWBgZ7RnFRdnVJELCQlBSRlATJMoLV2DK4glSYs6ubq5vbKrJLSbGrgEmovDuDJVhe3VzcXFwNLCOILB/C4IuQ1xTn5FPilBTj5FPmBAB4WwoqAHicY2BkYGAA4sk1sR/j+W2+MnAzpDBgAyEMQUCSg4EJxAEAwUgFHgB4nGNgZGBgSGFggJMhDIwMqEAYAByHATJ4nGNgAIIUNEwmAABl3AGReJxjYAACIQYlBiMGJ3wQAEcQBEV4nGNgZGBgEGZgY2BiAAEQyQWEDAz/wXwGAAsPATIAAHicXdBNSsNAHAXwl35iA0UQXYnMShfS9GPZA7T7LgIu03SSpkwzYTIt1BN4Ak/gKTyAeCxfw39jZkjymzcvAwmAW/wgwHUEGDb36+jQQ3GXGot79L24jxCP4gHzF/EIr4jEIe7wxhOC3g2TMYy4Q7+Lu/SHuEd/ivt4wJd4wPxbPEKMX3GI5+DJFGaSn4qNzk8mcbKSR6xdXdhSzaOZJGtdapd4vVPbi6rP+cL7TGXOHtXKll4bY1Xl7EGnPtp7Xy2n00zyKLVHfkHBa4IcJ2oD3cgggWvt/V/FbDrUlEUJhTn/0azVWbNTNr0Ens8de1tceK9xZmfB1CPjOmPH4kitmvOubcNpmVTN3oFJyjzCvnmrwhJTzqzVj9jiSX911FjeAAB4nG3HMRKCMBBA0f0giiKi4DU8k0V2GWbIZDOh4PoWWvq6J5V8If9NVNQcaDhyouXMhY4rPTcG7jwYmXhKq8Wz+p762aNaeYXom2n3m2dLTVgsrCgFJ7OTmIkYbwIbC6vIB7WmFfAAAA==") format("woff");
}`;function Bc(y){const e=document.createElement("style");e.innerHTML=y;const t=document.querySelector("head link[rel=stylesheet], head style");t?document.head.insertBefore(e,t):document.head.appendChild(e)}let Ns=!1;class di{constructor({parent:e,autoPlace:t=e===void 0,container:i,width:r,title:s="Controls",closeFolders:n=!1,injectStyles:o=!0,touchStyles:a=!0}={}){if(this.parent=e,this.root=e?e.root:this,this.children=[],this.controllers=[],this.folders=[],this._closed=!1,this._hidden=!1,this.domElement=document.createElement("div"),this.domElement.classList.add("lil-gui"),this.$title=document.createElement("div"),this.$title.classList.add("title"),this.$title.setAttribute("role","button"),this.$title.setAttribute("aria-expanded",!0),this.$title.setAttribute("tabindex",0),this.$title.addEventListener("click",()=>this.openAnimated(this._closed)),this.$title.addEventListener("keydown",h=>{(h.code==="Enter"||h.code==="Space")&&(h.preventDefault(),this.$title.click())}),this.$title.addEventListener("touchstart",()=>{},{passive:!0}),this.$children=document.createElement("div"),this.$children.classList.add("children"),this.domElement.appendChild(this.$title),this.domElement.appendChild(this.$children),this.title(s),this.parent){this.parent.children.push(this),this.parent.folders.push(this),this.parent.$children.appendChild(this.domElement);return}this.domElement.classList.add("root"),a&&this.domElement.classList.add("allow-touch-styles"),!Ns&&o&&(Bc(Lc),Ns=!0),i?i.appendChild(this.domElement):t&&(this.domElement.classList.add("autoPlace"),document.body.appendChild(this.domElement)),r&&this.domElement.style.setProperty("--width",r+"px"),this._closeFolders=n}add(e,t,i,r,s){if(Object(i)===i)return new Rc(this,e,t,i);const n=e[t];switch(typeof n){case"number":return new Mc(this,e,t,i,r,s);case"boolean":return new xc(this,e,t);case"string":return new Pc(this,e,t);case"function":return new Er(this,e,t)}console.error(`gui.add failed
	property:`,t,`
	object:`,e,`
	value:`,n)}addColor(e,t,i=1){return new Cc(this,e,t,i)}addFolder(e){const t=new di({parent:this,title:e});return this.root._closeFolders&&t.close(),t}load(e,t=!0){return e.controllers&&this.controllers.forEach(i=>{i instanceof Er||i._name in e.controllers&&i.load(e.controllers[i._name])}),t&&e.folders&&this.folders.forEach(i=>{i._title in e.folders&&i.load(e.folders[i._title])}),this}save(e=!0){const t={controllers:{},folders:{}};return this.controllers.forEach(i=>{if(!(i instanceof Er)){if(i._name in t.controllers)throw new Error(`Cannot save GUI with duplicate property "${i._name}"`);t.controllers[i._name]=i.save()}}),e&&this.folders.forEach(i=>{if(i._title in t.folders)throw new Error(`Cannot save GUI with duplicate folder "${i._title}"`);t.folders[i._title]=i.save()}),t}open(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),this.domElement.classList.toggle("closed",this._closed),this}close(){return this.open(!1)}_setClosed(e){this._closed!==e&&(this._closed=e,this._callOnOpenClose(this))}show(e=!0){return this._hidden=!e,this.domElement.style.display=this._hidden?"none":"",this}hide(){return this.show(!1)}openAnimated(e=!0){return this._setClosed(!e),this.$title.setAttribute("aria-expanded",!this._closed),requestAnimationFrame(()=>{const t=this.$children.clientHeight;this.$children.style.height=t+"px",this.domElement.classList.add("transition");const i=s=>{s.target===this.$children&&(this.$children.style.height="",this.domElement.classList.remove("transition"),this.$children.removeEventListener("transitionend",i))};this.$children.addEventListener("transitionend",i);const r=e?this.$children.scrollHeight:0;this.domElement.classList.toggle("closed",!e),requestAnimationFrame(()=>{this.$children.style.height=r+"px"})}),this}title(e){return this._title=e,this.$title.textContent=e,this}reset(e=!0){return(e?this.controllersRecursive():this.controllers).forEach(i=>i.reset()),this}onChange(e){return this._onChange=e,this}_callOnChange(e){this.parent&&this.parent._callOnChange(e),this._onChange!==void 0&&this._onChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onFinishChange(e){return this._onFinishChange=e,this}_callOnFinishChange(e){this.parent&&this.parent._callOnFinishChange(e),this._onFinishChange!==void 0&&this._onFinishChange.call(this,{object:e.object,property:e.property,value:e.getValue(),controller:e})}onOpenClose(e){return this._onOpenClose=e,this}_callOnOpenClose(e){this.parent&&this.parent._callOnOpenClose(e),this._onOpenClose!==void 0&&this._onOpenClose.call(this,e)}destroy(){this.parent&&(this.parent.children.splice(this.parent.children.indexOf(this),1),this.parent.folders.splice(this.parent.folders.indexOf(this),1)),this.domElement.parentElement&&this.domElement.parentElement.removeChild(this.domElement),Array.from(this.children).forEach(e=>e.destroy())}controllersRecursive(){let e=Array.from(this.controllers);return this.folders.forEach(t=>{e=e.concat(t.controllersRecursive())}),e}foldersRecursive(){let e=Array.from(this.folders);return this.folders.forEach(t=>{e=e.concat(t.foldersRecursive())}),e}}const Fc={class:"wcp-demo-container"},Ic={__name:"ThreeDebugUI",setup(y){const e=new di,t=Ce(null),i=Ce(null);return ot(()=>{const r=new pt,s=new Jt(1,1,1),n=new Et({color:"#ff0000"}),o=new Ae(s,n);r.add(o),o.position.y=2;const a={color:n.color.getHex(),spin:()=>{ar.to(o.rotation,{duration:1,y:o.rotation.y+2*Math.PI})}};e.add(o.position,"y").min(-3).max(3).step(.01).name("elevation"),e.add(o,"visible"),e.add(a,"spin"),e.addColor(a,"color"),e.add(n,"wireframe"),e.onChange(()=>{n.color.set(a.color)});const h={width:+getComputedStyle(i.value).width.split("px")[0],height:+getComputedStyle(i.value).height.split("px")[0]},l=new lt(75,h.width/h.height);l.position.z=5,l.position.y=1,r.add(l);const c=new Vt(l,t.value);c.enableDamping=!0;const u=new ft({canvas:t.value});u.setSize(h.width,h.height);function d(){requestAnimationFrame(d),c.update(),u.render(r,l)}d(),window.addEventListener("resize",p=>{h.width=+getComputedStyle(i.value).width.split("px")[0],h.height=+getComputedStyle(i.value).height.split("px")[0],l.aspect=h.width/h.height,l.updateProjectionMatrix(),u.setSize(h.width,h.height),u.setPixelRatio(Math.min(window.devicePixelRatio,2))})}),wt(()=>{e.destroy()}),(r,s)=>(ke(),nt("div",Fc,[be("div",{ref_key:"canvasContainer",ref:i,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},kc=at(Ic,[["__scopeId","data-v-23f0f71a"]]),zc={class:"wcp-demo-container"},Nc={__name:"ThreeGeometries",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{const i=new pt,r=new Hn,s=5,n=new Float32Array(s*3*3);for(let f=0;f<s*3*3;f++)n[f]=Math.random()*2-1;const o=new Bi(n,3),a=new Et({color:"red",wireframe:!0});r.setAttribute("position",o);const h=new Ae(r,a);i.add(h);const l={width:+getComputedStyle(e.value).width.split("px")[0],height:600},c=new lt(75,l.width/l.height,.1,1e3);c.position.z=2,c.position.x=.1,i.add(c);const u=new Vt(c,t.value);u.enableDamping=!0;const d=new ft({canvas:t.value});d.setSize(l.width,l.height),d.setPixelRatio(Math.min(window.devicePixelRatio,2));function p(){requestAnimationFrame(p),u.update(),c.lookAt(h.position),d.render(i,c)}p(),window.addEventListener("mousemove",f=>{f.clientX/l.width-.5,-(f.clientY/l.height-.5)}),window.addEventListener("resize",f=>{l.width=+getComputedStyle(e.value).width.split("px")[0],c.aspect=l.width/l.height,c.updateProjectionMatrix(),d.setSize(l.width,l.height),d.setPixelRatio(Math.min(window.devicePixelRatio,2))}),window.addEventListener("dblclick",f=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{}),(i,r)=>(ke(),nt("div",zc,[be("div",{ref_key:"canvasContainer",ref:e},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Oc=at(Nc,[["__scopeId","data-v-32765b23"]]),Vc={class:"wcp-demo-container"},Dc={__name:"ThreeCamera",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{const i=new pt,r=new Ae(new Jt(1,1,1),new Et({color:"green"}));i.add(r);const s={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},n=new lt(75,s.width/s.height,.1,1e3);n.position.z=2,n.position.x=.1,i.add(n);const o=new Vt(n,t.value);o.enableDamping=!0;const a=new ft({canvas:t.value});a.setSize(s.width,s.height),a.setPixelRatio(Math.min(window.devicePixelRatio,2));function h(){requestAnimationFrame(h),o.update(),n.lookAt(r.position),a.render(i,n)}h(),window.addEventListener("mousemove",l=>{l.clientX/s.width-.5,-(l.clientY/s.height-.5)}),window.addEventListener("resize",l=>{s.width=+getComputedStyle(e.value).width.split("px")[0],n.aspect=s.width/s.height,n.updateProjectionMatrix(),a.setSize(s.width,s.height),a.setPixelRatio(Math.min(window.devicePixelRatio,2))}),window.addEventListener("dblclick",l=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{}),(i,r)=>(ke(),nt("div",Vc,[be("div",{ref_key:"canvasContainer",ref:e},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Wc=at(Dc,[["__scopeId","data-v-e3ec3a77"]]),Gc={class:"wcp-demo-container"},Hc={__name:"ThreeTransform",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{console.log(fa);const i=new pt,r=new Jt(1,1,1),s=new Et({color:"green"}),n=new Ae(r,s);n.position.set(.7,-.6,1),n.scale.set(2,.5,.5),n.rotation.reorder("YXZ"),n.rotation.x=Math.PI*.25,n.rotation.y=Math.PI*.25,i.add(n);const o=new Zi;i.add(o);const a=new Ae(new Jt(1,1,1),new Et({color:"red"})),h=new Ae(new Jt(1,1,1),new Et({color:"blue"})),l=[];l.push(new xi(-3,0,0)),l.push(new xi(0,3,0)),l.push(new xi(3,0,0));const c=new Us(new Hn().setFromPoints(l),new qs({color:"green"}));o.add(c),o.add(a),h.position.x=-2,o.add(h),o.position.y=-2;const u=new cr(3);i.add(u);const d={width:+getComputedStyle(t.value).width.split("px")[0],height:+getComputedStyle(t.value).height.split("px")[0]},p=new lt(75,d.width/d.height,.1,1e3),f=new ft({canvas:e.value});f.setSize(d.width,d.height),p.position.z=5,p.position.x=1,p.position.y=1,ar.to(n.position,{duration:1,delay:1,x:2}),ar.to(n.position,{duration:1,delay:2,x:0});const v=new hi;function m(){requestAnimationFrame(m);const g=v.getElapsedTime();n.rotation.y=g*2*Math.PI,p.lookAt(n.position),f.render(i,p)}m()}),wt(()=>{}),(i,r)=>(ke(),nt("div",Gc,[be("div",{ref_key:"canvasContainer",ref:t,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:e},null,512)],512)]))}},Uc=at(Hc,[["__scopeId","data-v-ffe71aca"]]),qc={class:"wcp-demo-container"},$c={__name:"ThreeBasic",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{const i=new pt,r=new Jt(1,1,1),s=new Et({color:"red"}),n=new Ae(r,s);n.position.x=1,i.add(n);const o={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},a=new lt(75,o.width/o.height);a.position.z=5,a.position.y=1,i.add(a);const h=new ft({canvas:t.value});h.setSize(o.width,o.height),h.render(i,a)}),wt(()=>{}),(i,r)=>(ke(),nt("div",qc,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Xc=at($c,[["__scopeId","data-v-2475db1a"]]);class lr extends va{constructor(e){super(e),this.type=Sn}parse(e){const n=function(A,T){switch(A){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(T||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(T||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(T||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(T||""))}},l=`
`,c=function(A,T,R){T=T||1024;let B=A.pos,F=-1,W=0,G="",j=String.fromCharCode.apply(null,new Uint16Array(A.subarray(B,B+128)));for(;0>(F=j.indexOf(l))&&W<T&&B<A.byteLength;)G+=j,W+=j.length,B+=128,j+=String.fromCharCode.apply(null,new Uint16Array(A.subarray(B,B+128)));return-1<F?(A.pos+=W+F+1,G+j.slice(0,F)):!1},u=function(A){const T=/^#\?(\S+)/,R=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,C=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,B=/^\s*FORMAT=(\S+)\s*$/,F=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,W={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let G,j;for((A.pos>=A.byteLength||!(G=c(A)))&&n(1,"no header found"),(j=G.match(T))||n(3,"bad initial token"),W.valid|=1,W.programtype=j[1],W.string+=G+`
`;G=c(A),G!==!1;){if(W.string+=G+`
`,G.charAt(0)==="#"){W.comments+=G+`
`;continue}if((j=G.match(R))&&(W.gamma=parseFloat(j[1])),(j=G.match(C))&&(W.exposure=parseFloat(j[1])),(j=G.match(B))&&(W.valid|=2,W.format=j[1]),(j=G.match(F))&&(W.valid|=4,W.height=parseInt(j[1],10),W.width=parseInt(j[2],10)),W.valid&2&&W.valid&4)break}return W.valid&2||n(3,"missing format specifier"),W.valid&4||n(3,"missing image size specifier"),W},d=function(A,T,R){const C=T;if(C<8||C>32767||A[0]!==2||A[1]!==2||A[2]&128)return new Uint8Array(A);C!==(A[2]<<8|A[3])&&n(3,"wrong scanline width");const B=new Uint8Array(4*T*R);B.length||n(4,"unable to allocate buffer space");let F=0,W=0;const G=4*C,j=new Uint8Array(4),z=new Uint8Array(G);let I=R;for(;I>0&&W<A.byteLength;){W+4>A.byteLength&&n(1),j[0]=A[W++],j[1]=A[W++],j[2]=A[W++],j[3]=A[W++],(j[0]!=2||j[1]!=2||(j[2]<<8|j[3])!=C)&&n(3,"bad rgbe scanline format");let q=0,V;for(;q<G&&W<A.byteLength;){V=A[W++];const k=V>128;if(k&&(V-=128),(V===0||q+V>G)&&n(3,"bad scanline data"),k){const M=A[W++];for(let S=0;S<V;S++)z[q++]=M}else z.set(A.subarray(W,W+V),q),q+=V,W+=V}const P=C;for(let k=0;k<P;k++){let M=0;B[F]=z[k+M],M+=C,B[F+1]=z[k+M],M+=C,B[F+2]=z[k+M],M+=C,B[F+3]=z[k+M],F+=4}I--}return B},p=function(A,T,R,C){const B=A[T+3],F=Math.pow(2,B-128)/255;R[C+0]=A[T+0]*F,R[C+1]=A[T+1]*F,R[C+2]=A[T+2]*F,R[C+3]=1},f=function(A,T,R,C){const B=A[T+3],F=Math.pow(2,B-128)/255;R[C+0]=$n.toHalfFloat(Math.min(A[T+0]*F,65504)),R[C+1]=$n.toHalfFloat(Math.min(A[T+1]*F,65504)),R[C+2]=$n.toHalfFloat(Math.min(A[T+2]*F,65504)),R[C+3]=$n.toHalfFloat(1)},v=new Uint8Array(e);v.pos=0;const m=u(v),g=m.width,_=m.height,w=d(v.subarray(v.pos),g,_);let x,E,L;switch(this.type){case fr:L=w.length/4;const A=new Float32Array(L*4);for(let R=0;R<L;R++)p(w,R*4,A,R*4);x=A,E=fr;break;case Sn:L=w.length/4;const T=new Uint16Array(L*4);for(let R=0;R<L;R++)f(w,R*4,T,R*4);x=T,E=Sn;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:g,height:_,data:x,header:m.string,gamma:m.gamma,exposure:m.exposure,type:E}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(n,o){switch(n.type){case fr:case Sn:n.colorSpace=ei,n.minFilter=Zn,n.magFilter=Zn,n.generateMipmaps=!1,n.flipY=!0;break}t&&t(n,o)}return super.load(e,s,i,r)}}const Yc={class:"wcp-demo-container"},jc={__name:"ThreeMaterials2",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{const i=new pt,r=new ma;r.onStart=()=>{console.log("onStart")},r.onLoad=()=>{console.log("onLoad")},r.onProgress=()=>{console.log("onProgress")},r.onError=()=>{console.log("onError")};const s=new lr,o=new ui(r).load("/textures/matcap1.png");o.repeat.x=2,o.repeat.y=3,o.rotation=Math.PI/4,o.center.x=.5,o.center.y=.5,o.generateMipmaps=!1,o.minFilter=$s;const a=new je;a.metalness=.7,a.roughness=.1,a.side=ki;const h=new Ae(new oi(.5,16,16),a);h.position.x=-1.5;const l=new Ae(new rn(1,1),a),c=new Ae(new hr(.3,.2,16,32),a);c.position.x=1.5,i.add(h),i.add(l),i.add(c),s.load("/hdrs/0.hdr",g=>{g.mapping=Xs,a.envMap=g});const u={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},d=new lt(75,u.width/u.height,.1,1e3);d.position.z=5,i.add(d);const p=new Vt(d,t.value);p.enableDamping=!0;const f=new ft({canvas:t.value});f.setSize(u.width,u.height),f.setPixelRatio(Math.min(window.devicePixelRatio,2));const v=new hi;function m(){const g=v.getElapsedTime();h.rotation.y=.1*g,l.rotation.y=.1*g,c.rotation.y=.1*g,h.rotation.x=.15*g,l.rotation.x=.15*g,p.update(),f.render(i,d),requestAnimationFrame(m)}m(),window.addEventListener("resize",g=>{u.width=+getComputedStyle(e.value).width.split("px")[0],u.height=+getComputedStyle(e.value).height.split("px")[0],d.aspect=u.width/u.height,d.updateProjectionMatrix(),f.setSize(u.width,u.height),f.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",g=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{}),(i,r)=>(ke(),nt("div",Yc,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Kc=at(jc,[["__scopeId","data-v-d32d64aa"]]);class Qc extends ga{constructor(e,t={}){const i=t.font;if(i===void 0)super();else{const r=i.generateShapes(e,t.size);t.depth===void 0&&t.height!==void 0&&console.warn("THREE.TextGeometry: .height is now depreciated. Please use .depth instead"),t.depth=t.depth!==void 0?t.depth:t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t)}this.type="TextGeometry"}}class Zc extends jr{constructor(e){super(e)}load(e,t,i,r){const s=this,n=new In(this.manager);n.setPath(this.path),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,function(o){const a=s.parse(JSON.parse(o));t&&t(a)},i,r)}parse(e){return new Jc(e)}}class Jc{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=eh(e,t,this.data);for(let s=0,n=r.length;s<n;s++)i.push(...r[s].toShapes());return i}}function eh(y,e,t){const i=Array.from(y),r=e/t.resolution,s=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,n=[];let o=0,a=0;for(let h=0;h<i.length;h++){const l=i[h];if(l===`
`)o=0,a-=s;else{const c=th(l,r,o,a,t);o+=c.offsetX,n.push(c.path)}}return n}function th(y,e,t,i,r){const s=r.glyphs[y]||r.glyphs["?"];if(!s){console.error('THREE.Font: character "'+y+'" does not exists in font family '+r.familyName+".");return}const n=new ya;let o,a,h,l,c,u,d,p;if(s.o){const f=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let v=0,m=f.length;v<m;)switch(f[v++]){case"m":o=f[v++]*e+t,a=f[v++]*e+i,n.moveTo(o,a);break;case"l":o=f[v++]*e+t,a=f[v++]*e+i,n.lineTo(o,a);break;case"q":h=f[v++]*e+t,l=f[v++]*e+i,c=f[v++]*e+t,u=f[v++]*e+i,n.quadraticCurveTo(c,u,h,l);break;case"b":h=f[v++]*e+t,l=f[v++]*e+i,c=f[v++]*e+t,u=f[v++]*e+i,d=f[v++]*e+t,p=f[v++]*e+i,n.bezierCurveTo(c,u,d,p,h,l);break}}return{offsetX:s.ha*e,path:n}}const ih={class:"wcp-demo-container"},nh={__name:"ThreeMaterialsText",setup(y){const e=new di,t=Ce(null),i=Ce(null);return ot(()=>{const r=new pt,n=new ui().load("/textures/matcap1.png");new Zc().load("fonts/helvetiker_regular.typeface.json",function(p){const f=new Qc("Hello Three.js",{font:p,size:.5,depth:.2,curveSegments:6,bevelEnabled:!0,bevelThickness:.03,bevelSize:.02,bevelOffset:0,bevelSegments:5});f.computeBoundingBox(),f.center();const v=new wa({matcap:n}),m=new Ae(f,v);r.add(m);const g=new hr(.5,.1,20,45);for(let _=0;_<100;_++){const w=new Ae(g,v);w.position.x=(Math.random()-.5)*10,w.position.y=(Math.random()-.5)*10,w.position.z=(Math.random()-.5)*10,w.rotation.x=Math.random()*Math.PI,w.rotation.y=Math.random()*Math.PI;const x=Math.random();w.scale.set(x,x,x),r.add(w)}});const a={width:+getComputedStyle(t.value).width.split("px")[0],height:+getComputedStyle(t.value).height.split("px")[0]},h=new lt(75,a.width/a.height,.1,1e3);h.position.z=5,r.add(h);const l=new Vt(h,i.value);l.enableDamping=!0;const c=new ft({canvas:i.value});c.setSize(a.width,a.height),c.setPixelRatio(Math.min(window.devicePixelRatio,2));const u=new hi;function d(){u.getElapsedTime(),l.update(),c.render(r,h),requestAnimationFrame(d)}d(),window.addEventListener("resize",p=>{a.width=+getComputedStyle(t.value).width.split("px")[0],a.height=+getComputedStyle(t.value).height.split("px")[0],h.aspect=a.width/a.height,h.updateProjectionMatrix(),c.setSize(a.width,a.height),c.setPixelRatio(Math.min(window.devicePixelRatio,2))}),i.value.addEventListener("dblclick",p=>{document.fullscreenElement?document.exitFullscreen():t.value.requestFullscreen()})}),wt(()=>{e.destroy()}),(r,s)=>(ke(),nt("div",ih,[be("div",{ref_key:"canvasContainer",ref:t,class:"canvasContainer"},[be("canvas",{ref_key:"canvas",ref:i},null,512)],512)]))}},rh=at(nh,[["__scopeId","data-v-3a489362"]]),sh={class:"wcp-demo-container"},oh={__name:"ThreeLight",setup(y){const e=Ce(null),t=Ce(null),i=new di;return ot(()=>{const r=new pt,s=new cr(3);r.add(s);const n=new an;n.color=new yt("#ffffff"),n.intensity=.3,r.add(n);const o=new _a(16711680,255,.3);r.add(o);const a=new bn;a.color=new yt("#00fffc"),a.intensity=1,a.position.set(1,.25,0),r.add(a);const h=new Ki(16748544,.5,10,2);h.position.set(.2,-.3,.5),r.add(h);const l=new Ys("#78ff00",.5,2,Math.PI*.1,.25,1);l.position.set(0,1,0),r.add(l),i.add(n,"intensity").min(0).max(1).step(.01);const c=new xa(o,.2);r.add(c);const u=new js(a,.2);r.add(u);const d=new Ks(h,.2);r.add(d);const p=new Aa(l);r.add(p);const f=new je;f.roughness=.4,f.side=ki;const v=new Ae(new Jt(.5,.5,.5),f);v.position.x=-.6;const m=new Ae(new hr(.2,.1,16,100),f),g=new Ae(new rn(3,2,1,1),f);g.position.x=-.5,g.position.y=-.5,g.rotation.x=Math.PI*.5,r.add(v),r.add(m),r.add(g);const _={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},w=new lt(75,_.width/_.height,.1,1e3);w.position.z=2,r.add(w);const x=new Vt(w,t.value);x.enableDamping=!0;const E=new ft({canvas:t.value});E.setSize(_.width,_.height),E.setPixelRatio(Math.min(window.devicePixelRatio,2));function L(){requestAnimationFrame(L),l.angle=Math.PI/8+Math.sin(Date.now()*.001)*Math.PI/8,x.update(),w.lookAt(v.position),E.render(r,w)}L(),window.addEventListener("resize",A=>{_.width=+getComputedStyle(e.value).width.split("px")[0],_.height=+getComputedStyle(e.value).height.split("px")[0],w.aspect=_.width/_.height,w.updateProjectionMatrix(),E.setSize(_.width,_.height),E.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",A=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy()}),(r,s)=>(ke(),nt("div",sh,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},ah=at(oh,[["__scopeId","data-v-92540add"]]),lh={class:"wcp-demo-container"},ch={__name:"ThreeShadows",setup(y){const e=Ce(null),t=Ce(null),i=new di;return ot(()=>{const r=new pt,s=new cr(3);r.add(s);const n=new an;n.color=new yt("#ffffff"),n.intensity=.3,r.add(n);const o=new bn;o.color=new yt("#00fffc"),o.intensity=1,o.position.set(0,2,0),o.castShadow=!0,r.add(o);const a=new Ki("00fffc");a.castShadow=!0,a.position.set(0,1,0),r.add(a);const h=new js(o,.2);o.shadow.mapSize.width=1024,o.shadow.mapSize.height=1024,o.shadow.camera.near=.1,o.shadow.camera.far=6,r.add(h);const l=new ba(o.shadow.camera);r.add(l);const c=new Ks(a,.2);a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024,a.shadow.camera.near=.1,a.shadow.camera.far=5,r.add(c);const u=new je;u.roughness=.4,u.side=ki,u.color=new yt("#00fffc");const d=new ui,p=new je,f=d.load("/textures/bg.png");p.side=ki,p.map=f;const v=new oi(.3,32,16),m=new Ae(v,p),g=new Ae(new rn(5,5,1,1),u);m.castShadow=!0,g.rotation.x=Math.PI*.5,g.position.y=-.3,g.receiveShadow=!0,r.add(m),r.add(g),i.add(o,"intensity").min(0).max(1).step(.001),i.add(o.position,"x").min(-5).max(5).step(.001),i.add(o.position,"y").min(-5).max(5).step(.001),i.add(o.position,"z").min(-5).max(5).step(.001),i.add(a,"intensity").min(0).max(1).step(.001),i.add(a.position,"x").min(-5).max(5).step(.001),i.add(a.position,"y").min(-5).max(5).step(.001),i.add(a.position,"z").min(-5).max(5).step(.001);const _={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},w=new lt(75,_.width/_.height,.1,1e3);w.position.z=2,w.position.y=1.5,r.add(w);const x=new Vt(w,t.value);x.enableDamping=!0;const E=new ft({canvas:t.value});E.setSize(_.width,_.height),E.setPixelRatio(Math.min(window.devicePixelRatio,2)),E.shadowMap.enabled=!0;const L=new hi;function A(){requestAnimationFrame(A);const T=L.getElapsedTime();m.position.x=Math.cos(T)*1,m.position.z=Math.sin(T)*1,m.position.y=Math.abs(Math.sin(T*3)),m.rotation.x+=.01,m.rotation.y+=.01,m.rotation.z+=.01,x.update(),E.render(r,w)}A(),window.addEventListener("resize",T=>{_.width=+getComputedStyle(e.value).width.split("px")[0],_.height=+getComputedStyle(e.value).height.split("px")[0],w.aspect=_.width/_.height,w.updateProjectionMatrix(),E.setSize(_.width,_.height),E.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",T=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy(),console.log("unmounted")}),(r,s)=>(ke(),nt("div",lh,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},hh=at(ch,[["__scopeId","data-v-a4264e7a"]]);function Os(y,e){if(e===Ta)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),y;if(e===Pr||e===Qs){let t=y.getIndex();if(t===null){const n=[],o=y.getAttribute("position");if(o!==void 0){for(let a=0;a<o.count;a++)n.push(a);y.setIndex(n),t=y.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),y}const i=t.count-2,r=[];if(e===Pr)for(let n=1;n<=i;n++)r.push(t.getX(0)),r.push(t.getX(n)),r.push(t.getX(n+1));else for(let n=0;n<i;n++)n%2===0?(r.push(t.getX(n)),r.push(t.getX(n+1)),r.push(t.getX(n+2))):(r.push(t.getX(n+2)),r.push(t.getX(n+1)),r.push(t.getX(n)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=y.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),y}class fs extends jr{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new vh(t)}),this.register(function(t){return new Th(t)}),this.register(function(t){return new Eh(t)}),this.register(function(t){return new Sh(t)}),this.register(function(t){return new gh(t)}),this.register(function(t){return new yh(t)}),this.register(function(t){return new wh(t)}),this.register(function(t){return new _h(t)}),this.register(function(t){return new fh(t)}),this.register(function(t){return new xh(t)}),this.register(function(t){return new mh(t)}),this.register(function(t){return new bh(t)}),this.register(function(t){return new Ah(t)}),this.register(function(t){return new dh(t)}),this.register(function(t){return new Ch(t)}),this.register(function(t){return new Mh(t)})}load(e,t,i,r){const s=this;let n;if(this.resourcePath!=="")n=this.resourcePath;else if(this.path!==""){const h=Rn.extractUrlBase(e);n=Rn.resolveURL(h,this.path)}else n=Rn.extractUrlBase(e);this.manager.itemStart(e);const o=function(h){r?r(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},a=new In(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){try{s.parse(h,n,function(l){t(l),s.manager.itemEnd(e)},o)}catch(l){o(l)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,r){let s;const n={},o={},a=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===ra){try{n[Se.KHR_BINARY_GLTF]=new Rh(e)}catch(c){r&&r(c);return}s=JSON.parse(n[Se.KHR_BINARY_GLTF].content)}else s=JSON.parse(a.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new Gh(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let l=0;l<this.pluginCallbacks.length;l++){const c=this.pluginCallbacks[l](h);c.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[c.name]=c,n[c.name]=!0}if(s.extensionsUsed)for(let l=0;l<s.extensionsUsed.length;++l){const c=s.extensionsUsed[l],u=s.extensionsRequired||[];switch(c){case Se.KHR_MATERIALS_UNLIT:n[c]=new ph;break;case Se.KHR_DRACO_MESH_COMPRESSION:n[c]=new Ph(s,this.dracoLoader);break;case Se.KHR_TEXTURE_TRANSFORM:n[c]=new Lh;break;case Se.KHR_MESH_QUANTIZATION:n[c]=new Bh;break;default:u.indexOf(c)>=0&&o[c]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+c+'".')}}h.setExtensions(n),h.setPlugins(o),h.parse(i,r)}parseAsync(e,t){const i=this;return new Promise(function(r,s){i.parse(e,t,r,s)})}}function uh(){let y={};return{get:function(e){return y[e]},add:function(e,t){y[e]=t},remove:function(e){delete y[e]},removeAll:function(){y={}}}}const Se={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class dh{constructor(e){this.parser=e,this.name=Se.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,r=t.length;i<r;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let r=t.cache.get(i);if(r)return r;const s=t.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const l=new yt(16777215);a.color!==void 0&&l.setRGB(a.color[0],a.color[1],a.color[2],ei);const c=a.range!==void 0?a.range:0;switch(a.type){case"directional":h=new bn(l),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new Ki(l),h.distance=c;break;case"spot":h=new Ys(l),h.distance=c,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,h.angle=a.spot.outerConeAngle,h.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return h.position.set(0,0,0),h.decay=2,Mi(h,a),a.intensity!==void 0&&(h.intensity=a.intensity),h.name=t.createUniqueName(a.name||"light_"+e),r=Promise.resolve(h),t.cache.add(i,r),r}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],o=(s.extensions&&s.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(a){return i._getNodeRef(t.cache,o,a)})}}class ph{constructor(){this.name=Se.KHR_MATERIALS_UNLIT}getMaterialType(){return Et}extendParams(e,t,i){const r=[];e.color=new yt(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const n=s.baseColorFactor;e.color.setRGB(n[0],n[1],n[2],ei),e.opacity=n[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,zi))}return Promise.all(r)}}class fh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class vh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];if(n.clearcoatFactor!==void 0&&(t.clearcoat=n.clearcoatFactor),n.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",n.clearcoatTexture)),n.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=n.clearcoatRoughnessFactor),n.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",n.clearcoatRoughnessTexture)),n.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",n.clearcoatNormalTexture)),n.clearcoatNormalTexture.scale!==void 0)){const o=n.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Kr(o,o)}return Promise.all(s)}}class mh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];return n.iridescenceFactor!==void 0&&(t.iridescence=n.iridescenceFactor),n.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",n.iridescenceTexture)),n.iridescenceIor!==void 0&&(t.iridescenceIOR=n.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),n.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=n.iridescenceThicknessMinimum),n.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=n.iridescenceThicknessMaximum),n.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",n.iridescenceThicknessTexture)),Promise.all(s)}}class gh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new yt(0,0,0),t.sheenRoughness=0,t.sheen=1;const n=r.extensions[this.name];if(n.sheenColorFactor!==void 0){const o=n.sheenColorFactor;t.sheenColor.setRGB(o[0],o[1],o[2],ei)}return n.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=n.sheenRoughnessFactor),n.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",n.sheenColorTexture,zi)),n.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",n.sheenRoughnessTexture)),Promise.all(s)}}class yh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];return n.transmissionFactor!==void 0&&(t.transmission=n.transmissionFactor),n.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",n.transmissionTexture)),Promise.all(s)}}class wh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];t.thickness=n.thicknessFactor!==void 0?n.thicknessFactor:0,n.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",n.thicknessTexture)),t.attenuationDistance=n.attenuationDistance||1/0;const o=n.attenuationColor||[1,1,1];return t.attenuationColor=new yt().setRGB(o[0],o[1],o[2],ei),Promise.all(s)}}class _h{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class xh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];t.specularIntensity=n.specularFactor!==void 0?n.specularFactor:1,n.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",n.specularTexture));const o=n.specularColorFactor||[1,1,1];return t.specularColor=new yt().setRGB(o[0],o[1],o[2],ei),n.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",n.specularColorTexture,zi)),Promise.all(s)}}class Ah{constructor(e){this.parser=e,this.name=Se.EXT_MATERIALS_BUMP}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];return t.bumpScale=n.bumpFactor!==void 0?n.bumpFactor:1,n.bumpTexture!==void 0&&s.push(i.assignTexture(t,"bumpMap",n.bumpTexture)),Promise.all(s)}}class bh{constructor(e){this.parser=e,this.name=Se.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:Ti}extendMaterialParams(e,t){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],n=r.extensions[this.name];return n.anisotropyStrength!==void 0&&(t.anisotropy=n.anisotropyStrength),n.anisotropyRotation!==void 0&&(t.anisotropyRotation=n.anisotropyRotation),n.anisotropyTexture!==void 0&&s.push(i.assignTexture(t,"anisotropyMap",n.anisotropyTexture)),Promise.all(s)}}class Th{constructor(e){this.parser=e,this.name=Se.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],n=t.options.ktx2Loader;if(!n){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,n)}}class Eh{constructor(e){this.parser=e,this.name=Se.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const n=s.extensions[t],o=r.images[n.source];let a=i.textureLoader;if(o.uri){const h=i.options.manager.getHandler(o.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return i.loadTextureImage(e,n.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Sh{constructor(e){this.parser=e,this.name=Se.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[t])return null;const n=s.extensions[t],o=r.images[n.source];let a=i.textureLoader;if(o.uri){const h=i.options.manager.getHandler(o.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return i.loadTextureImage(e,n.source,a);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class Ch{constructor(e){this.name=Se.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(o){const a=r.byteOffset||0,h=r.byteLength||0,l=r.count,c=r.byteStride,u=new Uint8Array(o,a,h);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(l,c,u,r.mode,r.filter).then(function(d){return d.buffer}):n.ready.then(function(){const d=new ArrayBuffer(l*c);return n.decodeGltfBuffer(new Uint8Array(d),l,c,u,r.mode,r.filter),d})})}else return null}}class Mh{constructor(e){this.name=Se.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=t.meshes[i.mesh];for(const h of r.primitives)if(h.mode!==Xt.TRIANGLES&&h.mode!==Xt.TRIANGLE_STRIP&&h.mode!==Xt.TRIANGLE_FAN&&h.mode!==void 0)return null;const n=i.extensions[this.name].attributes,o=[],a={};for(const h in n)o.push(this.parser.getDependency("accessor",n[h]).then(l=>(a[h]=l,a[h])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(h=>{const l=h.pop(),c=l.isGroup?l.children:[l],u=h[0].count,d=[];for(const p of c){const f=new Jn,v=new xi,m=new no,g=new xi(1,1,1),_=new Ea(p.geometry,p.material,u);for(let w=0;w<u;w++)a.TRANSLATION&&v.fromBufferAttribute(a.TRANSLATION,w),a.ROTATION&&m.fromBufferAttribute(a.ROTATION,w),a.SCALE&&g.fromBufferAttribute(a.SCALE,w),_.setMatrixAt(w,f.compose(v,m,g));for(const w in a)if(w==="_COLOR_0"){const x=a[w];_.instanceColor=new Sa(x.array,x.itemSize,x.normalized)}else w!=="TRANSLATION"&&w!=="ROTATION"&&w!=="SCALE"&&p.geometry.setAttribute(w,a[w]);Zs.prototype.copy.call(_,p),this.parser.assignFinalMaterial(_),d.push(_)}return l.isGroup?(l.clear(),l.add(...d),l):d[0]}))}}const ra="glTF",En=12,Vs={JSON:1313821514,BIN:5130562};class Rh{constructor(e){this.name=Se.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,En),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ra)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-En,s=new DataView(e,En);let n=0;for(;n<r;){const o=s.getUint32(n,!0);n+=4;const a=s.getUint32(n,!0);if(n+=4,a===Vs.JSON){const h=new Uint8Array(e,En+n,o);this.content=i.decode(h)}else if(a===Vs.BIN){const h=En+n;this.body=e.slice(h,h+o)}n+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Ph{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Se.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,n=e.extensions[this.name].attributes,o={},a={},h={};for(const l in n){const c=Xr[l]||l.toLowerCase();o[c]=n[l]}for(const l in e.attributes){const c=Xr[l]||l.toLowerCase();if(n[l]!==void 0){const u=i.accessors[e.attributes[l]],d=gn[u.componentType];h[c]=d.name,a[c]=u.normalized===!0}}return t.getDependency("bufferView",s).then(function(l){return new Promise(function(c,u){r.decodeDracoFile(l,function(d){for(const p in d.attributes){const f=d.attributes[p],v=a[p];v!==void 0&&(f.normalized=v)}c(d)},o,h,ei,u)})})}}class Lh{constructor(){this.name=Se.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class Bh{constructor(){this.name=Se.KHR_MESH_QUANTIZATION}}class sa extends Xa{constructor(e,t,i,r){super(e,t,i,r)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let n=0;n!==r;n++)t[n]=i[s+n];return t}interpolate_(e,t,i,r){const s=this.resultBuffer,n=this.sampleValues,o=this.valueSize,a=o*2,h=o*3,l=r-t,c=(i-t)/l,u=c*c,d=u*c,p=e*h,f=p-h,v=-2*d+3*u,m=d-u,g=1-v,_=m-u+c;for(let w=0;w!==o;w++){const x=n[f+w+o],E=n[f+w+a]*l,L=n[p+w+o],A=n[p+w]*l;s[w]=g*x+_*E+v*L+m*A}return s}}const Fh=new no;class Ih extends sa{interpolate_(e,t,i,r){const s=super.interpolate_(e,t,i,r);return Fh.fromArray(s).normalize().toArray(s),s}}const Xt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},gn={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ds={9728:$s,9729:Zn,9984:Na,9985:Oa,9986:Va,9987:Js},Ws={33071:Da,33648:Wa,10497:It},Sr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Xr={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ci={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},kh={CUBICSPLINE:void 0,LINEAR:io,STEP:Ga},Cr={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function zh(y){return y.DefaultMaterial===void 0&&(y.DefaultMaterial=new je({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ha})),y.DefaultMaterial}function Yi(y,e,t){for(const i in t.extensions)y[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Mi(y,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(y.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Nh(y,e,t){let i=!1,r=!1,s=!1;for(let h=0,l=e.length;h<l;h++){const c=e[h];if(c.POSITION!==void 0&&(i=!0),c.NORMAL!==void 0&&(r=!0),c.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(y);const n=[],o=[],a=[];for(let h=0,l=e.length;h<l;h++){const c=e[h];if(i){const u=c.POSITION!==void 0?t.getDependency("accessor",c.POSITION):y.attributes.position;n.push(u)}if(r){const u=c.NORMAL!==void 0?t.getDependency("accessor",c.NORMAL):y.attributes.normal;o.push(u)}if(s){const u=c.COLOR_0!==void 0?t.getDependency("accessor",c.COLOR_0):y.attributes.color;a.push(u)}}return Promise.all([Promise.all(n),Promise.all(o),Promise.all(a)]).then(function(h){const l=h[0],c=h[1],u=h[2];return i&&(y.morphAttributes.position=l),r&&(y.morphAttributes.normal=c),s&&(y.morphAttributes.color=u),y.morphTargetsRelative=!0,y})}function Oh(y,e){if(y.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)y.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(y.morphTargetInfluences.length===t.length){y.morphTargetDictionary={};for(let i=0,r=t.length;i<r;i++)y.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Vh(y){let e;const t=y.extensions&&y.extensions[Se.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+Mr(t.attributes):e=y.indices+":"+Mr(y.attributes)+":"+y.mode,y.targets!==void 0)for(let i=0,r=y.targets.length;i<r;i++)e+=":"+Mr(y.targets[i]);return e}function Mr(y){let e="";const t=Object.keys(y).sort();for(let i=0,r=t.length;i<r;i++)e+=t[i]+":"+y[t[i]]+";";return e}function Yr(y){switch(y){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Dh(y){return y.search(/\.jpe?g($|\?)/i)>0||y.search(/^data\:image\/jpeg/)===0?"image/jpeg":y.search(/\.webp($|\?)/i)>0||y.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Wh=new Jn;class Gh{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new uh,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new ui(this.options.manager):this.textureLoader=new Ca(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new In(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(n){return n._markDefs&&n._markDefs()}),Promise.all(this._invokeAll(function(n){return n.beforeRoot&&n.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(n){const o={scene:n[0][r.scene||0],scenes:n[0],animations:n[1],cameras:n[2],asset:r.asset,parser:i,userData:{}};return Yi(s,o,r),Mi(o,r),Promise.all(i._invokeAll(function(a){return a.afterRoot&&a.afterRoot(o)})).then(function(){for(const a of o.scenes)a.updateMatrixWorld();e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){const n=t[r].joints;for(let o=0,a=n.length;o<a;o++)e[n[o]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const n=e[r];n.mesh!==void 0&&(this._addNodeRef(this.meshCache,n.mesh),n.skin!==void 0&&(i[n.mesh].isSkinnedMesh=!0)),n.camera!==void 0&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const r=i.clone(),s=(n,o)=>{const a=this.associations.get(n);a!=null&&this.associations.set(o,a);for(const[h,l]of n.children.entries())s(l,o.children[h])};return s(i,r),r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const r=e(t[i]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let r=0;r<t.length;r++){const s=e(t[r]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":r=this.loadSkin(t);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":r=this.loadCamera(t);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(r.map(function(s,n){return i.getDependency(e,n)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Se.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,n){i.load(Rn.resolveURL(t.uri,r.path),s,void 0,function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const r=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const t=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const n=Sr[r.type],o=gn[r.componentType],a=r.normalized===!0,h=new o(r.count*n);return Promise.resolve(new Bi(h,n,a))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(n){const o=n[0],a=Sr[r.type],h=gn[r.componentType],l=h.BYTES_PER_ELEMENT,c=l*a,u=r.byteOffset||0,d=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let f,v;if(d&&d!==c){const m=Math.floor(u/d),g="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let _=t.cache.get(g);_||(f=new h(o,m*d,r.count*d/l),_=new Ma(f,d/l),t.cache.add(g,_)),v=new Ua(_,a,u%d/l,p)}else o===null?f=new h(r.count*a):f=new h(o,u,r.count*a),v=new Bi(f,a,p);if(r.sparse!==void 0){const m=Sr.SCALAR,g=gn[r.sparse.indices.componentType],_=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,x=new g(n[1],_,r.sparse.count*m),E=new h(n[2],w,r.sparse.count*a);o!==null&&(v=new Bi(v.array.slice(),v.itemSize,v.normalized));for(let L=0,A=x.length;L<A;L++){const T=x[L];if(v.setX(T,E[L*a]),a>=2&&v.setY(T,E[L*a+1]),a>=3&&v.setZ(T,E[L*a+2]),a>=4&&v.setW(T,E[L*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return v})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,n=t.images[s];let o=this.textureLoader;if(n.uri){const a=i.manager.getHandler(n.uri);a!==null&&(o=a)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,i){const r=this,s=this.json,n=s.textures[e],o=s.images[t],a=(o.uri||o.bufferView)+":"+n.sampler;if(this.textureCache[a])return this.textureCache[a];const h=this.loadImageSource(t,i).then(function(l){l.flipY=!1,l.name=n.name||o.name||"",l.name===""&&typeof o.uri=="string"&&o.uri.startsWith("data:image/")===!1&&(l.name=o.uri);const u=(s.samplers||{})[n.sampler]||{};return l.magFilter=Ds[u.magFilter]||Zn,l.minFilter=Ds[u.minFilter]||Js,l.wrapS=Ws[u.wrapS]||It,l.wrapT=Ws[u.wrapT]||It,r.associations.set(l,{textures:e}),l}).catch(function(){return null});return this.textureCache[a]=h,h}loadImageSource(e,t){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(c=>c.clone());const n=r.images[e],o=self.URL||self.webkitURL;let a=n.uri||"",h=!1;if(n.bufferView!==void 0)a=i.getDependency("bufferView",n.bufferView).then(function(c){h=!0;const u=new Blob([c],{type:n.mimeType});return a=o.createObjectURL(u),a});else if(n.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const l=Promise.resolve(a).then(function(c){return new Promise(function(u,d){let p=u;t.isImageBitmapLoader===!0&&(p=function(f){const v=new ms(f);v.needsUpdate=!0,u(v)}),t.load(Rn.resolveURL(c,s.path),p,void 0,d)})}).then(function(c){return h===!0&&o.revokeObjectURL(a),c.userData.mimeType=n.mimeType||Dh(n.uri),c}).catch(function(c){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),c});return this.sourceCache[e]=l,l}assignTexture(e,t,i,r){const s=this;return this.getDependency("texture",i.index).then(function(n){if(!n)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(n=n.clone(),n.channel=i.texCoord),s.extensions[Se.KHR_TEXTURE_TRANSFORM]){const o=i.extensions!==void 0?i.extensions[Se.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const a=s.associations.get(n);n=s.extensions[Se.KHR_TEXTURE_TRANSFORM].extendTexture(n,o),s.associations.set(n,a)}}return r!==void 0&&(n.colorSpace=r),e[t]=n,n})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const r=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,n=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+i.uuid;let a=this.cache.get(o);a||(a=new eo,vr.prototype.copy.call(a,i),a.color.copy(i.color),a.map=i.map,a.sizeAttenuation=!1,this.cache.add(o,a)),i=a}else if(e.isLine){const o="LineBasicMaterial:"+i.uuid;let a=this.cache.get(o);a||(a=new qs,vr.prototype.copy.call(a,i),a.color.copy(i.color),a.map=i.map,this.cache.add(o,a)),i=a}if(r||s||n){let o="ClonedMaterial:"+i.uuid+":";r&&(o+="derivative-tangents:"),s&&(o+="vertex-colors:"),n&&(o+="flat-shading:");let a=this.cache.get(o);a||(a=i.clone(),s&&(a.vertexColors=!0),n&&(a.flatShading=!0),r&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(o,a),this.associations.set(a,this.associations.get(i))),i=a}e.material=i}getMaterialType(){return je}loadMaterial(e){const t=this,i=this.json,r=this.extensions,s=i.materials[e];let n;const o={},a=s.extensions||{},h=[];if(a[Se.KHR_MATERIALS_UNLIT]){const c=r[Se.KHR_MATERIALS_UNLIT];n=c.getMaterialType(),h.push(c.extendParams(o,s,t))}else{const c=s.pbrMetallicRoughness||{};if(o.color=new yt(1,1,1),o.opacity=1,Array.isArray(c.baseColorFactor)){const u=c.baseColorFactor;o.color.setRGB(u[0],u[1],u[2],ei),o.opacity=u[3]}c.baseColorTexture!==void 0&&h.push(t.assignTexture(o,"map",c.baseColorTexture,zi)),o.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,o.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(o,"metalnessMap",c.metallicRoughnessTexture)),h.push(t.assignTexture(o,"roughnessMap",c.metallicRoughnessTexture))),n=this._invokeOne(function(u){return u.getMaterialType&&u.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(u){return u.extendMaterialParams&&u.extendMaterialParams(e,o)})))}s.doubleSided===!0&&(o.side=ki);const l=s.alphaMode||Cr.OPAQUE;if(l===Cr.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,l===Cr.MASK&&(o.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&n!==Et&&(h.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new Kr(1,1),s.normalTexture.scale!==void 0)){const c=s.normalTexture.scale;o.normalScale.set(c,c)}if(s.occlusionTexture!==void 0&&n!==Et&&(h.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&n!==Et){const c=s.emissiveFactor;o.emissive=new yt().setRGB(c[0],c[1],c[2],ei)}return s.emissiveTexture!==void 0&&n!==Et&&h.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,zi)),Promise.all(h).then(function(){const c=new n(o);return s.name&&(c.name=s.name),Mi(c,s),t.associations.set(c,{materials:e}),s.extensions&&Yi(r,c,s),c})}createUniqueName(e){const t=Ra.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,i=this.extensions,r=this.primitiveCache;function s(o){return i[Se.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(a){return Gs(a,o,t)})}const n=[];for(let o=0,a=e.length;o<a;o++){const h=e[o],l=Vh(h),c=r[l];if(c)n.push(c.promise);else{let u;h.extensions&&h.extensions[Se.KHR_DRACO_MESH_COMPRESSION]?u=s(h):u=Gs(new Hn,h,t),r[l]={primitive:h,promise:u},n.push(u)}}return Promise.all(n)}loadMesh(e){const t=this,i=this.json,r=this.extensions,s=i.meshes[e],n=s.primitives,o=[];for(let a=0,h=n.length;a<h;a++){const l=n[a].material===void 0?zh(this.cache):this.getDependency("material",n[a].material);o.push(l)}return o.push(t.loadGeometries(n)),Promise.all(o).then(function(a){const h=a.slice(0,a.length-1),l=a[a.length-1],c=[];for(let d=0,p=l.length;d<p;d++){const f=l[d],v=n[d];let m;const g=h[d];if(v.mode===Xt.TRIANGLES||v.mode===Xt.TRIANGLE_STRIP||v.mode===Xt.TRIANGLE_FAN||v.mode===void 0)m=s.isSkinnedMesh===!0?new Pa(f,g):new Ae(f,g),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),v.mode===Xt.TRIANGLE_STRIP?m.geometry=Os(m.geometry,Qs):v.mode===Xt.TRIANGLE_FAN&&(m.geometry=Os(m.geometry,Pr));else if(v.mode===Xt.LINES)m=new La(f,g);else if(v.mode===Xt.LINE_STRIP)m=new Us(f,g);else if(v.mode===Xt.LINE_LOOP)m=new Ba(f,g);else if(v.mode===Xt.POINTS)m=new to(f,g);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+v.mode);Object.keys(m.geometry.morphAttributes).length>0&&Oh(m,s),m.name=t.createUniqueName(s.name||"mesh_"+e),Mi(m,s),v.extensions&&Yi(r,m,v),t.assignFinalMaterial(m),c.push(m)}for(let d=0,p=c.length;d<p;d++)t.associations.set(c[d],{meshes:e,primitives:d});if(c.length===1)return s.extensions&&Yi(r,c[0],s),c[0];const u=new Zi;s.extensions&&Yi(r,u,s),t.associations.set(u,{meshes:e});for(let d=0,p=c.length;d<p;d++)u.add(c[d]);return u})}loadCamera(e){let t;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new lt(Pn.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(t=new Fa(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Mi(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let r=0,s=t.joints.length;r<s;r++)i.push(this._loadNodeShallow(t.joints[r]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),n=r,o=[],a=[];for(let h=0,l=n.length;h<l;h++){const c=n[h];if(c){o.push(c);const u=new Jn;s!==null&&u.fromArray(s.array,h*16),a.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new Ia(o,a)})}loadAnimation(e){const t=this.json,i=this,r=t.animations[e],s=r.name?r.name:"animation_"+e,n=[],o=[],a=[],h=[],l=[];for(let c=0,u=r.channels.length;c<u;c++){const d=r.channels[c],p=r.samplers[d.sampler],f=d.target,v=f.node,m=r.parameters!==void 0?r.parameters[p.input]:p.input,g=r.parameters!==void 0?r.parameters[p.output]:p.output;f.node!==void 0&&(n.push(this.getDependency("node",v)),o.push(this.getDependency("accessor",m)),a.push(this.getDependency("accessor",g)),h.push(p),l.push(f))}return Promise.all([Promise.all(n),Promise.all(o),Promise.all(a),Promise.all(h),Promise.all(l)]).then(function(c){const u=c[0],d=c[1],p=c[2],f=c[3],v=c[4],m=[];for(let g=0,_=u.length;g<_;g++){const w=u[g],x=d[g],E=p[g],L=f[g],A=v[g];if(w===void 0)continue;w.updateMatrix&&w.updateMatrix();const T=i._createAnimationTracks(w,x,E,L,A);if(T)for(let R=0;R<T.length;R++)m.push(T[R])}return new ka(s,void 0,m)})}createNodeMesh(e){const t=this.json,i=this,r=t.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const n=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&n.traverse(function(o){if(o.isMesh)for(let a=0,h=r.weights.length;a<h;a++)o.morphTargetInfluences[a]=r.weights[a]}),n})}loadNode(e){const t=this.json,i=this,r=t.nodes[e],s=i._loadNodeShallow(e),n=[],o=r.children||[];for(let h=0,l=o.length;h<l;h++)n.push(i.getDependency("node",o[h]));const a=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(n),a]).then(function(h){const l=h[0],c=h[1],u=h[2];u!==null&&l.traverse(function(d){d.isSkinnedMesh&&d.bind(u,Wh)});for(let d=0,p=c.length;d<p;d++)l.add(c[d]);return l})}_loadNodeShallow(e){const t=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],n=s.name?r.createUniqueName(s.name):"",o=[],a=r._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return a&&o.push(a),s.camera!==void 0&&o.push(r.getDependency("camera",s.camera).then(function(h){return r._getNodeRef(r.cameraCache,s.camera,h)})),r._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){o.push(h)}),this.nodeCache[e]=Promise.all(o).then(function(h){let l;if(s.isBone===!0?l=new za:h.length>1?l=new Zi:h.length===1?l=h[0]:l=new Zs,l!==h[0])for(let c=0,u=h.length;c<u;c++)l.add(h[c]);if(s.name&&(l.userData.name=s.name,l.name=n),Mi(l,s),s.extensions&&Yi(i,l,s),s.matrix!==void 0){const c=new Jn;c.fromArray(s.matrix),l.applyMatrix4(c)}else s.translation!==void 0&&l.position.fromArray(s.translation),s.rotation!==void 0&&l.quaternion.fromArray(s.rotation),s.scale!==void 0&&l.scale.fromArray(s.scale);return r.associations.has(l)||r.associations.set(l,{}),r.associations.get(l).nodes=e,l}),this.nodeCache[e]}loadScene(e){const t=this.extensions,i=this.json.scenes[e],r=this,s=new Zi;i.name&&(s.name=r.createUniqueName(i.name)),Mi(s,i),i.extensions&&Yi(t,s,i);const n=i.nodes||[],o=[];for(let a=0,h=n.length;a<h;a++)o.push(r.getDependency("node",n[a]));return Promise.all(o).then(function(a){for(let l=0,c=a.length;l<c;l++)s.add(a[l]);const h=l=>{const c=new Map;for(const[u,d]of r.associations)(u instanceof vr||u instanceof ms)&&c.set(u,d);return l.traverse(u=>{const d=r.associations.get(u);d!=null&&c.set(u,d)}),c};return r.associations=h(s),s})}_createAnimationTracks(e,t,i,r,s){const n=[],o=e.name?e.name:e.uuid,a=[];Ci[s.path]===Ci.weights?e.traverse(function(u){u.morphTargetInfluences&&a.push(u.name?u.name:u.uuid)}):a.push(o);let h;switch(Ci[s.path]){case Ci.weights:h=ys;break;case Ci.rotation:h=ws;break;case Ci.position:case Ci.scale:h=gs;break;default:switch(i.itemSize){case 1:h=ys;break;case 2:case 3:default:h=gs;break}break}const l=r.interpolation!==void 0?kh[r.interpolation]:io,c=this._getArrayFromAccessor(i);for(let u=0,d=a.length;u<d;u++){const p=new h(a[u]+"."+Ci[s.path],t.array,c,l);r.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(p),n.push(p)}return n}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const i=Yr(t.constructor),r=new Float32Array(t.length);for(let s=0,n=t.length;s<n;s++)r[s]=t[s]*i;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(i){const r=this instanceof ws?Ih:sa;return new r(this.times,this.values,this.getValueSize()/3,i)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function Hh(y,e,t){const i=e.attributes,r=new qa;if(i.POSITION!==void 0){const o=t.json.accessors[i.POSITION],a=o.min,h=o.max;if(a!==void 0&&h!==void 0){if(r.set(new xi(a[0],a[1],a[2]),new xi(h[0],h[1],h[2])),o.normalized){const l=Yr(gn[o.componentType]);r.min.multiplyScalar(l),r.max.multiplyScalar(l)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const o=new xi,a=new xi;for(let h=0,l=s.length;h<l;h++){const c=s[h];if(c.POSITION!==void 0){const u=t.json.accessors[c.POSITION],d=u.min,p=u.max;if(d!==void 0&&p!==void 0){if(a.setX(Math.max(Math.abs(d[0]),Math.abs(p[0]))),a.setY(Math.max(Math.abs(d[1]),Math.abs(p[1]))),a.setZ(Math.max(Math.abs(d[2]),Math.abs(p[2]))),u.normalized){const f=Yr(gn[u.componentType]);a.multiplyScalar(f)}o.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(o)}y.boundingBox=r;const n=new $a;r.getCenter(n.center),n.radius=r.min.distanceTo(r.max)/2,y.boundingSphere=n}function Gs(y,e,t){const i=e.attributes,r=[];function s(n,o){return t.getDependency("accessor",n).then(function(a){y.setAttribute(o,a)})}for(const n in i){const o=Xr[n]||n.toLowerCase();o in y.attributes||r.push(s(i[n],o))}if(e.indices!==void 0&&!y.index){const n=t.getDependency("accessor",e.indices).then(function(o){y.setIndex(o)});r.push(n)}return vs.workingColorSpace!==ei&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${vs.workingColorSpace}" not supported.`),Mi(y,e),Hh(y,e,t),Promise.all(r).then(function(){return e.targets!==void 0?Nh(y,e.targets,t):y})}const Rr=new WeakMap;class oa extends jr{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,r){const s=new In(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,n=>{this.parse(n,t,r)},i,r)}parse(e,t,i=()=>{}){this.decodeDracoFile(e,t,null,null,zi).catch(i)}decodeDracoFile(e,t,i,r,s=ei,n=()=>{}){const o={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:s};return this.decodeGeometry(e,o).then(t).catch(n)}decodeGeometry(e,t){const i=JSON.stringify(t);if(Rr.has(e)){const a=Rr.get(e);if(a.key===i)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,n=e.byteLength,o=this._getWorker(s,n).then(a=>(r=a,new Promise((h,l)=>{r._callbacks[s]={resolve:h,reject:l},r.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),Rr.set(e,{key:i,promise:o}),o}_createGeometry(e){const t=new Hn;e.index&&t.setIndex(new Bi(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,n=r.array,o=r.itemSize,a=new Bi(n,o);s==="color"&&(this._assignVertexColorSpace(a,r.vertexColorSpace),a.normalized=!(n instanceof Float32Array)),t.setAttribute(s,a)}return t}_assignVertexColorSpace(e,t){if(t!==zi)return;const i=new yt;for(let r=0,s=e.count;r<s;r++)i.fromBufferAttribute(e,r).convertSRGBToLinear(),e.setXYZ(r,i.r,i.g,i.b)}_loadLibrary(e,t){const i=new In(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Uh.toString(),n=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([n]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const n=s.data;switch(n.type){case"decode":r._callbacks[n.id].resolve(n);break;case"error":r._callbacks[n.id].reject(n);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+n.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function Uh(){let y,e;onmessage=function(n){const o=n.data;switch(o.type){case"init":y=o.decoderConfig,e=new Promise(function(l){y.onModuleLoaded=function(c){l({draco:c})},DracoDecoderModule(y)});break;case"decode":const a=o.buffer,h=o.taskConfig;e.then(l=>{const c=l.draco,u=new c.Decoder;try{const d=t(c,u,new Int8Array(a),h),p=d.attributes.map(f=>f.array.buffer);d.index&&p.push(d.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:d},p)}catch(d){console.error(d),self.postMessage({type:"error",id:o.id,error:d.message})}finally{c.destroy(u)}});break}};function t(n,o,a,h){const l=h.attributeIDs,c=h.attributeTypes;let u,d;const p=o.GetEncodedGeometryType(a);if(p===n.TRIANGULAR_MESH)u=new n.Mesh,d=o.DecodeArrayToMesh(a,a.byteLength,u);else if(p===n.POINT_CLOUD)u=new n.PointCloud,d=o.DecodeArrayToPointCloud(a,a.byteLength,u);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!d.ok()||u.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+d.error_msg());const f={index:null,attributes:[]};for(const v in l){const m=self[c[v]];let g,_;if(h.useUniqueIDs)_=l[v],g=o.GetAttributeByUniqueId(u,_);else{if(_=o.GetAttributeId(u,n[l[v]]),_===-1)continue;g=o.GetAttribute(u,_)}const w=r(n,o,u,v,m,g);v==="color"&&(w.vertexColorSpace=h.vertexColorSpace),f.attributes.push(w)}return p===n.TRIANGULAR_MESH&&(f.index=i(n,o,u)),n.destroy(u),f}function i(n,o,a){const l=a.num_faces()*3,c=l*4,u=n._malloc(c);o.GetTrianglesUInt32Array(a,c,u);const d=new Uint32Array(n.HEAPF32.buffer,u,l).slice();return n._free(u),{array:d,itemSize:1}}function r(n,o,a,h,l,c){const u=c.num_components(),p=a.num_points()*u,f=p*l.BYTES_PER_ELEMENT,v=s(n,l),m=n._malloc(f);o.GetAttributeDataArrayForAllPoints(a,c,v,f,m);const g=new l(n.HEAPF32.buffer,m,p).slice();return n._free(m),{name:h,array:g,itemSize:u}}function s(n,o){switch(o){case Float32Array:return n.DT_FLOAT32;case Int8Array:return n.DT_INT8;case Int16Array:return n.DT_INT16;case Int32Array:return n.DT_INT32;case Uint8Array:return n.DT_UINT8;case Uint16Array:return n.DT_UINT16;case Uint32Array:return n.DT_UINT32}}}const qh={class:"wcp-demo-container"},$h={__name:"ThreeHouse",setup(y){const e=Ce(null),t=Ce(null),i=new di;return ot(()=>{const r=new pt;r.fog=new Ya("#262837",1,100),new cr(6);const s=new ui,n=s.load("/textures/football.png"),o=s.load("/textures/door.png"),a=s.load("/textures/wall.png");a.wrapS=It,a.wrapT=It,a.repeat.set(2,1);const h=s.load("/textures/grass001/Grass001_1K-PNG_Color.png"),l=s.load("/textures/grass001/Grass001_1K-PNG_AmbientOcclusion.png");h.repeat.set(10,10),h.wrapS=It,h.wrapT=It,l.repeat.set(10,10),l.wrapS=It,l.wrapT=It;const c=s.load("/textures/bg.png"),u=new Zi;u.position.y=.001,r.add(u);const d=new Ae(new Jt(5,3.5,5),new je({map:a}));d.position.y=3.5/2,u.add(d);const p=new Ae(new ja(4,1,4),new je({color:"#b35f45"}));p.position.y=3.5+1/2,p.rotation.y=Math.PI/4,u.add(p);const f=new Ae(new rn(2,2,5),new je({color:"#aa7b7b",map:o,transparent:!0,displacementMap:o,displacementScale:.1}));f.position.y=2/2,f.position.z=5/2+.001,u.add(f);const v=new Zi;v.position.z=5/2+1,v.position.y=.5,v.position.x=2,r.add(v);const m=new Ae(new Jt(1,1,.1),new je({map:c})),g=new Ae(new Jt(.1,1,.09),new je({}));m.position.y=1/2,v.add(m),v.add(g);const _=new oi(1,16,16),w=new je({color:"#89c854"}),x=new Ae(_,w);x.scale.set(.5,.5,.5),x.position.set(1,.3,5/2);const E=new Ae(_,w);E.scale.set(.25,.25,.25),E.position.set(1.6,.2,5/2);const L=new Ae(_,w);L.scale.set(.6,.6,.6),L.position.set(-1,.1,5/2);const A=new Ae(_,w);A.scale.set(.2,.2,.2),A.position.set(-1.5,.1,5/2+.5),u.add(x,E,L,A);const T=new Zi;r.add(T);const R=new oi(1,18,32),C=new je({map:n});for(let b=0;b<50;b++){const N=Math.random()*Math.PI*2,Y=4+Math.random()*6,$=Math.sin(N)*Y,O=Math.cos(N)*Y,U=Math.random()*.2,Q=new Ae(R,C);Q.position.set($,U,O),Q.scale.set(U,U,U),Q.castShadow=!0,T.add(Q)}const B=new Ae(new rn(20,20),new je({color:"#a9c388",side:ki,map:h,aoMap:l}));B.rotation.x=-Math.PI*.5,B.position.y=0,r.add(B);const F=new an("#b9d5ff",.12);r.add(F);const W=new bn("#b9d5ff",.12);W.position.set(15,15,-15),r.add(W);const G=new Ki("#ff7d46",1,7);G.position.set(0,3.5/2,5/2+.4),r.add(G);const j=new Ki("#ff00ff",2,3);r.add(j);const z=new Ki("#00ffff",2,3);r.add(z);const I=new Ki("#ffff00",2,3);r.add(I);const q={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},V=new lt(75,q.width/q.height,.1,1e3);V.position.z=6,V.position.y=6,V.position.x=6,r.add(V);const P=new Vt(V,t.value);P.enableDamping=!0,i.add(F,"intensity").min(0).max(1).step(.001),i.add(W,"intensity").min(0).max(1).step(.001);const k=new ft({canvas:t.value});k.setSize(q.width,q.height),k.setPixelRatio(Math.min(window.devicePixelRatio,2)),k.setClearColor("#262837"),k.shadowMap.enabled=!0,W.castShadow=!0,G.castShadow=!0,j.castShadow=!0,z.castShadow=!0,I.castShadow=!0,d.castShadow=!0,x.castShadow=!0,E.castShadow=!0,L.castShadow=!0,A.castShadow=!0,B.receiveShadow=!0;const M=new hi;function S(){requestAnimationFrame(S);const b=M.getElapsedTime(),N=b*.5;j.position.x=Math.cos(N)*4,j.position.z=Math.sin(N)*4,j.position.y=Math.sin(b*3);const Y=-b*.32;z.position.x=Math.cos(Y)*5,z.position.z=Math.sin(Y)*5,z.position.y=Math.sin(b*4)+Math.sin(b*2.5),I.position.x=Math.cos(Y)*(7+Math.sin(b*.32)),I.position.z=Math.sin(Y)*(7+Math.sin(b*.5)),I.position.y=Math.sin(b*5)+Math.sin(b*2),P.update(),k.render(r,V)}S(),window.addEventListener("resize",b=>{q.width=+getComputedStyle(e.value).width.split("px")[0],q.height=+getComputedStyle(e.value).height.split("px")[0],V.aspect=q.width/q.height,V.updateProjectionMatrix(),k.setSize(q.width,q.height),k.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",b=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy(),console.log("unmounted")}),(r,s)=>(ke(),nt("div",qh,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Xh=at($h,[["__scopeId","data-v-f2131675"]]),Yh={class:"wcp-demo-container"},jh={__name:"ThreeParticles",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{const i=new pt,s=new ui().load("/textures/1.png");let n=new Hn;const o=5e3,a=new Float32Array(o*3),h=new Float32Array(o*3);for(let g=0;g<o*3;g++)a[g]=(Math.random()-.5)*10,h[g]=Math.random()*.5;n.setAttribute("position",new Bi(a,3)),n.setAttribute("color",new Bi(h,3));const l=new eo;l.size=.1,l.sizeAttenutation=!0,l.color=new yt("#88ccff"),l.map=s,l.transparent=!0,l.depthWrite=!1,l.binding=Ka,l.vertexColors=!0;const c=new to(n,l);i.add(c);const u={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},d=new lt(75,u.width/u.height,.1,1e3);d.position.z=6,d.position.y=6,d.position.x=6,i.add(d);const p=new Vt(d,t.value);p.enableDamping=!0;const f=new ft({canvas:t.value});f.setSize(u.width,u.height),f.setPixelRatio(Math.min(window.devicePixelRatio,2));const v=new hi;function m(){requestAnimationFrame(m);const g=v.getElapsedTime();c.rotation.y=g*.1,p.update(),f.render(i,d)}m(),window.addEventListener("resize",g=>{u.width=+getComputedStyle(e.value).width.split("px")[0],u.height=+getComputedStyle(e.value).height.split("px")[0],d.aspect=u.width/u.height,d.updateProjectionMatrix(),f.setSize(u.width,u.height),f.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",g=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{console.log("unmounted")}),(i,r)=>(ke(),nt("div",Yh,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},Kh=at(jh,[["__scopeId","data-v-30d4acd0"]]);function Yn(y){throw new Error('Could not dynamically require "'+y+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var aa={exports:{}};(function(y,e){(function(t){y.exports=t()})(function(){return function t(i,r,s){function n(h,l){if(!r[h]){if(!i[h]){var c=typeof Yn=="function"&&Yn;if(!l&&c)return c(h,!0);if(o)return o(h,!0);throw new Error("Cannot find module '"+h+"'")}var u=r[h]={exports:{}};i[h][0].call(u.exports,function(d){var p=i[h][1][d];return n(p||d)},u,u.exports,t,i,r,s)}return r[h].exports}for(var o=typeof Yn=="function"&&Yn,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(t,i,r){i.exports={name:"cannon",version:"0.6.2",description:"A lightweight 3D physics engine written in JavaScript.",homepage:"https://github.com/schteppe/cannon.js",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["cannon.js","cannon","physics","engine","3d"],main:"./build/cannon.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/cannon.js.git"},bugs:{url:"https://github.com/schteppe/cannon.js/issues"},licenses:[{type:"MIT"}],devDependencies:{jshint:"latest","uglify-js":"latest",nodeunit:"^0.9.0",grunt:"~0.4.0","grunt-contrib-jshint":"~0.1.1","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-concat":"~0.1.3","grunt-contrib-uglify":"^0.5.1","grunt-browserify":"^2.1.4","grunt-contrib-yuidoc":"^0.5.2",browserify:"*"},dependencies:{}}},{}],2:[function(t,i,r){i.exports={version:t("../package.json").version,AABB:t("./collision/AABB"),ArrayCollisionMatrix:t("./collision/ArrayCollisionMatrix"),Body:t("./objects/Body"),Box:t("./shapes/Box"),Broadphase:t("./collision/Broadphase"),Constraint:t("./constraints/Constraint"),ContactEquation:t("./equations/ContactEquation"),Narrowphase:t("./world/Narrowphase"),ConeTwistConstraint:t("./constraints/ConeTwistConstraint"),ContactMaterial:t("./material/ContactMaterial"),ConvexPolyhedron:t("./shapes/ConvexPolyhedron"),Cylinder:t("./shapes/Cylinder"),DistanceConstraint:t("./constraints/DistanceConstraint"),Equation:t("./equations/Equation"),EventTarget:t("./utils/EventTarget"),FrictionEquation:t("./equations/FrictionEquation"),GSSolver:t("./solver/GSSolver"),GridBroadphase:t("./collision/GridBroadphase"),Heightfield:t("./shapes/Heightfield"),HingeConstraint:t("./constraints/HingeConstraint"),LockConstraint:t("./constraints/LockConstraint"),Mat3:t("./math/Mat3"),Material:t("./material/Material"),NaiveBroadphase:t("./collision/NaiveBroadphase"),ObjectCollisionMatrix:t("./collision/ObjectCollisionMatrix"),Pool:t("./utils/Pool"),Particle:t("./shapes/Particle"),Plane:t("./shapes/Plane"),PointToPointConstraint:t("./constraints/PointToPointConstraint"),Quaternion:t("./math/Quaternion"),Ray:t("./collision/Ray"),RaycastVehicle:t("./objects/RaycastVehicle"),RaycastResult:t("./collision/RaycastResult"),RigidVehicle:t("./objects/RigidVehicle"),RotationalEquation:t("./equations/RotationalEquation"),RotationalMotorEquation:t("./equations/RotationalMotorEquation"),SAPBroadphase:t("./collision/SAPBroadphase"),SPHSystem:t("./objects/SPHSystem"),Shape:t("./shapes/Shape"),Solver:t("./solver/Solver"),Sphere:t("./shapes/Sphere"),SplitSolver:t("./solver/SplitSolver"),Spring:t("./objects/Spring"),Trimesh:t("./shapes/Trimesh"),Vec3:t("./math/Vec3"),Vec3Pool:t("./utils/Vec3Pool"),World:t("./world/World")}},{"../package.json":1,"./collision/AABB":3,"./collision/ArrayCollisionMatrix":4,"./collision/Broadphase":5,"./collision/GridBroadphase":6,"./collision/NaiveBroadphase":7,"./collision/ObjectCollisionMatrix":8,"./collision/Ray":9,"./collision/RaycastResult":10,"./collision/SAPBroadphase":11,"./constraints/ConeTwistConstraint":12,"./constraints/Constraint":13,"./constraints/DistanceConstraint":14,"./constraints/HingeConstraint":15,"./constraints/LockConstraint":16,"./constraints/PointToPointConstraint":17,"./equations/ContactEquation":19,"./equations/Equation":20,"./equations/FrictionEquation":21,"./equations/RotationalEquation":22,"./equations/RotationalMotorEquation":23,"./material/ContactMaterial":24,"./material/Material":25,"./math/Mat3":27,"./math/Quaternion":28,"./math/Vec3":30,"./objects/Body":31,"./objects/RaycastVehicle":32,"./objects/RigidVehicle":33,"./objects/SPHSystem":34,"./objects/Spring":35,"./shapes/Box":37,"./shapes/ConvexPolyhedron":38,"./shapes/Cylinder":39,"./shapes/Heightfield":40,"./shapes/Particle":41,"./shapes/Plane":42,"./shapes/Shape":43,"./shapes/Sphere":44,"./shapes/Trimesh":45,"./solver/GSSolver":46,"./solver/Solver":47,"./solver/SplitSolver":48,"./utils/EventTarget":49,"./utils/Pool":51,"./utils/Vec3Pool":54,"./world/Narrowphase":55,"./world/World":56}],3:[function(t,i,r){var s=t("../math/Vec3");t("../utils/Utils"),i.exports=n;function n(h){h=h||{},this.lowerBound=new s,h.lowerBound&&this.lowerBound.copy(h.lowerBound),this.upperBound=new s,h.upperBound&&this.upperBound.copy(h.upperBound)}var o=new s;n.prototype.setFromPoints=function(h,l,c,u){var d=this.lowerBound,p=this.upperBound,f=c;d.copy(h[0]),f&&f.vmult(d,d),p.copy(d);for(var v=1;v<h.length;v++){var m=h[v];f&&(f.vmult(m,o),m=o),m.x>p.x&&(p.x=m.x),m.x<d.x&&(d.x=m.x),m.y>p.y&&(p.y=m.y),m.y<d.y&&(d.y=m.y),m.z>p.z&&(p.z=m.z),m.z<d.z&&(d.z=m.z)}return l&&(l.vadd(d,d),l.vadd(p,p)),u&&(d.x-=u,d.y-=u,d.z-=u,p.x+=u,p.y+=u,p.z+=u),this},n.prototype.copy=function(h){return this.lowerBound.copy(h.lowerBound),this.upperBound.copy(h.upperBound),this},n.prototype.clone=function(){return new n().copy(this)},n.prototype.extend=function(h){var l=h.lowerBound.x;this.lowerBound.x>l&&(this.lowerBound.x=l);var c=h.upperBound.x;this.upperBound.x<c&&(this.upperBound.x=c);var l=h.lowerBound.y;this.lowerBound.y>l&&(this.lowerBound.y=l);var c=h.upperBound.y;this.upperBound.y<c&&(this.upperBound.y=c);var l=h.lowerBound.z;this.lowerBound.z>l&&(this.lowerBound.z=l);var c=h.upperBound.z;this.upperBound.z<c&&(this.upperBound.z=c)},n.prototype.overlaps=function(h){var l=this.lowerBound,c=this.upperBound,u=h.lowerBound,d=h.upperBound;return(u.x<=c.x&&c.x<=d.x||l.x<=d.x&&d.x<=c.x)&&(u.y<=c.y&&c.y<=d.y||l.y<=d.y&&d.y<=c.y)&&(u.z<=c.z&&c.z<=d.z||l.z<=d.z&&d.z<=c.z)},n.prototype.contains=function(h){var l=this.lowerBound,c=this.upperBound,u=h.lowerBound,d=h.upperBound;return l.x<=u.x&&c.x>=d.x&&l.y<=u.y&&c.y>=d.y&&l.z<=u.z&&c.z>=d.z},n.prototype.getCorners=function(h,l,c,u,d,p,f,v){var m=this.lowerBound,g=this.upperBound;h.copy(m),l.set(g.x,m.y,m.z),c.set(g.x,g.y,m.z),u.set(m.x,g.y,g.z),d.set(g.x,m.y,m.z),p.set(m.x,g.y,m.z),f.set(m.x,m.y,g.z),v.copy(g)};var a=[new s,new s,new s,new s,new s,new s,new s,new s];n.prototype.toLocalFrame=function(h,l){var c=a,u=c[0],d=c[1],p=c[2],f=c[3],v=c[4],m=c[5],g=c[6],_=c[7];this.getCorners(u,d,p,f,v,m,g,_);for(var w=0;w!==8;w++){var x=c[w];h.pointToLocal(x,x)}return l.setFromPoints(c)},n.prototype.toWorldFrame=function(h,l){var c=a,u=c[0],d=c[1],p=c[2],f=c[3],v=c[4],m=c[5],g=c[6],_=c[7];this.getCorners(u,d,p,f,v,m,g,_);for(var w=0;w!==8;w++){var x=c[w];h.pointToWorld(x,x)}return l.setFromPoints(c)}},{"../math/Vec3":30,"../utils/Utils":53}],4:[function(t,i,r){i.exports=s;function s(){this.matrix=[]}s.prototype.get=function(n,o){if(n=n.index,o=o.index,o>n){var a=o;o=n,n=a}return this.matrix[(n*(n+1)>>1)+o-1]},s.prototype.set=function(n,o,a){if(n=n.index,o=o.index,o>n){var h=o;o=n,n=h}this.matrix[(n*(n+1)>>1)+o-1]=a?1:0},s.prototype.reset=function(){for(var n=0,o=this.matrix.length;n!==o;n++)this.matrix[n]=0},s.prototype.setNumObjects=function(n){this.matrix.length=n*(n-1)>>1}},{}],5:[function(t,i,r){var s=t("../objects/Body"),n=t("../math/Vec3"),o=t("../math/Quaternion");t("../shapes/Shape"),t("../shapes/Plane"),i.exports=a;function a(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}a.prototype.collisionPairs=function(f,v,m){throw new Error("collisionPairs not implemented for this BroadPhase class!")};var h=s.STATIC|s.KINEMATIC;a.prototype.needBroadphaseCollision=function(f,v){return!(!(f.collisionFilterGroup&v.collisionFilterMask)||!(v.collisionFilterGroup&f.collisionFilterMask)||(f.type&h||f.sleepState===s.SLEEPING)&&(v.type&h||v.sleepState===s.SLEEPING))},a.prototype.intersectionTest=function(f,v,m,g){this.useBoundingBoxes?this.doBoundingBoxBroadphase(f,v,m,g):this.doBoundingSphereBroadphase(f,v,m,g)};var l=new n;new n,new o,new n,a.prototype.doBoundingSphereBroadphase=function(f,v,m,g){var _=l;v.position.vsub(f.position,_);var w=Math.pow(f.boundingRadius+v.boundingRadius,2),x=_.norm2();x<w&&(m.push(f),g.push(v))},a.prototype.doBoundingBoxBroadphase=function(f,v,m,g){f.aabbNeedsUpdate&&f.computeAABB(),v.aabbNeedsUpdate&&v.computeAABB(),f.aabb.overlaps(v.aabb)&&(m.push(f),g.push(v))};var c={keys:[]},u=[],d=[];a.prototype.makePairsUnique=function(f,v){for(var m=c,g=u,_=d,w=f.length,x=0;x!==w;x++)g[x]=f[x],_[x]=v[x];f.length=0,v.length=0;for(var x=0;x!==w;x++){var E=g[x].id,L=_[x].id,A=E<L?E+","+L:L+","+E;m[A]=x,m.keys.push(A)}for(var x=0;x!==m.keys.length;x++){var A=m.keys.pop(),T=m[A];f.push(g[T]),v.push(_[T]),delete m[A]}},a.prototype.setWorld=function(f){};var p=new n;a.boundingSphereCheck=function(f,v){var m=p;return f.position.vsub(v.position,m),Math.pow(f.shape.boundingSphereRadius+v.shape.boundingSphereRadius,2)>m.norm2()},a.prototype.aabbQuery=function(f,v,m){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Plane":42,"../shapes/Shape":43}],6:[function(t,i,r){i.exports=a;var s=t("./Broadphase"),n=t("../math/Vec3"),o=t("../shapes/Shape");function a(l,c,u,d,p){s.apply(this),this.nx=u||10,this.ny=d||10,this.nz=p||10,this.aabbMin=l||new n(100,100,100),this.aabbMax=c||new n(-100,-100,-100);var f=this.nx*this.ny*this.nz;if(f<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=f,this.binLengths.length=f;for(var v=0;v<f;v++)this.bins[v]=[],this.binLengths[v]=0}a.prototype=new s,a.prototype.constructor=a;var h=new n;new n,a.prototype.collisionPairs=function(l,c,u){var d=l.numObjects(),p=l.bodies,Y=this.aabbMax,N=this.aabbMin,f=this.nx,v=this.ny,m=this.nz,g=v*m,_=m,w=1,x=Y.x,E=Y.y,L=Y.z,A=N.x,T=N.y,R=N.z,C=f/(x-A),B=v/(E-T),F=m/(L-R),W=(x-A)/f,G=(E-T)/v,j=(L-R)/m,z=Math.sqrt(W*W+G*G+j*j)*.5,I=o.types,q=I.SPHERE,V=I.PLANE;I.BOX,I.COMPOUND,I.CONVEXPOLYHEDRON;for(var P=this.bins,k=this.binLengths,M=this.bins.length,S=0;S!==M;S++)k[S]=0;var b=Math.ceil,N=Math.min,Y=Math.max;function $(pi,Ei,fi,Dt,Wt,Di,Si){var ti=(pi-A)*C|0,Qt=(Ei-T)*B|0,Lt=(fi-R)*F|0,ii=b((Dt-A)*C),Zt=b((Wt-T)*B),vt=b((Di-R)*F);ti<0?ti=0:ti>=f&&(ti=f-1),Qt<0?Qt=0:Qt>=v&&(Qt=v-1),Lt<0?Lt=0:Lt>=m&&(Lt=m-1),ii<0?ii=0:ii>=f&&(ii=f-1),Zt<0?Zt=0:Zt>=v&&(Zt=v-1),vt<0?vt=0:vt>=m&&(vt=m-1),ti*=g,Qt*=_,Lt*=w,ii*=g,Zt*=_,vt*=w;for(var Wi=ti;Wi<=ii;Wi+=g)for(var Gi=Qt;Gi<=Zt;Gi+=_)for(var Hi=Lt;Hi<=vt;Hi+=w){var cn=Wi+Gi+Hi;P[cn][k[cn]++]=Si}}for(var S=0;S!==d;S++){var O=p[S],U=O.shape;switch(U.type){case q:var Q=O.position.x,fe=O.position.y,ue=O.position.z,he=U.radius;$(Q-he,fe-he,ue-he,Q+he,fe+he,ue+he,O);break;case V:U.worldNormalNeedsUpdate&&U.computeWorldNormal(O.quaternion);var K=U.worldNormal,te=A+W*.5-O.position.x,Me=T+G*.5-O.position.y,ge=R+j*.5-O.position.z,Ne=h;Ne.set(te,Me,ge);for(var pe=0,Fe=0;pe!==f;pe++,Fe+=g,Ne.y=Me,Ne.x+=W)for(var ze=0,Ie=0;ze!==v;ze++,Ie+=_,Ne.z=ge,Ne.y+=G)for(var De=0,Pe=0;De!==m;De++,Pe+=w,Ne.z+=j)if(Ne.dot(K)<z){var Ge=Fe+Ie+Pe;P[Ge][k[Ge]++]=O}break;default:O.aabbNeedsUpdate&&O.computeAABB(),$(O.aabb.lowerBound.x,O.aabb.lowerBound.y,O.aabb.lowerBound.z,O.aabb.upperBound.x,O.aabb.upperBound.y,O.aabb.upperBound.z,O);break}}for(var S=0;S!==M;S++){var Le=k[S];if(Le>1)for(var Je=P[S],pe=0;pe!==Le;pe++)for(var O=Je[pe],ze=0;ze!==pe;ze++){var _t=Je[ze];this.needBroadphaseCollision(O,_t)&&this.intersectionTest(O,_t,c,u)}}this.makePairsUnique(c,u)}},{"../math/Vec3":30,"../shapes/Shape":43,"./Broadphase":5}],7:[function(t,i,r){i.exports=o;var s=t("./Broadphase"),n=t("./AABB");function o(){s.apply(this)}o.prototype=new s,o.prototype.constructor=o,o.prototype.collisionPairs=function(a,h,l){var c=a.bodies,u=c.length,d,p,f,v;for(d=0;d!==u;d++)for(p=0;p!==d;p++)f=c[d],v=c[p],this.needBroadphaseCollision(f,v)&&this.intersectionTest(f,v,h,l)},new n,o.prototype.aabbQuery=function(a,h,l){l=l||[];for(var c=0;c<a.bodies.length;c++){var u=a.bodies[c];u.aabbNeedsUpdate&&u.computeAABB(),u.aabb.overlaps(h)&&l.push(u)}return l}},{"./AABB":3,"./Broadphase":5}],8:[function(t,i,r){i.exports=s;function s(){this.matrix={}}s.prototype.get=function(n,o){if(n=n.id,o=o.id,o>n){var a=o;o=n,n=a}return n+"-"+o in this.matrix},s.prototype.set=function(n,o,a){if(n=n.id,o=o.id,o>n){var h=o;o=n,n=h}a?this.matrix[n+"-"+o]=!0:delete this.matrix[n+"-"+o]},s.prototype.reset=function(){this.matrix={}},s.prototype.setNumObjects=function(n){}},{}],9:[function(t,i,r){i.exports=c;var s=t("../math/Vec3"),n=t("../math/Quaternion"),o=t("../math/Transform");t("../shapes/ConvexPolyhedron"),t("../shapes/Box");var a=t("../collision/RaycastResult"),h=t("../shapes/Shape"),l=t("../collision/AABB");function c(M,S){this.from=M?M.clone():new s,this.to=S?S.clone():new s,this._direction=new s,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=c.ANY,this.result=new a,this.hasHit=!1,this.callback=function(b){}}c.prototype.constructor=c,c.CLOSEST=1,c.ANY=2,c.ALL=4;var u=new l,d=[];c.prototype.intersectWorld=function(M,S){return this.mode=S.mode||c.ANY,this.result=S.result||new a,this.skipBackfaces=!!S.skipBackfaces,this.collisionFilterMask=typeof S.collisionFilterMask<"u"?S.collisionFilterMask:-1,this.collisionFilterGroup=typeof S.collisionFilterGroup<"u"?S.collisionFilterGroup:-1,S.from&&this.from.copy(S.from),S.to&&this.to.copy(S.to),this.callback=S.callback||function(){},this.hasHit=!1,this.result.reset(),this._updateDirection(),this.getAABB(u),d.length=0,M.broadphase.aabbQuery(M,u,d),this.intersectBodies(d),this.hasHit};var p=new s,f=new s;c.pointInTriangle=v;function v(M,S,b,N){N.vsub(S,V),b.vsub(S,p),M.vsub(S,f);var Y=V.dot(V),$=V.dot(p),O=V.dot(f),U=p.dot(p),Q=p.dot(f),fe,ue;return(fe=U*O-$*Q)>=0&&(ue=Y*Q-$*O)>=0&&fe+ue<Y*U-$*$}var m=new s,g=new n;c.prototype.intersectBody=function(M,S){S&&(this.result=S,this._updateDirection());var b=this.checkCollisionResponse;if(!(b&&!M.collisionResponse)&&!(!(this.collisionFilterGroup&M.collisionFilterMask)||!(M.collisionFilterGroup&this.collisionFilterMask)))for(var N=m,Y=g,$=0,O=M.shapes.length;$<O;$++){var U=M.shapes[$];if(!(b&&!U.collisionResponse)&&(M.quaternion.mult(M.shapeOrientations[$],Y),M.quaternion.vmult(M.shapeOffsets[$],N),N.vadd(M.position,N),this.intersectShape(U,Y,N,M),this.result._shouldStop))break}},c.prototype.intersectBodies=function(M,S){S&&(this.result=S,this._updateDirection());for(var b=0,N=M.length;!this.result._shouldStop&&b<N;b++)this.intersectBody(M[b])},c.prototype._updateDirection=function(){this.to.vsub(this.from,this._direction),this._direction.normalize()},c.prototype.intersectShape=function(M,S,b,N){var Y=this.from,$=k(Y,this._direction,b);if(!($>M.boundingSphereRadius)){var O=this[M.type];O&&O.call(this,M,S,b,N)}},new s,new s;var _=new s,w=new s,x=new s,E=new s;new s,new a,c.prototype.intersectBox=function(M,S,b,N){return this.intersectConvex(M.convexPolyhedronRepresentation,S,b,N)},c.prototype[h.types.BOX]=c.prototype.intersectBox,c.prototype.intersectPlane=function(M,S,b,N){var Y=this.from,$=this.to,O=this._direction,U=new s(0,0,1);S.vmult(U,U);var Q=new s;Y.vsub(b,Q);var fe=Q.dot(U);$.vsub(b,Q);var ue=Q.dot(U);if(!(fe*ue>0)&&!(Y.distanceTo($)<fe)){var he=U.dot(O);if(!(Math.abs(he)<this.precision)){var K=new s,te=new s,Me=new s;Y.vsub(b,K);var ge=-U.dot(K)/he;O.scale(ge,te),Y.vadd(te,Me),this.reportIntersection(U,Me,M,N,-1)}}},c.prototype[h.types.PLANE]=c.prototype.intersectPlane,c.prototype.getAABB=function(M){var S=this.to,b=this.from;M.lowerBound.x=Math.min(S.x,b.x),M.lowerBound.y=Math.min(S.y,b.y),M.lowerBound.z=Math.min(S.z,b.z),M.upperBound.x=Math.max(S.x,b.x),M.upperBound.y=Math.max(S.y,b.y),M.upperBound.z=Math.max(S.z,b.z)};var L={faceList:[0]};c.prototype.intersectHeightfield=function(M,S,b,N){M.data,M.elementSize;var Y=new s,$=new c(this.from,this.to);o.pointToLocalFrame(b,S,$.from,$.from),o.pointToLocalFrame(b,S,$.to,$.to);var O=[],U=null,Q=null,fe=null,ue=null,he=M.getIndexOfPosition($.from.x,$.from.y,O,!1);if(he&&(U=O[0],Q=O[1],fe=O[0],ue=O[1]),he=M.getIndexOfPosition($.to.x,$.to.y,O,!1),he&&((U===null||O[0]<U)&&(U=O[0]),(fe===null||O[0]>fe)&&(fe=O[0]),(Q===null||O[1]<Q)&&(Q=O[1]),(ue===null||O[1]>ue)&&(ue=O[1])),U!==null){var K=[];M.getRectMinMax(U,Q,fe,ue,K),K[0],K[1];for(var te=U;te<=fe;te++)for(var Me=Q;Me<=ue;Me++){if(this.result._shouldStop||(M.getConvexTrianglePillar(te,Me,!1),o.pointToWorldFrame(b,S,M.pillarOffset,Y),this.intersectConvex(M.pillarConvex,S,Y,N,L),this.result._shouldStop))return;M.getConvexTrianglePillar(te,Me,!0),o.pointToWorldFrame(b,S,M.pillarOffset,Y),this.intersectConvex(M.pillarConvex,S,Y,N,L)}}},c.prototype[h.types.HEIGHTFIELD]=c.prototype.intersectHeightfield;var A=new s,T=new s;c.prototype.intersectSphere=function(M,S,b,N){var Y=this.from,$=this.to,O=M.radius,U=Math.pow($.x-Y.x,2)+Math.pow($.y-Y.y,2)+Math.pow($.z-Y.z,2),Q=2*(($.x-Y.x)*(Y.x-b.x)+($.y-Y.y)*(Y.y-b.y)+($.z-Y.z)*(Y.z-b.z)),fe=Math.pow(Y.x-b.x,2)+Math.pow(Y.y-b.y,2)+Math.pow(Y.z-b.z,2)-Math.pow(O,2),ue=Math.pow(Q,2)-4*U*fe,he=A,K=T;if(!(ue<0))if(ue===0)Y.lerp($,ue,he),he.vsub(b,K),K.normalize(),this.reportIntersection(K,he,M,N,-1);else{var te=(-Q-Math.sqrt(ue))/(2*U),Me=(-Q+Math.sqrt(ue))/(2*U);if(te>=0&&te<=1&&(Y.lerp($,te,he),he.vsub(b,K),K.normalize(),this.reportIntersection(K,he,M,N,-1)),this.result._shouldStop)return;Me>=0&&Me<=1&&(Y.lerp($,Me,he),he.vsub(b,K),K.normalize(),this.reportIntersection(K,he,M,N,-1))}},c.prototype[h.types.SPHERE]=c.prototype.intersectSphere;var R=new s;new s,new s;var C=new s;c.prototype.intersectConvex=function(S,b,N,Y,$){for(var O=R,U=C,Q=$&&$.faceList||null,fe=S.faces,ue=S.vertices,he=S.faceNormals,K=this._direction,te=this.from,Me=this.to,ge=te.distanceTo(Me),Ne=Q?Q.length:fe.length,pe=this.result,Fe=0;!pe._shouldStop&&Fe<Ne;Fe++){var ze=Q?Q[Fe]:Fe,Ie=fe[ze],De=he[ze],Pe=b,Ge=N;U.copy(ue[Ie[0]]),Pe.vmult(U,U),U.vadd(Ge,U),U.vsub(te,U),Pe.vmult(De,O);var Le=K.dot(O);if(!(Math.abs(Le)<this.precision)){var Je=O.dot(U)/Le;if(!(Je<0)){K.mult(Je,_),_.vadd(te,_),w.copy(ue[Ie[0]]),Pe.vmult(w,w),Ge.vadd(w,w);for(var _t=1;!pe._shouldStop&&_t<Ie.length-1;_t++){x.copy(ue[Ie[_t]]),E.copy(ue[Ie[_t+1]]),Pe.vmult(x,x),Pe.vmult(E,E),Ge.vadd(x,x),Ge.vadd(E,E);var pi=_.distanceTo(te);!(v(_,w,x,E)||v(_,x,w,E))||pi>ge||this.reportIntersection(O,_,S,Y,ze)}}}}},c.prototype[h.types.CONVEXPOLYHEDRON]=c.prototype.intersectConvex;var B=new s,F=new s,W=new s,G=new s,j=new s,z=new s;new l;var I=[],q=new o;c.prototype.intersectTrimesh=function(S,b,N,Y,$){var O=B,U=I,Q=q,fe=C,ue=F,he=W,K=G,te=z,Me=j;$&&$.faceList;var ge=S.indices;S.vertices,S.faceNormals;var Ne=this.from,pe=this.to,Fe=this._direction;Q.position.copy(N),Q.quaternion.copy(b),o.vectorToLocalFrame(N,b,Fe,ue),o.pointToLocalFrame(N,b,Ne,he),o.pointToLocalFrame(N,b,pe,K);var ze=he.distanceSquared(K);S.tree.rayQuery(this,Q,U);for(var Ie=0,De=U.length;!this.result._shouldStop&&Ie!==De;Ie++){var Pe=U[Ie];S.getNormal(Pe,O),S.getVertex(ge[Pe*3],w),w.vsub(he,fe);var Ge=ue.dot(O),Le=O.dot(fe)/Ge;if(!(Le<0)){ue.scale(Le,_),_.vadd(he,_),S.getVertex(ge[Pe*3+1],x),S.getVertex(ge[Pe*3+2],E);var Je=_.distanceSquared(he);!(v(_,x,w,E)||v(_,w,x,E))||Je>ze||(o.vectorToWorldFrame(b,O,Me),o.pointToWorldFrame(N,b,_,te),this.reportIntersection(Me,te,S,Y,Pe))}}U.length=0},c.prototype[h.types.TRIMESH]=c.prototype.intersectTrimesh,c.prototype.reportIntersection=function(M,S,b,N,Y){var $=this.from,O=this.to,U=$.distanceTo(S),Q=this.result;if(!(this.skipBackfaces&&M.dot(this._direction)>0))switch(Q.hitFaceIndex=typeof Y<"u"?Y:-1,this.mode){case c.ALL:this.hasHit=!0,Q.set($,O,M,S,b,N,U),Q.hasHit=!0,this.callback(Q);break;case c.CLOSEST:(U<Q.distance||!Q.hasHit)&&(this.hasHit=!0,Q.hasHit=!0,Q.set($,O,M,S,b,N,U));break;case c.ANY:this.hasHit=!0,Q.hasHit=!0,Q.set($,O,M,S,b,N,U),Q._shouldStop=!0;break}};var V=new s,P=new s;function k(M,S,b){b.vsub(M,V);var N=V.dot(S);S.mult(N,P),P.vadd(M,P);var Y=b.distanceTo(P);return Y}},{"../collision/AABB":3,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/Box":37,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43}],10:[function(t,i,r){var s=t("../math/Vec3");i.exports=n;function n(){this.rayFromWorld=new s,this.rayToWorld=new s,this.hitNormalWorld=new s,this.hitPointWorld=new s,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1}n.prototype.reset=function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this._shouldStop=!1},n.prototype.abort=function(){this._shouldStop=!0},n.prototype.set=function(o,a,h,l,c,u,d){this.rayFromWorld.copy(o),this.rayToWorld.copy(a),this.hitNormalWorld.copy(h),this.hitPointWorld.copy(l),this.shape=c,this.body=u,this.distance=d}},{"../math/Vec3":30}],11:[function(t,i,r){t("../shapes/Shape");var s=t("../collision/Broadphase");i.exports=n;function n(o){s.apply(this),this.axisList=[],this.world=null,this.axisIndex=0;var a=this.axisList;this._addBodyHandler=function(h){a.push(h.body)},this._removeBodyHandler=function(h){var l=a.indexOf(h.body);l!==-1&&a.splice(l,1)},o&&this.setWorld(o)}n.prototype=new s,n.prototype.setWorld=function(o){this.axisList.length=0;for(var a=0;a<o.bodies.length;a++)this.axisList.push(o.bodies[a]);o.removeEventListener("addBody",this._addBodyHandler),o.removeEventListener("removeBody",this._removeBodyHandler),o.addEventListener("addBody",this._addBodyHandler),o.addEventListener("removeBody",this._removeBodyHandler),this.world=o,this.dirty=!0},n.insertionSortX=function(o){for(var a=1,h=o.length;a<h;a++){for(var l=o[a],c=a-1;c>=0&&!(o[c].aabb.lowerBound.x<=l.aabb.lowerBound.x);c--)o[c+1]=o[c];o[c+1]=l}return o},n.insertionSortY=function(o){for(var a=1,h=o.length;a<h;a++){for(var l=o[a],c=a-1;c>=0&&!(o[c].aabb.lowerBound.y<=l.aabb.lowerBound.y);c--)o[c+1]=o[c];o[c+1]=l}return o},n.insertionSortZ=function(o){for(var a=1,h=o.length;a<h;a++){for(var l=o[a],c=a-1;c>=0&&!(o[c].aabb.lowerBound.z<=l.aabb.lowerBound.z);c--)o[c+1]=o[c];o[c+1]=l}return o},n.prototype.collisionPairs=function(o,a,h){var l=this.axisList,c=l.length,u=this.axisIndex,d,p;for(this.dirty&&(this.sortList(),this.dirty=!1),d=0;d!==c;d++){var f=l[d];for(p=d+1;p<c;p++){var v=l[p];if(this.needBroadphaseCollision(f,v)){if(!n.checkBounds(f,v,u))break;this.intersectionTest(f,v,a,h)}}}},n.prototype.sortList=function(){for(var o=this.axisList,a=this.axisIndex,h=o.length,l=0;l!==h;l++){var c=o[l];c.aabbNeedsUpdate&&c.computeAABB()}a===0?n.insertionSortX(o):a===1?n.insertionSortY(o):a===2&&n.insertionSortZ(o)},n.checkBounds=function(o,a,h){var l,c;h===0?(l=o.position.x,c=a.position.x):h===1?(l=o.position.y,c=a.position.y):h===2&&(l=o.position.z,c=a.position.z);var u=o.boundingRadius,d=a.boundingRadius,p=l+u,f=c-d;return f<p},n.prototype.autoDetectAxis=function(){for(var o=0,a=0,h=0,l=0,c=0,u=0,d=this.axisList,p=d.length,f=1/p,v=0;v!==p;v++){var m=d[v],g=m.position.x;o+=g,a+=g*g;var _=m.position.y;h+=_,l+=_*_;var w=m.position.z;c+=w,u+=w*w}var x=a-o*o*f,E=l-h*h*f,L=u-c*c*f;x>E?x>L?this.axisIndex=0:this.axisIndex=2:E>L?this.axisIndex=1:this.axisIndex=2},n.prototype.aabbQuery=function(o,a,h){h=h||[],this.dirty&&(this.sortList(),this.dirty=!1);var l=this.axisIndex,c="x";l===1&&(c="y"),l===2&&(c="z");var u=this.axisList;a.lowerBound[c],a.upperBound[c];for(var d=0;d<u.length;d++){var p=u[d];p.aabbNeedsUpdate&&p.computeAABB(),p.aabb.overlaps(a)&&h.push(p)}return h}},{"../collision/Broadphase":5,"../shapes/Shape":43}],12:[function(t,i,r){i.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),n=t("../equations/ConeEquation"),o=t("../equations/RotationalEquation");t("../equations/ContactEquation");var a=t("../math/Vec3");function h(l,c,u){u=u||{};var d=typeof u.maxForce<"u"?u.maxForce:1e6,p=u.pivotA?u.pivotA.clone():new a,f=u.pivotB?u.pivotB.clone():new a;this.axisA=u.axisA?u.axisA.clone():new a,this.axisB=u.axisB?u.axisB.clone():new a,s.call(this,l,p,c,f,d),this.collideConnected=!!u.collideConnected,this.angle=typeof u.angle<"u"?u.angle:0;var v=this.coneEquation=new n(l,c,u),m=this.twistEquation=new o(l,c,u);this.twistAngle=typeof u.twistAngle<"u"?u.twistAngle:0,v.maxForce=0,v.minForce=-d,m.maxForce=0,m.minForce=-d,this.equations.push(v,m)}h.prototype=new s,h.constructor=h,new a,new a,h.prototype.update=function(){var l=this.bodyA,c=this.bodyB,u=this.coneEquation,d=this.twistEquation;s.prototype.update.call(this),l.vectorToWorldFrame(this.axisA,u.axisA),c.vectorToWorldFrame(this.axisB,u.axisB),this.axisA.tangents(d.axisA,d.axisA),l.vectorToWorldFrame(d.axisA,d.axisA),this.axisB.tangents(d.axisB,d.axisB),c.vectorToWorldFrame(d.axisB,d.axisB),u.angle=this.angle,d.maxAngle=this.twistAngle}},{"../equations/ConeEquation":18,"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],13:[function(t,i,r){i.exports=n;var s=t("../utils/Utils");function n(o,a,h){h=s.defaults(h,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=o,this.bodyB=a,this.id=n.idCounter++,this.collideConnected=h.collideConnected,h.wakeUpBodies&&(o&&o.wakeUp(),a&&a.wakeUp())}n.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},n.prototype.enable=function(){for(var o=this.equations,a=0;a<o.length;a++)o[a].enabled=!0},n.prototype.disable=function(){for(var o=this.equations,a=0;a<o.length;a++)o[a].enabled=!1},n.idCounter=0},{"../utils/Utils":53}],14:[function(t,i,r){i.exports=o;var s=t("./Constraint"),n=t("../equations/ContactEquation");function o(a,h,l,c){s.call(this,a,h),typeof l>"u"&&(l=a.position.distanceTo(h.position)),typeof c>"u"&&(c=1e6),this.distance=l;var u=this.distanceEquation=new n(a,h);this.equations.push(u),u.minForce=-c,u.maxForce=c}o.prototype=new s,o.prototype.update=function(){var a=this.bodyA,h=this.bodyB,l=this.distanceEquation,c=this.distance*.5,u=l.ni;h.position.vsub(a.position,u),u.normalize(),u.mult(c,l.ri),u.mult(-c,l.rj)}},{"../equations/ContactEquation":19,"./Constraint":13}],15:[function(t,i,r){i.exports=h,t("./Constraint");var s=t("./PointToPointConstraint"),n=t("../equations/RotationalEquation"),o=t("../equations/RotationalMotorEquation");t("../equations/ContactEquation");var a=t("../math/Vec3");function h(u,d,p){p=p||{};var f=typeof p.maxForce<"u"?p.maxForce:1e6,v=p.pivotA?p.pivotA.clone():new a,m=p.pivotB?p.pivotB.clone():new a;s.call(this,u,v,d,m,f);var g=this.axisA=p.axisA?p.axisA.clone():new a(1,0,0);g.normalize();var _=this.axisB=p.axisB?p.axisB.clone():new a(1,0,0);_.normalize();var w=this.rotationalEquation1=new n(u,d,p),x=this.rotationalEquation2=new n(u,d,p),E=this.motorEquation=new o(u,d,f);E.enabled=!1,this.equations.push(w,x,E)}h.prototype=new s,h.constructor=h,h.prototype.enableMotor=function(){this.motorEquation.enabled=!0},h.prototype.disableMotor=function(){this.motorEquation.enabled=!1},h.prototype.setMotorSpeed=function(u){this.motorEquation.targetVelocity=u},h.prototype.setMotorMaxForce=function(u){this.motorEquation.maxForce=u,this.motorEquation.minForce=-u};var l=new a,c=new a;h.prototype.update=function(){var u=this.bodyA,d=this.bodyB,p=this.motorEquation,f=this.rotationalEquation1,v=this.rotationalEquation2,m=l,g=c,_=this.axisA,w=this.axisB;s.prototype.update.call(this),u.quaternion.vmult(_,m),d.quaternion.vmult(w,g),m.tangents(f.axisA,v.axisA),f.axisB.copy(g),v.axisB.copy(g),this.motorEquation.enabled&&(u.quaternion.vmult(this.axisA,p.axisA),d.quaternion.vmult(this.axisB,p.axisB))}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],16:[function(t,i,r){i.exports=a,t("./Constraint");var s=t("./PointToPointConstraint"),n=t("../equations/RotationalEquation");t("../equations/RotationalMotorEquation"),t("../equations/ContactEquation");var o=t("../math/Vec3");function a(h,l,c){c=c||{};var u=typeof c.maxForce<"u"?c.maxForce:1e6,d=new o,p=new o,f=new o;h.position.vadd(l.position,f),f.scale(.5,f),l.pointToLocalFrame(f,p),h.pointToLocalFrame(f,d),s.call(this,h,d,l,p,u);var v=this.rotationalEquation1=new n(h,l,c),m=this.rotationalEquation2=new n(h,l,c),g=this.rotationalEquation3=new n(h,l,c);this.equations.push(v,m,g)}a.prototype=new s,a.constructor=a,new o,new o,a.prototype.update=function(){var h=this.bodyA,l=this.bodyB;this.motorEquation;var c=this.rotationalEquation1,u=this.rotationalEquation2,d=this.rotationalEquation3;s.prototype.update.call(this),h.vectorToWorldFrame(o.UNIT_X,c.axisA),l.vectorToWorldFrame(o.UNIT_Y,c.axisB),h.vectorToWorldFrame(o.UNIT_Y,u.axisA),l.vectorToWorldFrame(o.UNIT_Z,u.axisB),h.vectorToWorldFrame(o.UNIT_Z,d.axisA),l.vectorToWorldFrame(o.UNIT_X,d.axisB)}},{"../equations/ContactEquation":19,"../equations/RotationalEquation":22,"../equations/RotationalMotorEquation":23,"../math/Vec3":30,"./Constraint":13,"./PointToPointConstraint":17}],17:[function(t,i,r){i.exports=a;var s=t("./Constraint"),n=t("../equations/ContactEquation"),o=t("../math/Vec3");function a(h,l,c,u,d){s.call(this,h,c),d=typeof d<"u"?d:1e6,this.pivotA=l?l.clone():new o,this.pivotB=u?u.clone():new o;var p=this.equationX=new n(h,c),f=this.equationY=new n(h,c),v=this.equationZ=new n(h,c);this.equations.push(p,f,v),p.minForce=f.minForce=v.minForce=-d,p.maxForce=f.maxForce=v.maxForce=d,p.ni.set(1,0,0),f.ni.set(0,1,0),v.ni.set(0,0,1)}a.prototype=new s,a.prototype.update=function(){var h=this.bodyA,l=this.bodyB,c=this.equationX,u=this.equationY,d=this.equationZ;h.quaternion.vmult(this.pivotA,c.ri),l.quaternion.vmult(this.pivotB,c.rj),u.ri.copy(c.ri),u.rj.copy(c.rj),d.ri.copy(c.ri),d.rj.copy(c.rj)}},{"../equations/ContactEquation":19,"../math/Vec3":30,"./Constraint":13}],18:[function(t,i,r){i.exports=o;var s=t("../math/Vec3");t("../math/Mat3");var n=t("./Equation");function o(l,c,u){u=u||{};var d=typeof u.maxForce<"u"?u.maxForce:1e6;n.call(this,l,c,-d,d),this.axisA=u.axisA?u.axisA.clone():new s(1,0,0),this.axisB=u.axisB?u.axisB.clone():new s(0,1,0),this.angle=typeof u.angle<"u"?u.angle:0}o.prototype=new n,o.prototype.constructor=o;var a=new s,h=new s;o.prototype.computeB=function(l){var c=this.a,u=this.b,d=this.axisA,p=this.axisB,f=a,v=h,m=this.jacobianElementA,g=this.jacobianElementB;d.cross(p,f),p.cross(d,v),m.rotational.copy(v),g.rotational.copy(f);var _=Math.cos(this.angle)-d.dot(p),w=this.computeGW(),x=this.computeGiMf(),E=-_*c-w*u-l*x;return E}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],19:[function(t,i,r){i.exports=o;var s=t("./Equation"),n=t("../math/Vec3");t("../math/Mat3");function o(v,m,g){g=typeof g<"u"?g:1e6,s.call(this,v,m,0,g),this.restitution=0,this.ri=new n,this.rj=new n,this.ni=new n}o.prototype=new s,o.prototype.constructor=o;var a=new n,h=new n,l=new n;o.prototype.computeB=function(v){var m=this.a,g=this.b,_=this.bi,w=this.bj,x=this.ri,E=this.rj,L=a,A=h,T=_.velocity,R=_.angularVelocity;_.force,_.torque;var C=w.velocity,B=w.angularVelocity;w.force,w.torque;var F=l,W=this.jacobianElementA,G=this.jacobianElementB,j=this.ni;x.cross(j,L),E.cross(j,A),j.negate(W.spatial),L.negate(W.rotational),G.spatial.copy(j),G.rotational.copy(A),F.copy(w.position),F.vadd(E,F),F.vsub(_.position,F),F.vsub(x,F);var z=j.dot(F),I=this.restitution+1,q=I*C.dot(j)-I*T.dot(j)+B.dot(A)-R.dot(L),V=this.computeGiMf(),P=-z*m-q*g-v*V;return P};var c=new n,u=new n,d=new n,p=new n,f=new n;o.prototype.getImpactVelocityAlongNormal=function(){var v=c,m=u,g=d,_=p,w=f;return this.bi.position.vadd(this.ri,g),this.bj.position.vadd(this.rj,_),this.bi.getVelocityAtWorldPoint(g,v),this.bj.getVelocityAtWorldPoint(_,m),v.vsub(m,w),this.ni.dot(w)}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],20:[function(t,i,r){i.exports=o;var s=t("../math/JacobianElement"),n=t("../math/Vec3");function o(f,v,m,g){this.id=o.id++,this.minForce=typeof m>"u"?-1e6:m,this.maxForce=typeof g>"u"?1e6:g,this.bi=f,this.bj=v,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new s,this.jacobianElementB=new s,this.enabled=!0,this.setSpookParams(1e7,4,1/60)}o.prototype.constructor=o,o.id=0,o.prototype.setSpookParams=function(f,v,m){var g=v,_=f,w=m;this.a=4/(w*(1+4*g)),this.b=4*g/(1+4*g),this.eps=4/(w*w*_*(1+4*g))},o.prototype.computeB=function(f,v,m){var g=this.computeGW(),_=this.computeGq(),w=this.computeGiMf();return-_*f-g*v-w*m},o.prototype.computeGq=function(){var f=this.jacobianElementA,v=this.jacobianElementB,m=this.bi,g=this.bj,_=m.position,w=g.position;return f.spatial.dot(_)+v.spatial.dot(w)};var a=new n;o.prototype.computeGW=function(){var f=this.jacobianElementA,v=this.jacobianElementB,m=this.bi,g=this.bj,_=m.velocity,w=g.velocity,x=m.angularVelocity||a,E=g.angularVelocity||a;return f.multiplyVectors(_,x)+v.multiplyVectors(w,E)},o.prototype.computeGWlambda=function(){var f=this.jacobianElementA,v=this.jacobianElementB,m=this.bi,g=this.bj,_=m.vlambda,w=g.vlambda,x=m.wlambda||a,E=g.wlambda||a;return f.multiplyVectors(_,x)+v.multiplyVectors(w,E)};var h=new n,l=new n,c=new n,u=new n;o.prototype.computeGiMf=function(){var f=this.jacobianElementA,v=this.jacobianElementB,m=this.bi,g=this.bj,_=m.force,w=m.torque,x=g.force,E=g.torque,L=m.invMassSolve,A=g.invMassSolve;return m.invInertiaWorldSolve?m.invInertiaWorldSolve.vmult(w,c):c.set(0,0,0),g.invInertiaWorldSolve?g.invInertiaWorldSolve.vmult(E,u):u.set(0,0,0),_.mult(L,h),x.mult(A,l),f.multiplyVectors(h,c)+v.multiplyVectors(l,u)};var d=new n;o.prototype.computeGiMGt=function(){var f=this.jacobianElementA,v=this.jacobianElementB,m=this.bi,g=this.bj,_=m.invMassSolve,w=g.invMassSolve,x=m.invInertiaWorldSolve,E=g.invInertiaWorldSolve,L=_+w;return x&&(x.vmult(f.rotational,d),L+=d.dot(f.rotational)),E&&(E.vmult(v.rotational,d),L+=d.dot(v.rotational)),L};var p=new n;new n,new n,new n,new n,new n,o.prototype.addToWlambda=function(f){var v=this.jacobianElementA,m=this.jacobianElementB,g=this.bi,_=this.bj,w=p;v.spatial.mult(g.invMassSolve*f,w),g.vlambda.vadd(w,g.vlambda),m.spatial.mult(_.invMassSolve*f,w),_.vlambda.vadd(w,_.vlambda),g.invInertiaWorldSolve&&(g.invInertiaWorldSolve.vmult(v.rotational,w),w.mult(f,w),g.wlambda.vadd(w,g.wlambda)),_.invInertiaWorldSolve&&(_.invInertiaWorldSolve.vmult(m.rotational,w),w.mult(f,w),_.wlambda.vadd(w,_.wlambda))},o.prototype.computeC=function(){return this.computeGiMGt()+this.eps}},{"../math/JacobianElement":26,"../math/Vec3":30}],21:[function(t,i,r){i.exports=o;var s=t("./Equation"),n=t("../math/Vec3");t("../math/Mat3");function o(l,c,u){s.call(this,l,c,-u,u),this.ri=new n,this.rj=new n,this.t=new n}o.prototype=new s,o.prototype.constructor=o;var a=new n,h=new n;o.prototype.computeB=function(l){this.a;var c=this.b;this.bi,this.bj;var u=this.ri,d=this.rj,p=a,f=h,v=this.t;u.cross(v,p),d.cross(v,f);var m=this.jacobianElementA,g=this.jacobianElementB;v.negate(m.spatial),p.negate(m.rotational),g.spatial.copy(v),g.rotational.copy(f);var _=this.computeGW(),w=this.computeGiMf(),x=-_*c-l*w;return x}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],22:[function(t,i,r){i.exports=o;var s=t("../math/Vec3");t("../math/Mat3");var n=t("./Equation");function o(l,c,u){u=u||{};var d=typeof u.maxForce<"u"?u.maxForce:1e6;n.call(this,l,c,-d,d),this.axisA=u.axisA?u.axisA.clone():new s(1,0,0),this.axisB=u.axisB?u.axisB.clone():new s(0,1,0),this.maxAngle=Math.PI/2}o.prototype=new n,o.prototype.constructor=o;var a=new s,h=new s;o.prototype.computeB=function(l){var c=this.a,u=this.b,d=this.axisA,p=this.axisB,f=a,v=h,m=this.jacobianElementA,g=this.jacobianElementB;d.cross(p,f),p.cross(d,v),m.rotational.copy(v),g.rotational.copy(f);var _=Math.cos(this.maxAngle)-d.dot(p),w=this.computeGW(),x=this.computeGiMf(),E=-_*c-w*u-l*x;return E}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],23:[function(t,i,r){i.exports=o;var s=t("../math/Vec3");t("../math/Mat3");var n=t("./Equation");function o(a,h,l){l=typeof l<"u"?l:1e6,n.call(this,a,h,-l,l),this.axisA=new s,this.axisB=new s,this.targetVelocity=0}o.prototype=new n,o.prototype.constructor=o,o.prototype.computeB=function(a){this.a;var h=this.b;this.bi,this.bj;var l=this.axisA,c=this.axisB,u=this.jacobianElementA,d=this.jacobianElementB;u.rotational.copy(l),c.negate(d.rotational);var p=this.computeGW()-this.targetVelocity,f=this.computeGiMf(),v=-p*h-a*f;return v}},{"../math/Mat3":27,"../math/Vec3":30,"./Equation":20}],24:[function(t,i,r){var s=t("../utils/Utils");i.exports=n;function n(o,a,h){h=s.defaults(h,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=n.idCounter++,this.materials=[o,a],this.friction=h.friction,this.restitution=h.restitution,this.contactEquationStiffness=h.contactEquationStiffness,this.contactEquationRelaxation=h.contactEquationRelaxation,this.frictionEquationStiffness=h.frictionEquationStiffness,this.frictionEquationRelaxation=h.frictionEquationRelaxation}n.idCounter=0},{"../utils/Utils":53}],25:[function(t,i,r){i.exports=s;function s(n){var o="";n=n||{},typeof n=="string"?(o=n,n={}):typeof n=="object"&&(o=""),this.name=o,this.id=s.idCounter++,this.friction=typeof n.friction<"u"?n.friction:-1,this.restitution=typeof n.restitution<"u"?n.restitution:-1}s.idCounter=0},{}],26:[function(t,i,r){i.exports=n;var s=t("./Vec3");function n(){this.spatial=new s,this.rotational=new s}n.prototype.multiplyElement=function(o){return o.spatial.dot(this.spatial)+o.rotational.dot(this.rotational)},n.prototype.multiplyVectors=function(o,a){return o.dot(this.spatial)+a.dot(this.rotational)}},{"./Vec3":30}],27:[function(t,i,r){i.exports=n;var s=t("./Vec3");function n(o){o?this.elements=o:this.elements=[0,0,0,0,0,0,0,0,0]}n.prototype.identity=function(){var o=this.elements;o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=1,o[5]=0,o[6]=0,o[7]=0,o[8]=1},n.prototype.setZero=function(){var o=this.elements;o[0]=0,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=0,o[6]=0,o[7]=0,o[8]=0},n.prototype.setTrace=function(o){var a=this.elements;a[0]=o.x,a[4]=o.y,a[8]=o.z},n.prototype.getTrace=function(a){var a=a||new s,h=this.elements;a.x=h[0],a.y=h[4],a.z=h[8]},n.prototype.vmult=function(o,a){a=a||new s;var h=this.elements,l=o.x,c=o.y,u=o.z;return a.x=h[0]*l+h[1]*c+h[2]*u,a.y=h[3]*l+h[4]*c+h[5]*u,a.z=h[6]*l+h[7]*c+h[8]*u,a},n.prototype.smult=function(o){for(var a=0;a<this.elements.length;a++)this.elements[a]*=o},n.prototype.mmult=function(o,a){for(var h=a||new n,l=0;l<3;l++)for(var c=0;c<3;c++){for(var u=0,d=0;d<3;d++)u+=o.elements[l+d*3]*this.elements[d+c*3];h.elements[l+c*3]=u}return h},n.prototype.scale=function(o,a){a=a||new n;for(var h=this.elements,l=a.elements,c=0;c!==3;c++)l[3*c+0]=o.x*h[3*c+0],l[3*c+1]=o.y*h[3*c+1],l[3*c+2]=o.z*h[3*c+2];return a},n.prototype.solve=function(o,a){a=a||new s;for(var h=3,l=4,c=[],u=0;u<h*l;u++)c.push(0);var u,d;for(u=0;u<3;u++)for(d=0;d<3;d++)c[u+l*d]=this.elements[u+3*d];c[3+4*0]=o.x,c[3+4*1]=o.y,c[3+4*2]=o.z;var p=3,f=p,v,m=4,g;do{if(u=f-p,c[u+l*u]===0){for(d=u+1;d<f;d++)if(c[u+l*d]!==0){v=m;do g=m-v,c[g+l*u]+=c[g+l*d];while(--v);break}}if(c[u+l*u]!==0)for(d=u+1;d<f;d++){var _=c[u+l*d]/c[u+l*u];v=m;do g=m-v,c[g+l*d]=g<=u?0:c[g+l*d]-c[g+l*u]*_;while(--v)}}while(--p);if(a.z=c[2*l+3]/c[2*l+2],a.y=(c[1*l+3]-c[1*l+2]*a.z)/c[1*l+1],a.x=(c[0*l+3]-c[0*l+2]*a.z-c[0*l+1]*a.y)/c[0*l+0],isNaN(a.x)||isNaN(a.y)||isNaN(a.z)||a.x===1/0||a.y===1/0||a.z===1/0)throw"Could not solve equation! Got x=["+a.toString()+"], b=["+o.toString()+"], A=["+this.toString()+"]";return a},n.prototype.e=function(o,a,h){if(h===void 0)return this.elements[a+3*o];this.elements[a+3*o]=h},n.prototype.copy=function(o){for(var a=0;a<o.elements.length;a++)this.elements[a]=o.elements[a];return this},n.prototype.toString=function(){for(var o="",a=",",h=0;h<9;h++)o+=this.elements[h]+a;return o},n.prototype.reverse=function(o){o=o||new n;for(var a=3,h=6,l=[],c=0;c<a*h;c++)l.push(0);var c,u;for(c=0;c<3;c++)for(u=0;u<3;u++)l[c+h*u]=this.elements[c+3*u];l[3+6*0]=1,l[3+6*1]=0,l[3+6*2]=0,l[4+6*0]=0,l[4+6*1]=1,l[4+6*2]=0,l[5+6*0]=0,l[5+6*1]=0,l[5+6*2]=1;var d=3,p=d,f,v=h,m;do{if(c=p-d,l[c+h*c]===0){for(u=c+1;u<p;u++)if(l[c+h*u]!==0){f=v;do m=v-f,l[m+h*c]+=l[m+h*u];while(--f);break}}if(l[c+h*c]!==0)for(u=c+1;u<p;u++){var g=l[c+h*u]/l[c+h*c];f=v;do m=v-f,l[m+h*u]=m<=c?0:l[m+h*u]-l[m+h*c]*g;while(--f)}}while(--d);c=2;do{u=c-1;do{var g=l[c+h*u]/l[c+h*c];f=h;do m=h-f,l[m+h*u]=l[m+h*u]-l[m+h*c]*g;while(--f)}while(u--)}while(--c);c=2;do{var g=1/l[c+h*c];f=h;do m=h-f,l[m+h*c]=l[m+h*c]*g;while(--f)}while(c--);c=2;do{u=2;do{if(m=l[a+u+h*c],isNaN(m)||m===1/0)throw"Could not reverse! A=["+this.toString()+"]";o.e(c,u,m)}while(u--)}while(c--);return o},n.prototype.setRotationFromQuaternion=function(o){var a=o.x,h=o.y,l=o.z,c=o.w,u=a+a,d=h+h,p=l+l,f=a*u,v=a*d,m=a*p,g=h*d,_=h*p,w=l*p,x=c*u,E=c*d,L=c*p,A=this.elements;return A[3*0+0]=1-(g+w),A[3*0+1]=v-L,A[3*0+2]=m+E,A[3*1+0]=v+L,A[3*1+1]=1-(f+w),A[3*1+2]=_-x,A[3*2+0]=m-E,A[3*2+1]=_+x,A[3*2+2]=1-(f+g),this},n.prototype.transpose=function(o){o=o||new n;for(var a=o.elements,h=this.elements,l=0;l!==3;l++)for(var c=0;c!==3;c++)a[3*l+c]=h[3*c+l];return o}},{"./Vec3":30}],28:[function(t,i,r){i.exports=n;var s=t("./Vec3");function n(u,d,p,f){this.x=u!==void 0?u:0,this.y=d!==void 0?d:0,this.z=p!==void 0?p:0,this.w=f!==void 0?f:1}n.prototype.set=function(u,d,p,f){this.x=u,this.y=d,this.z=p,this.w=f},n.prototype.toString=function(){return this.x+","+this.y+","+this.z+","+this.w},n.prototype.toArray=function(){return[this.x,this.y,this.z,this.w]},n.prototype.setFromAxisAngle=function(u,d){var p=Math.sin(d*.5);this.x=u.x*p,this.y=u.y*p,this.z=u.z*p,this.w=Math.cos(d*.5)},n.prototype.toAxisAngle=function(u){u=u||new s,this.normalize();var d=2*Math.acos(this.w),p=Math.sqrt(1-this.w*this.w);return p<.001?(u.x=this.x,u.y=this.y,u.z=this.z):(u.x=this.x/p,u.y=this.y/p,u.z=this.z/p),[u,d]};var o=new s,a=new s;n.prototype.setFromVectors=function(u,d){if(u.isAntiparallelTo(d)){var p=o,f=a;u.tangents(p,f),this.setFromAxisAngle(p,Math.PI)}else{var v=u.cross(d);this.x=v.x,this.y=v.y,this.z=v.z,this.w=Math.sqrt(Math.pow(u.norm(),2)*Math.pow(d.norm(),2))+u.dot(d),this.normalize()}};var h=new s,l=new s,c=new s;n.prototype.mult=function(u,d){d=d||new n;var p=this.w,f=h,v=l,m=c;return f.set(this.x,this.y,this.z),v.set(u.x,u.y,u.z),d.w=p*u.w-f.dot(v),f.cross(v,m),d.x=p*v.x+u.w*f.x+m.x,d.y=p*v.y+u.w*f.y+m.y,d.z=p*v.z+u.w*f.z+m.z,d},n.prototype.inverse=function(u){var d=this.x,p=this.y,f=this.z,v=this.w;u=u||new n,this.conjugate(u);var m=1/(d*d+p*p+f*f+v*v);return u.x*=m,u.y*=m,u.z*=m,u.w*=m,u},n.prototype.conjugate=function(u){return u=u||new n,u.x=-this.x,u.y=-this.y,u.z=-this.z,u.w=this.w,u},n.prototype.normalize=function(){var u=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);u===0?(this.x=0,this.y=0,this.z=0,this.w=0):(u=1/u,this.x*=u,this.y*=u,this.z*=u,this.w*=u)},n.prototype.normalizeFast=function(){var u=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;u===0?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=u,this.y*=u,this.z*=u,this.w*=u)},n.prototype.vmult=function(u,d){d=d||new s;var p=u.x,f=u.y,v=u.z,m=this.x,g=this.y,_=this.z,w=this.w,x=w*p+g*v-_*f,E=w*f+_*p-m*v,L=w*v+m*f-g*p,A=-m*p-g*f-_*v;return d.x=x*w+A*-m+E*-_-L*-g,d.y=E*w+A*-g+L*-m-x*-_,d.z=L*w+A*-_+x*-g-E*-m,d},n.prototype.copy=function(u){return this.x=u.x,this.y=u.y,this.z=u.z,this.w=u.w,this},n.prototype.toEuler=function(u,d){d=d||"YZX";var p,f,v,m=this.x,g=this.y,_=this.z,w=this.w;switch(d){case"YZX":var x=m*g+_*w;if(x>.499&&(p=2*Math.atan2(m,w),f=Math.PI/2,v=0),x<-.499&&(p=-2*Math.atan2(m,w),f=-Math.PI/2,v=0),isNaN(p)){var E=m*m,L=g*g,A=_*_;p=Math.atan2(2*g*w-2*m*_,1-2*L-2*A),f=Math.asin(2*x),v=Math.atan2(2*m*w-2*g*_,1-2*E-2*A)}break;default:throw new Error("Euler order "+d+" not supported yet.")}u.y=p,u.z=f,u.x=v},n.prototype.setFromEuler=function(u,d,p,f){f=f||"XYZ";var v=Math.cos(u/2),m=Math.cos(d/2),g=Math.cos(p/2),_=Math.sin(u/2),w=Math.sin(d/2),x=Math.sin(p/2);return f==="XYZ"?(this.x=_*m*g+v*w*x,this.y=v*w*g-_*m*x,this.z=v*m*x+_*w*g,this.w=v*m*g-_*w*x):f==="YXZ"?(this.x=_*m*g+v*w*x,this.y=v*w*g-_*m*x,this.z=v*m*x-_*w*g,this.w=v*m*g+_*w*x):f==="ZXY"?(this.x=_*m*g-v*w*x,this.y=v*w*g+_*m*x,this.z=v*m*x+_*w*g,this.w=v*m*g-_*w*x):f==="ZYX"?(this.x=_*m*g-v*w*x,this.y=v*w*g+_*m*x,this.z=v*m*x-_*w*g,this.w=v*m*g+_*w*x):f==="YZX"?(this.x=_*m*g+v*w*x,this.y=v*w*g+_*m*x,this.z=v*m*x-_*w*g,this.w=v*m*g-_*w*x):f==="XZY"&&(this.x=_*m*g-v*w*x,this.y=v*w*g-_*m*x,this.z=v*m*x+_*w*g,this.w=v*m*g+_*w*x),this},n.prototype.clone=function(){return new n(this.x,this.y,this.z,this.w)}},{"./Vec3":30}],29:[function(t,i,r){var s=t("./Vec3"),n=t("./Quaternion");i.exports=o;function o(h){h=h||{},this.position=new s,h.position&&this.position.copy(h.position),this.quaternion=new n,h.quaternion&&this.quaternion.copy(h.quaternion)}var a=new n;o.pointToLocalFrame=function(h,l,c,d){var d=d||new s;return c.vsub(h,d),l.conjugate(a),a.vmult(d,d),d},o.prototype.pointToLocal=function(h,l){return o.pointToLocalFrame(this.position,this.quaternion,h,l)},o.pointToWorldFrame=function(h,l,c,d){var d=d||new s;return l.vmult(c,d),d.vadd(h,d),d},o.prototype.pointToWorld=function(h,l){return o.pointToWorldFrame(this.position,this.quaternion,h,l)},o.prototype.vectorToWorldFrame=function(h,c){var c=c||new s;return this.quaternion.vmult(h,c),c},o.vectorToWorldFrame=function(h,l,c){return h.vmult(l,c),c},o.vectorToLocalFrame=function(h,l,c,d){var d=d||new s;return l.w*=-1,l.vmult(c,d),l.w*=-1,d}},{"./Quaternion":28,"./Vec3":30}],30:[function(t,i,r){i.exports=n;var s=t("./Mat3");function n(l,c,u){this.x=l||0,this.y=c||0,this.z=u||0}n.ZERO=new n(0,0,0),n.UNIT_X=new n(1,0,0),n.UNIT_Y=new n(0,1,0),n.UNIT_Z=new n(0,0,1),n.prototype.cross=function(l,c){var u=l.x,d=l.y,p=l.z,f=this.x,v=this.y,m=this.z;return c=c||new n,c.x=v*p-m*d,c.y=m*u-f*p,c.z=f*d-v*u,c},n.prototype.set=function(l,c,u){return this.x=l,this.y=c,this.z=u,this},n.prototype.setZero=function(){this.x=this.y=this.z=0},n.prototype.vadd=function(l,c){if(c)c.x=l.x+this.x,c.y=l.y+this.y,c.z=l.z+this.z;else return new n(this.x+l.x,this.y+l.y,this.z+l.z)},n.prototype.vsub=function(l,c){if(c)c.x=this.x-l.x,c.y=this.y-l.y,c.z=this.z-l.z;else return new n(this.x-l.x,this.y-l.y,this.z-l.z)},n.prototype.crossmat=function(){return new s([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])},n.prototype.normalize=function(){var l=this.x,c=this.y,u=this.z,d=Math.sqrt(l*l+c*c+u*u);if(d>0){var p=1/d;this.x*=p,this.y*=p,this.z*=p}else this.x=0,this.y=0,this.z=0;return d},n.prototype.unit=function(l){l=l||new n;var c=this.x,u=this.y,d=this.z,p=Math.sqrt(c*c+u*u+d*d);return p>0?(p=1/p,l.x=c*p,l.y=u*p,l.z=d*p):(l.x=1,l.y=0,l.z=0),l},n.prototype.norm=function(){var l=this.x,c=this.y,u=this.z;return Math.sqrt(l*l+c*c+u*u)},n.prototype.length=n.prototype.norm,n.prototype.norm2=function(){return this.dot(this)},n.prototype.lengthSquared=n.prototype.norm2,n.prototype.distanceTo=function(l){var c=this.x,u=this.y,d=this.z,p=l.x,f=l.y,v=l.z;return Math.sqrt((p-c)*(p-c)+(f-u)*(f-u)+(v-d)*(v-d))},n.prototype.distanceSquared=function(l){var c=this.x,u=this.y,d=this.z,p=l.x,f=l.y,v=l.z;return(p-c)*(p-c)+(f-u)*(f-u)+(v-d)*(v-d)},n.prototype.mult=function(l,c){c=c||new n;var u=this.x,d=this.y,p=this.z;return c.x=l*u,c.y=l*d,c.z=l*p,c},n.prototype.scale=n.prototype.mult,n.prototype.dot=function(l){return this.x*l.x+this.y*l.y+this.z*l.z},n.prototype.isZero=function(){return this.x===0&&this.y===0&&this.z===0},n.prototype.negate=function(l){return l=l||new n,l.x=-this.x,l.y=-this.y,l.z=-this.z,l};var o=new n,a=new n;n.prototype.tangents=function(l,c){var u=this.norm();if(u>0){var d=o,p=1/u;d.set(this.x*p,this.y*p,this.z*p);var f=a;Math.abs(d.x)<.9?(f.set(1,0,0),d.cross(f,l)):(f.set(0,1,0),d.cross(f,l)),d.cross(l,c)}else l.set(1,0,0),c.set(0,1,0)},n.prototype.toString=function(){return this.x+","+this.y+","+this.z},n.prototype.toArray=function(){return[this.x,this.y,this.z]},n.prototype.copy=function(l){return this.x=l.x,this.y=l.y,this.z=l.z,this},n.prototype.lerp=function(l,c,u){var d=this.x,p=this.y,f=this.z;u.x=d+(l.x-d)*c,u.y=p+(l.y-p)*c,u.z=f+(l.z-f)*c},n.prototype.almostEquals=function(l,c){return c===void 0&&(c=1e-6),!(Math.abs(this.x-l.x)>c||Math.abs(this.y-l.y)>c||Math.abs(this.z-l.z)>c)},n.prototype.almostZero=function(l){return l===void 0&&(l=1e-6),!(Math.abs(this.x)>l||Math.abs(this.y)>l||Math.abs(this.z)>l)};var h=new n;n.prototype.isAntiparallelTo=function(l,c){return this.negate(h),h.almostEquals(l,c)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)}},{"./Mat3":27}],31:[function(t,i,r){i.exports=c;var s=t("../utils/EventTarget");t("../shapes/Shape");var n=t("../math/Vec3"),o=t("../math/Mat3"),a=t("../math/Quaternion");t("../material/Material");var h=t("../collision/AABB"),l=t("../shapes/Box");function c(C){C=C||{},s.apply(this),this.id=c.idCounter++,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new n,this.collisionFilterGroup=typeof C.collisionFilterGroup=="number"?C.collisionFilterGroup:1,this.collisionFilterMask=typeof C.collisionFilterMask=="number"?C.collisionFilterMask:1,this.collisionResponse=!0,this.position=new n,C.position&&this.position.copy(C.position),this.previousPosition=new n,this.initPosition=new n,this.velocity=new n,C.velocity&&this.velocity.copy(C.velocity),this.initVelocity=new n,this.force=new n;var B=typeof C.mass=="number"?C.mass:0;this.mass=B,this.invMass=B>0?1/B:0,this.material=C.material||null,this.linearDamping=typeof C.linearDamping=="number"?C.linearDamping:.01,this.type=B<=0?c.STATIC:c.DYNAMIC,typeof C.type==typeof c.STATIC&&(this.type=C.type),this.allowSleep=typeof C.allowSleep<"u"?C.allowSleep:!0,this.sleepState=0,this.sleepSpeedLimit=typeof C.sleepSpeedLimit<"u"?C.sleepSpeedLimit:.1,this.sleepTimeLimit=typeof C.sleepTimeLimit<"u"?C.sleepTimeLimit:1,this.timeLastSleepy=0,this._wakeUpAfterNarrowphase=!1,this.torque=new n,this.quaternion=new a,C.quaternion&&this.quaternion.copy(C.quaternion),this.initQuaternion=new a,this.angularVelocity=new n,C.angularVelocity&&this.angularVelocity.copy(C.angularVelocity),this.initAngularVelocity=new n,this.interpolatedPosition=new n,this.interpolatedQuaternion=new a,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new n,this.invInertia=new n,this.invInertiaWorld=new o,this.invMassSolve=0,this.invInertiaSolve=new n,this.invInertiaWorldSolve=new o,this.fixedRotation=typeof C.fixedRotation<"u"?C.fixedRotation:!1,this.angularDamping=typeof C.angularDamping<"u"?C.angularDamping:.01,this.aabb=new h,this.aabbNeedsUpdate=!0,this.wlambda=new n,C.shape&&this.addShape(C.shape),this.updateMassProperties()}c.prototype=new s,c.prototype.constructor=c,c.DYNAMIC=1,c.STATIC=2,c.KINEMATIC=4,c.AWAKE=0,c.SLEEPY=1,c.SLEEPING=2,c.idCounter=0,c.prototype.wakeUp=function(){var C=this.sleepState;this.sleepState=0,C===c.SLEEPING&&this.dispatchEvent({type:"wakeup"})},c.prototype.sleep=function(){this.sleepState=c.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0)},c.sleepyEvent={type:"sleepy"},c.sleepEvent={type:"sleep"},c.prototype.sleepTick=function(C){if(this.allowSleep){var B=this.sleepState,F=this.velocity.norm2()+this.angularVelocity.norm2(),W=Math.pow(this.sleepSpeedLimit,2);B===c.AWAKE&&F<W?(this.sleepState=c.SLEEPY,this.timeLastSleepy=C,this.dispatchEvent(c.sleepyEvent)):B===c.SLEEPY&&F>W?this.wakeUp():B===c.SLEEPY&&C-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(c.sleepEvent))}},c.prototype.updateSolveMassProperties=function(){this.sleepState===c.SLEEPING||this.type===c.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))},c.prototype.pointToLocalFrame=function(C,F){var F=F||new n;return C.vsub(this.position,F),this.quaternion.conjugate().vmult(F,F),F},c.prototype.vectorToLocalFrame=function(C,F){var F=F||new n;return this.quaternion.conjugate().vmult(C,F),F},c.prototype.pointToWorldFrame=function(C,F){var F=F||new n;return this.quaternion.vmult(C,F),F.vadd(this.position,F),F},c.prototype.vectorToWorldFrame=function(C,F){var F=F||new n;return this.quaternion.vmult(C,F),F};var u=new n,d=new a;c.prototype.addShape=function(C,B,F){var W=new n,G=new a;return B&&W.copy(B),F&&G.copy(F),this.shapes.push(C),this.shapeOffsets.push(W),this.shapeOrientations.push(G),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,this},c.prototype.updateBoundingRadius=function(){for(var C=this.shapes,B=this.shapeOffsets,F=C.length,W=0,G=0;G!==F;G++){var j=C[G];j.updateBoundingSphereRadius();var z=B[G].norm(),I=j.boundingSphereRadius;z+I>W&&(W=z+I)}this.boundingRadius=W};var p=new h;c.prototype.computeAABB=function(){for(var C=this.shapes,B=this.shapeOffsets,F=this.shapeOrientations,W=C.length,G=u,j=d,z=this.quaternion,I=this.aabb,q=p,V=0;V!==W;V++){var P=C[V];F[V].mult(z,j),j.vmult(B[V],G),G.vadd(this.position,G),P.calculateWorldAABB(G,j,q.lowerBound,q.upperBound),V===0?I.copy(q):I.extend(q)}this.aabbNeedsUpdate=!1};var f=new o,v=new o;new o,c.prototype.updateInertiaWorld=function(C){var B=this.invInertia;if(!(B.x===B.y&&B.y===B.z&&!C)){var F=f,W=v;F.setRotationFromQuaternion(this.quaternion),F.transpose(W),F.scale(B,F),F.mmult(W,this.invInertiaWorld)}};var m=new n,g=new n;c.prototype.applyForce=function(C,B){if(this.type===c.DYNAMIC){var F=m;B.vsub(this.position,F);var W=g;F.cross(C,W),this.force.vadd(C,this.force),this.torque.vadd(W,this.torque)}};var _=new n,w=new n;c.prototype.applyLocalForce=function(C,B){if(this.type===c.DYNAMIC){var F=_,W=w;this.vectorToWorldFrame(C,F),this.pointToWorldFrame(B,W),this.applyForce(F,W)}};var x=new n,E=new n,L=new n;c.prototype.applyImpulse=function(C,B){if(this.type===c.DYNAMIC){var F=x;B.vsub(this.position,F);var W=E;W.copy(C),W.mult(this.invMass,W),this.velocity.vadd(W,this.velocity);var G=L;F.cross(C,G),this.invInertiaWorld.vmult(G,G),this.angularVelocity.vadd(G,this.angularVelocity)}};var A=new n,T=new n;c.prototype.applyLocalImpulse=function(C,B){if(this.type===c.DYNAMIC){var F=A,W=T;this.vectorToWorldFrame(C,F),this.pointToWorldFrame(B,W),this.applyImpulse(F,W)}};var R=new n;c.prototype.updateMassProperties=function(){var C=R;this.invMass=this.mass>0?1/this.mass:0;var B=this.inertia,F=this.fixedRotation;this.computeAABB(),C.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),l.calculateInertia(C,this.mass,B),this.invInertia.set(B.x>0&&!F?1/B.x:0,B.y>0&&!F?1/B.y:0,B.z>0&&!F?1/B.z:0),this.updateInertiaWorld(!0)},c.prototype.getVelocityAtWorldPoint=function(C,B){var F=new n;return C.vsub(this.position,F),this.angularVelocity.cross(F,B),this.velocity.vadd(B,B),B}},{"../collision/AABB":3,"../material/Material":25,"../math/Mat3":27,"../math/Quaternion":28,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Shape":43,"../utils/EventTarget":49}],32:[function(t,i,r){t("./Body");var s=t("../math/Vec3"),n=t("../math/Quaternion");t("../collision/RaycastResult");var o=t("../collision/Ray"),a=t("../objects/WheelInfo");i.exports=h;function h(z){this.chassisBody=z.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=typeof z.indexRightAxis<"u"?z.indexRightAxis:1,this.indexForwardAxis=typeof z.indexForwardAxis<"u"?z.indexForwardAxis:0,this.indexUpAxis=typeof z.indexUpAxis<"u"?z.indexUpAxis:2}new s,new s,new s;var l=new s,c=new s,u=new s;new o,h.prototype.addWheel=function(z){z=z||{};var I=new a(z),q=this.wheelInfos.length;return this.wheelInfos.push(I),q},h.prototype.setSteeringValue=function(z,I){var q=this.wheelInfos[I];q.steering=z},new s,h.prototype.applyEngineForce=function(z,I){this.wheelInfos[I].engineForce=z},h.prototype.setBrake=function(z,I){this.wheelInfos[I].brake=z},h.prototype.addToWorld=function(z){this.constraints,z.add(this.chassisBody);var I=this;this.preStepCallback=function(){I.updateVehicle(z.dt)},z.addEventListener("preStep",this.preStepCallback),this.world=z},h.prototype.getVehicleAxisWorld=function(z,I){I.set(z===0?1:0,z===1?1:0,z===2?1:0),this.chassisBody.vectorToWorldFrame(I,I)},h.prototype.updateVehicle=function(z){for(var I=this.wheelInfos,q=I.length,V=this.chassisBody,P=0;P<q;P++)this.updateWheelTransform(P);this.currentVehicleSpeedKmHour=3.6*V.velocity.norm();var k=new s;this.getVehicleAxisWorld(this.indexForwardAxis,k),k.dot(V.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(var P=0;P<q;P++)this.castRay(I[P]);this.updateSuspension(z);for(var M=new s,S=new s,P=0;P<q;P++){var b=I[P],N=b.suspensionForce;N>b.maxSuspensionForce&&(N=b.maxSuspensionForce),b.raycastResult.hitNormalWorld.scale(N*z,M),b.raycastResult.hitPointWorld.vsub(V.position,S),V.applyImpulse(M,b.raycastResult.hitPointWorld)}this.updateFriction(z);var Y=new s,$=new s,O=new s;for(P=0;P<q;P++){var b=I[P];V.getVelocityAtWorldPoint(b.chassisConnectionPointWorld,O);var U=1;switch(this.indexUpAxis){case 1:U=-1;break}if(b.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,$);var Q=$.dot(b.raycastResult.hitNormalWorld);b.raycastResult.hitNormalWorld.scale(Q,Y),$.vsub(Y,$);var fe=$.dot(O);b.deltaRotation=U*fe*z/b.radius}(b.sliding||!b.isInContact)&&b.engineForce!==0&&b.useCustomSlidingRotationalSpeed&&(b.deltaRotation=(b.engineForce>0?1:-1)*b.customSlidingRotationalSpeed*z),Math.abs(b.brake)>Math.abs(b.engineForce)&&(b.deltaRotation=0),b.rotation+=b.deltaRotation,b.deltaRotation*=.99}},h.prototype.updateSuspension=function(z){for(var I=this.chassisBody,q=I.mass,V=this.wheelInfos,P=V.length,k=0;k<P;k++){var M=V[k];if(M.isInContact){var S,b=M.suspensionRestLength,N=M.suspensionLength,Y=b-N;S=M.suspensionStiffness*Y*M.clippedInvContactDotSuspension;var $=M.suspensionRelativeVelocity,O;$<0?O=M.dampingCompression:O=M.dampingRelaxation,S-=O*$,M.suspensionForce=S*q,M.suspensionForce<0&&(M.suspensionForce=0)}else M.suspensionForce=0}},h.prototype.removeFromWorld=function(z){this.constraints,z.remove(this.chassisBody),z.removeEventListener("preStep",this.preStepCallback),this.world=null};var d=new s,p=new s;h.prototype.castRay=function(z){var I=d,q=p;this.updateWheelTransformWorld(z);var V=this.chassisBody,P=-1,k=z.suspensionRestLength+z.radius;z.directionWorld.scale(k,I);var M=z.chassisConnectionPointWorld;M.vadd(I,q);var S=z.raycastResult;S.reset();var b=V.collisionResponse;V.collisionResponse=!1,this.world.rayTest(M,q,S),V.collisionResponse=b;var N=S.body;if(z.raycastResult.groundObject=0,N){P=S.distance,z.raycastResult.hitNormalWorld=S.hitNormalWorld,z.isInContact=!0;var Y=S.distance;z.suspensionLength=Y-z.radius;var $=z.suspensionRestLength-z.maxSuspensionTravel,O=z.suspensionRestLength+z.maxSuspensionTravel;z.suspensionLength<$&&(z.suspensionLength=$),z.suspensionLength>O&&(z.suspensionLength=O,z.raycastResult.reset());var U=z.raycastResult.hitNormalWorld.dot(z.directionWorld),Q=new s;V.getVelocityAtWorldPoint(z.raycastResult.hitPointWorld,Q);var fe=z.raycastResult.hitNormalWorld.dot(Q);if(U>=-.1)z.suspensionRelativeVelocity=0,z.clippedInvContactDotSuspension=1/.1;else{var ue=-1/U;z.suspensionRelativeVelocity=fe*ue,z.clippedInvContactDotSuspension=ue}}else z.suspensionLength=z.suspensionRestLength+0*z.maxSuspensionTravel,z.suspensionRelativeVelocity=0,z.directionWorld.scale(-1,z.raycastResult.hitNormalWorld),z.clippedInvContactDotSuspension=1;return P},h.prototype.updateWheelTransformWorld=function(z){z.isInContact=!1;var I=this.chassisBody;I.pointToWorldFrame(z.chassisConnectionPointLocal,z.chassisConnectionPointWorld),I.vectorToWorldFrame(z.directionLocal,z.directionWorld),I.vectorToWorldFrame(z.axleLocal,z.axleWorld)},h.prototype.updateWheelTransform=function(z){var I=l,q=c,V=u,P=this.wheelInfos[z];this.updateWheelTransformWorld(P),P.directionLocal.scale(-1,I),q.copy(P.axleLocal),I.cross(q,V),V.normalize(),q.normalize();var k=P.steering,M=new n;M.setFromAxisAngle(I,k);var S=new n;S.setFromAxisAngle(q,P.rotation);var b=P.worldTransform.quaternion;this.chassisBody.quaternion.mult(M,b),b.mult(S,b),b.normalize();var N=P.worldTransform.position;N.copy(P.directionWorld),N.scale(P.suspensionLength,N),N.vadd(P.chassisConnectionPointWorld,N)};var f=[new s(1,0,0),new s(0,1,0),new s(0,0,1)];h.prototype.getWheelTransformWorld=function(z){return this.wheelInfos[z].worldTransform};var v=new s,m=[],g=[],_=1;h.prototype.updateFriction=function(z){for(var I=v,q=this.wheelInfos,V=q.length,P=this.chassisBody,k=g,M=m,S=0;S<V;S++){var b=q[S],N=b.raycastResult.body;b.sideImpulse=0,b.forwardImpulse=0,k[S]||(k[S]=new s),M[S]||(M[S]=new s)}for(var S=0;S<V;S++){var b=q[S],N=b.raycastResult.body;if(N){var Y=M[S],$=this.getWheelTransformWorld(S);$.vectorToWorldFrame(f[this.indexRightAxis],Y);var O=b.raycastResult.hitNormalWorld,U=Y.dot(O);O.scale(U,I),Y.vsub(I,Y),Y.normalize(),O.cross(Y,k[S]),k[S].normalize(),b.sideImpulse=j(P,b.raycastResult.hitPointWorld,N,b.raycastResult.hitPointWorld,Y),b.sideImpulse*=_}}var Q=1,fe=.5;this.sliding=!1;for(var S=0;S<V;S++){var b=q[S],N=b.raycastResult.body,ue=0;if(b.slipInfo=1,N){var he=0,K=b.brake?b.brake:he;ue=L(P,N,b.raycastResult.hitPointWorld,k[S],K),ue+=b.engineForce*z;var te=K/ue;b.slipInfo*=te}if(b.forwardImpulse=0,b.skidInfo=1,N){b.skidInfo=1;var Me=b.suspensionForce*z*b.frictionSlip,ge=Me,Ne=Me*ge;b.forwardImpulse=ue;var pe=b.forwardImpulse*fe,Fe=b.sideImpulse*Q,ze=pe*pe+Fe*Fe;if(b.sliding=!1,ze>Ne){this.sliding=!0,b.sliding=!0;var te=Me/Math.sqrt(ze);b.skidInfo*=te}}}if(this.sliding)for(var S=0;S<V;S++){var b=q[S];b.sideImpulse!==0&&b.skidInfo<1&&(b.forwardImpulse*=b.skidInfo,b.sideImpulse*=b.skidInfo)}for(var S=0;S<V;S++){var b=q[S],Ie=new s;if(Ie.copy(b.raycastResult.hitPointWorld),b.forwardImpulse!==0){var De=new s;k[S].scale(b.forwardImpulse,De),P.applyImpulse(De,Ie)}if(b.sideImpulse!==0){var N=b.raycastResult.body,Pe=new s;Pe.copy(b.raycastResult.hitPointWorld);var Ge=new s;M[S].scale(b.sideImpulse,Ge),P.pointToLocalFrame(Ie,Ie),Ie["xyz"[this.indexUpAxis]]*=b.rollInfluence,P.pointToWorldFrame(Ie,Ie),P.applyImpulse(Ge,Ie),Ge.scale(-1,Ge),N.applyImpulse(Ge,Pe)}}};var w=new s,x=new s,E=new s;function L(z,I,q,V,P){var k=0,M=q,S=w,b=x,N=E;z.getVelocityAtWorldPoint(M,S),I.getVelocityAtWorldPoint(M,b),S.vsub(b,N);var Y=V.dot(N),$=B(z,q,V),O=B(I,q,V),U=1,Q=U/($+O);return k=-Y*Q,P<k&&(k=P),k<-P&&(k=-P),k}var A=new s,T=new s,R=new s,C=new s;function B(z,I,q){var V=A,P=T,k=R,M=C;return I.vsub(z.position,V),V.cross(q,P),z.invInertiaWorld.vmult(P,M),M.cross(V,k),z.invMass+q.dot(k)}var F=new s,W=new s,G=new s;function j(z,I,q,V,P,U){var M=P.norm2();if(M>1.1)return 0;var S=F,b=W,N=G;z.getVelocityAtWorldPoint(I,S),q.getVelocityAtWorldPoint(V,b),S.vsub(b,N);var Y=P.dot(N),$=.2,O=1/(z.invMass+q.invMass),U=-$*Y*O;return U}},{"../collision/Ray":9,"../collision/RaycastResult":10,"../math/Quaternion":28,"../math/Vec3":30,"../objects/WheelInfo":36,"./Body":31}],33:[function(t,i,r){var s=t("./Body"),n=t("../shapes/Sphere"),o=t("../shapes/Box"),a=t("../math/Vec3"),h=t("../constraints/HingeConstraint");i.exports=l;function l(d){if(this.wheelBodies=[],this.coordinateSystem=typeof d.coordinateSystem>"u"?new a(1,2,3):d.coordinateSystem.clone(),this.chassisBody=d.chassisBody,!this.chassisBody){var p=new o(new a(5,2,.5));this.chassisBody=new s(1,p)}this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}l.prototype.addWheel=function(d){d=d||{};var p=d.body;p||(p=new s(1,new n(1.2))),this.wheelBodies.push(p),this.wheelForces.push(0),new a;var f=typeof d.position<"u"?d.position.clone():new a,v=new a;this.chassisBody.pointToWorldFrame(f,v),p.position.set(v.x,v.y,v.z);var m=typeof d.axis<"u"?d.axis.clone():new a(0,1,0);this.wheelAxes.push(m);var g=new h(this.chassisBody,p,{pivotA:f,axisA:m,pivotB:a.ZERO,axisB:m,collideConnected:!1});return this.constraints.push(g),this.wheelBodies.length-1},l.prototype.setSteeringValue=function(d,p){var f=this.wheelAxes[p],v=Math.cos(d),m=Math.sin(d),g=f.x,_=f.y;this.constraints[p].axisA.set(v*g-m*_,m*g+v*_,0)},l.prototype.setMotorSpeed=function(d,p){var f=this.constraints[p];f.enableMotor(),f.motorTargetVelocity=d},l.prototype.disableMotor=function(d){var p=this.constraints[d];p.disableMotor()};var c=new a;l.prototype.setWheelForce=function(d,p){this.wheelForces[p]=d},l.prototype.applyWheelForce=function(d,p){var f=this.wheelAxes[p],v=this.wheelBodies[p],m=v.torque;f.scale(d,c),v.vectorToWorldFrame(c,c),m.vadd(c,m)},l.prototype.addToWorld=function(d){for(var p=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),v=0;v<f.length;v++)d.add(f[v]);for(var v=0;v<p.length;v++)d.addConstraint(p[v]);d.addEventListener("preStep",this._update.bind(this))},l.prototype._update=function(){for(var d=this.wheelForces,p=0;p<d.length;p++)this.applyWheelForce(d[p],p)},l.prototype.removeFromWorld=function(d){for(var p=this.constraints,f=this.wheelBodies.concat([this.chassisBody]),v=0;v<f.length;v++)d.remove(f[v]);for(var v=0;v<p.length;v++)d.removeConstraint(p[v])};var u=new a;l.prototype.getWheelSpeed=function(d){var p=this.wheelAxes[d],f=this.wheelBodies[d],v=f.angularVelocity;return this.chassisBody.vectorToWorldFrame(p,u),v.dot(u)}},{"../constraints/HingeConstraint":15,"../math/Vec3":30,"../shapes/Box":37,"../shapes/Sphere":44,"./Body":31}],34:[function(t,i,r){i.exports=n,t("../shapes/Shape");var s=t("../math/Vec3");t("../math/Quaternion"),t("../shapes/Particle"),t("../objects/Body"),t("../material/Material");function n(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}n.prototype.add=function(p){this.particles.push(p),this.neighbors.length<this.particles.length&&this.neighbors.push([])},n.prototype.remove=function(p){var f=this.particles.indexOf(p);f!==-1&&(this.particles.splice(f,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())};var o=new s;n.prototype.getNeighbors=function(p,f){for(var v=this.particles.length,m=p.id,g=this.smoothingRadius*this.smoothingRadius,_=o,w=0;w!==v;w++){var x=this.particles[w];x.position.vsub(p.position,_),m!==x.id&&_.norm2()<g&&f.push(x)}};var a=new s,h=new s,l=new s,c=new s,u=new s,d=new s;n.prototype.update=function(){for(var p=this.particles.length,f=a,v=this.speedOfSound,m=this.eps,g=0;g!==p;g++){var _=this.particles[g],w=this.neighbors[g];w.length=0,this.getNeighbors(_,w),w.push(this.particles[g]);for(var x=w.length,E=0,L=0;L!==x;L++){_.position.vsub(w[L].position,f);var A=f.norm(),T=this.w(A);E+=w[L].mass*T}this.densities[g]=E,this.pressures[g]=v*v*(this.densities[g]-this.density)}for(var R=h,C=l,B=c,F=u,W=d,g=0;g!==p;g++){var G=this.particles[g];R.set(0,0,0),C.set(0,0,0);for(var j,z,w=this.neighbors[g],x=w.length,L=0;L!==x;L++){var I=w[L];G.position.vsub(I.position,F);var q=F.norm();j=-I.mass*(this.pressures[g]/(this.densities[g]*this.densities[g]+m)+this.pressures[L]/(this.densities[L]*this.densities[L]+m)),this.gradw(F,B),B.mult(j,B),R.vadd(B,R),I.velocity.vsub(G.velocity,W),W.mult(1/(1e-4+this.densities[g]*this.densities[L])*this.viscosity*I.mass,W),z=this.nablaw(q),W.mult(z,W),C.vadd(W,C)}C.mult(G.mass,C),R.mult(G.mass,R),G.force.vadd(C,G.force),G.force.vadd(R,G.force)}},n.prototype.w=function(p){var f=this.smoothingRadius;return 315/(64*Math.PI*Math.pow(f,9))*Math.pow(f*f-p*p,3)},n.prototype.gradw=function(p,f){var v=p.norm(),m=this.smoothingRadius;p.mult(945/(32*Math.PI*Math.pow(m,9))*Math.pow(m*m-v*v,2),f)},n.prototype.nablaw=function(p){var f=this.smoothingRadius,v=945/(32*Math.PI*Math.pow(f,9))*(f*f-p*p)*(7*p*p-3*f*f);return v}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Particle":41,"../shapes/Shape":43}],35:[function(t,i,r){var s=t("../math/Vec3");i.exports=n;function n(g,_,w){w=w||{},this.restLength=typeof w.restLength=="number"?w.restLength:1,this.stiffness=w.stiffness||100,this.damping=w.damping||1,this.bodyA=g,this.bodyB=_,this.localAnchorA=new s,this.localAnchorB=new s,w.localAnchorA&&this.localAnchorA.copy(w.localAnchorA),w.localAnchorB&&this.localAnchorB.copy(w.localAnchorB),w.worldAnchorA&&this.setWorldAnchorA(w.worldAnchorA),w.worldAnchorB&&this.setWorldAnchorB(w.worldAnchorB)}n.prototype.setWorldAnchorA=function(g){this.bodyA.pointToLocalFrame(g,this.localAnchorA)},n.prototype.setWorldAnchorB=function(g){this.bodyB.pointToLocalFrame(g,this.localAnchorB)},n.prototype.getWorldAnchorA=function(g){this.bodyA.pointToWorldFrame(this.localAnchorA,g)},n.prototype.getWorldAnchorB=function(g){this.bodyB.pointToWorldFrame(this.localAnchorB,g)};var o=new s,a=new s,h=new s,l=new s,c=new s,u=new s,d=new s,p=new s,f=new s,v=new s,m=new s;n.prototype.applyForce=function(){var g=this.stiffness,_=this.damping,w=this.restLength,x=this.bodyA,E=this.bodyB,L=o,A=a,T=h,R=l,C=m,B=c,F=u,W=d,G=p,j=f,z=v;this.getWorldAnchorA(B),this.getWorldAnchorB(F),B.vsub(x.position,W),F.vsub(E.position,G),F.vsub(B,L);var I=L.norm();A.copy(L),A.normalize(),E.velocity.vsub(x.velocity,T),E.angularVelocity.cross(G,C),T.vadd(C,T),x.angularVelocity.cross(W,C),T.vsub(C,T),A.mult(-g*(I-w)-_*T.dot(A),R),x.force.vsub(R,x.force),E.force.vadd(R,E.force),W.cross(R,j),G.cross(R,z),x.torque.vsub(j,x.torque),E.torque.vadd(z,E.torque)}},{"../math/Vec3":30}],36:[function(t,i,r){var s=t("../math/Vec3"),n=t("../math/Transform"),o=t("../collision/RaycastResult"),a=t("../utils/Utils");i.exports=h;function h(u){u=a.defaults(u,{chassisConnectionPointLocal:new s,chassisConnectionPointWorld:new s,directionLocal:new s,directionWorld:new s,axleLocal:new s,axleWorld:new s,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=u.maxSuspensionTravel,this.customSlidingRotationalSpeed=u.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=u.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=u.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=u.chassisConnectionPointWorld.clone(),this.directionLocal=u.directionLocal.clone(),this.directionWorld=u.directionWorld.clone(),this.axleLocal=u.axleLocal.clone(),this.axleWorld=u.axleWorld.clone(),this.suspensionRestLength=u.suspensionRestLength,this.suspensionMaxLength=u.suspensionMaxLength,this.radius=u.radius,this.suspensionStiffness=u.suspensionStiffness,this.dampingCompression=u.dampingCompression,this.dampingRelaxation=u.dampingRelaxation,this.frictionSlip=u.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=u.rollInfluence,this.maxSuspensionForce=u.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=u.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new o,this.worldTransform=new n,this.isInContact=!1}var c=new s,l=new s,c=new s;h.prototype.updateWheel=function(u){var d=this.raycastResult;if(this.isInContact){var p=d.hitNormalWorld.dot(d.directionWorld);d.hitPointWorld.vsub(u.position,l),u.getVelocityAtWorldPoint(l,c);var f=d.hitNormalWorld.dot(c);if(p>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=1/.1;else{var v=-1/p;this.suspensionRelativeVelocity=f*v,this.clippedInvContactDotSuspension=v}}else d.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,d.directionWorld.scale(-1,d.hitNormalWorld),this.clippedInvContactDotSuspension=1}},{"../collision/RaycastResult":10,"../math/Transform":29,"../math/Vec3":30,"../utils/Utils":53}],37:[function(t,i,r){i.exports=a;var s=t("./Shape"),n=t("../math/Vec3"),o=t("./ConvexPolyhedron");function a(c){s.call(this),this.type=s.types.BOX,this.halfExtents=c,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}a.prototype=new s,a.prototype.constructor=a,a.prototype.updateConvexPolyhedronRepresentation=function(){var c=this.halfExtents.x,u=this.halfExtents.y,d=this.halfExtents.z,p=n,f=[new p(-c,-u,-d),new p(c,-u,-d),new p(c,u,-d),new p(-c,u,-d),new p(-c,-u,d),new p(c,-u,d),new p(c,u,d),new p(-c,u,d)],v=[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]];new p(0,0,1),new p(0,1,0),new p(1,0,0);var m=new o(f,v);this.convexPolyhedronRepresentation=m,m.material=this.material},a.prototype.calculateLocalInertia=function(c,u){return u=u||new n,a.calculateInertia(this.halfExtents,c,u),u},a.calculateInertia=function(c,u,d){var p=c;d.x=1/12*u*(2*p.y*2*p.y+2*p.z*2*p.z),d.y=1/12*u*(2*p.x*2*p.x+2*p.z*2*p.z),d.z=1/12*u*(2*p.y*2*p.y+2*p.x*2*p.x)},a.prototype.getSideNormals=function(c,u){var d=c,p=this.halfExtents;if(d[0].set(p.x,0,0),d[1].set(0,p.y,0),d[2].set(0,0,p.z),d[3].set(-p.x,0,0),d[4].set(0,-p.y,0),d[5].set(0,0,-p.z),u!==void 0)for(var f=0;f!==d.length;f++)u.vmult(d[f],d[f]);return d},a.prototype.volume=function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z},a.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.halfExtents.norm()};var h=new n;new n,a.prototype.forEachWorldCorner=function(c,u,d){for(var p=this.halfExtents,f=[[p.x,p.y,p.z],[-p.x,p.y,p.z],[-p.x,-p.y,p.z],[-p.x,-p.y,-p.z],[p.x,-p.y,-p.z],[p.x,p.y,-p.z],[-p.x,p.y,-p.z],[p.x,-p.y,p.z]],v=0;v<f.length;v++)h.set(f[v][0],f[v][1],f[v][2]),u.vmult(h,h),c.vadd(h,h),d(h.x,h.y,h.z)};var l=[new n,new n,new n,new n,new n,new n,new n,new n];a.prototype.calculateWorldAABB=function(c,u,d,p){var f=this.halfExtents;l[0].set(f.x,f.y,f.z),l[1].set(-f.x,f.y,f.z),l[2].set(-f.x,-f.y,f.z),l[3].set(-f.x,-f.y,-f.z),l[4].set(f.x,-f.y,-f.z),l[5].set(f.x,f.y,-f.z),l[6].set(-f.x,f.y,-f.z),l[7].set(f.x,-f.y,f.z);var v=l[0];u.vmult(v,v),c.vadd(v,v),p.copy(v),d.copy(v);for(var m=1;m<8;m++){var v=l[m];u.vmult(v,v),c.vadd(v,v);var g=v.x,_=v.y,w=v.z;g>p.x&&(p.x=g),_>p.y&&(p.y=_),w>p.z&&(p.z=w),g<d.x&&(d.x=g),_<d.y&&(d.y=_),w<d.z&&(d.z=w)}}},{"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],38:[function(t,i,r){i.exports=a;var s=t("./Shape"),n=t("../math/Vec3");t("../math/Quaternion");var o=t("../math/Transform");function a(P,k,M){s.call(this),this.type=s.types.CONVEXPOLYHEDRON,this.vertices=P||[],this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.faces=k||[],this.faceNormals=[],this.computeNormals(),this.worldFaceNormalsNeedsUpdate=!0,this.worldFaceNormals=[],this.uniqueEdges=[],this.uniqueAxes=M?M.slice():null,this.computeEdges(),this.updateBoundingSphereRadius()}a.prototype=new s,a.prototype.constructor=a;var h=new n;a.prototype.computeEdges=function(){var P=this.faces,k=this.vertices;k.length;var M=this.uniqueEdges;M.length=0;for(var S=h,b=0;b!==P.length;b++)for(var N=P[b],Y=N.length,$=0;$!==Y;$++){var O=($+1)%Y;k[N[$]].vsub(k[N[O]],S),S.normalize();for(var U=!1,Q=0;Q!==M.length;Q++)if(M[Q].almostEquals(S)||M[Q].almostEquals(S)){U=!0;break}U||M.push(S.clone())}},a.prototype.computeNormals=function(){this.faceNormals.length=this.faces.length;for(var P=0;P<this.faces.length;P++){for(var k=0;k<this.faces[P].length;k++)if(!this.vertices[this.faces[P][k]])throw new Error("Vertex "+this.faces[P][k]+" not found!");var M=this.faceNormals[P]||new n;this.getFaceNormal(P,M),M.negate(M),this.faceNormals[P]=M;var S=this.vertices[this.faces[P][0]];if(M.dot(S)<0){console.error(".faceNormals["+P+"] = Vec3("+M.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var k=0;k<this.faces[P].length;k++)console.warn(".vertices["+this.faces[P][k]+"] = Vec3("+this.vertices[this.faces[P][k]].toString()+")")}}};var l=new n,c=new n;a.computeNormal=function(P,k,M,S){k.vsub(P,c),M.vsub(k,l),l.cross(c,S),S.isZero()||S.normalize()},a.prototype.getFaceNormal=function(P,k){var M=this.faces[P],S=this.vertices[M[0]],b=this.vertices[M[1]],N=this.vertices[M[2]];return a.computeNormal(S,b,N,k)};var u=new n;a.prototype.clipAgainstHull=function(P,k,M,S,b,N,Y,$,O){for(var U=u,Q=-1,fe=-Number.MAX_VALUE,ue=0;ue<M.faces.length;ue++){U.copy(M.faceNormals[ue]),b.vmult(U,U);var he=U.dot(N);he>fe&&(fe=he,Q=ue)}for(var K=[],te=M.faces[Q],Me=te.length,ge=0;ge<Me;ge++){var Ne=M.vertices[te[ge]],pe=new n;pe.copy(Ne),b.vmult(pe,pe),S.vadd(pe,pe),K.push(pe)}Q>=0&&this.clipFaceAgainstHull(N,P,k,K,Y,$,O)};var d=new n,p=new n,f=new n,v=new n,m=new n,g=new n;a.prototype.findSeparatingAxis=function(P,k,M,S,b,N,Y,$){var O=d,U=p,Q=f,fe=v,ue=m,he=g,K=Number.MAX_VALUE,te=this;if(te.uniqueAxes)for(var ge=0;ge!==te.uniqueAxes.length;ge++){M.vmult(te.uniqueAxes[ge],O);var pe=te.testSepAxis(O,P,k,M,S,b);if(pe===!1)return!1;pe<K&&(K=pe,N.copy(O))}else for(var Me=Y?Y.length:te.faces.length,ge=0;ge<Me;ge++){var Ne=Y?Y[ge]:ge;O.copy(te.faceNormals[Ne]),M.vmult(O,O);var pe=te.testSepAxis(O,P,k,M,S,b);if(pe===!1)return!1;pe<K&&(K=pe,N.copy(O))}if(P.uniqueAxes)for(var ge=0;ge!==P.uniqueAxes.length;ge++){b.vmult(P.uniqueAxes[ge],U);var pe=te.testSepAxis(U,P,k,M,S,b);if(pe===!1)return!1;pe<K&&(K=pe,N.copy(U))}else for(var Fe=$?$.length:P.faces.length,ge=0;ge<Fe;ge++){var Ne=$?$[ge]:ge;U.copy(P.faceNormals[Ne]),b.vmult(U,U);var pe=te.testSepAxis(U,P,k,M,S,b);if(pe===!1)return!1;pe<K&&(K=pe,N.copy(U))}for(var ze=0;ze!==te.uniqueEdges.length;ze++){M.vmult(te.uniqueEdges[ze],fe);for(var Ie=0;Ie!==P.uniqueEdges.length;Ie++)if(b.vmult(P.uniqueEdges[Ie],ue),fe.cross(ue,he),!he.almostZero()){he.normalize();var De=te.testSepAxis(he,P,k,M,S,b);if(De===!1)return!1;De<K&&(K=De,N.copy(he))}}return S.vsub(k,Q),Q.dot(N)>0&&N.negate(N),!0};var _=[],w=[];a.prototype.testSepAxis=function(P,k,M,S,b,N){var Y=this;a.project(Y,P,M,S,_),a.project(k,P,b,N,w);var $=_[0],O=_[1],U=w[0],Q=w[1],fe=$-Q,ue=U-O,he=fe<ue?fe:ue;return he};var x=new n,E=new n;a.prototype.calculateLocalInertia=function(P,k){this.computeLocalAABB(x,E);var M=E.x-x.x,S=E.y-x.y,b=E.z-x.z;k.x=1/12*P*(2*S*2*S+2*b*2*b),k.y=1/12*P*(2*M*2*M+2*b*2*b),k.z=1/12*P*(2*S*2*S+2*M*2*M)},a.prototype.getPlaneConstantOfFace=function(P){var k=this.faces[P],M=this.faceNormals[P],S=this.vertices[k[0]],b=-M.dot(S);return b};var L=new n,A=new n,T=new n,R=new n,C=new n,B=new n,F=new n,W=new n;a.prototype.clipFaceAgainstHull=function(P,k,M,S,b,N,Y){for(var $=L,O=A,U=T,Q=R,fe=C,ue=B,he=F,K=W,te=this,Me=[],ge=S,Ne=Me,pe=-1,Fe=Number.MAX_VALUE,ze=0;ze<te.faces.length;ze++){$.copy(te.faceNormals[ze]),M.vmult($,$);var Ie=$.dot(P);Ie<Fe&&(Fe=Ie,pe=ze)}if(!(pe<0)){var De=te.faces[pe];De.connectedFaces=[];for(var Pe=0;Pe<te.faces.length;Pe++)for(var Ge=0;Ge<te.faces[Pe].length;Ge++)De.indexOf(te.faces[Pe][Ge])!==-1&&Pe!==pe&&De.connectedFaces.indexOf(Pe)===-1&&De.connectedFaces.push(Pe);ge.length;for(var Le=De.length,Je=0;Je<Le;Je++){var _t=te.vertices[De[Je]],pi=te.vertices[De[(Je+1)%Le]];_t.vsub(pi,O),U.copy(O),M.vmult(U,U),k.vadd(U,U),Q.copy(this.faceNormals[pe]),M.vmult(Q,Q),k.vadd(Q,Q),U.cross(Q,fe),fe.negate(fe),ue.copy(_t),M.vmult(ue,ue),k.vadd(ue,ue),-ue.dot(fe);var Dt;{var Ei=De.connectedFaces[Je];he.copy(this.faceNormals[Ei]);var fi=this.getPlaneConstantOfFace(Ei);K.copy(he),M.vmult(K,K);var Dt=fi-K.dot(k)}for(this.clipFaceAgainstPlane(ge,Ne,K,Dt);ge.length;)ge.shift();for(;Ne.length;)ge.push(Ne.shift())}he.copy(this.faceNormals[pe]);var fi=this.getPlaneConstantOfFace(pe);K.copy(he),M.vmult(K,K);for(var Dt=fi-K.dot(k),Pe=0;Pe<ge.length;Pe++){var Wt=K.dot(ge[Pe])+Dt;if(Wt<=b&&(console.log("clamped: depth="+Wt+" to minDist="+(b+"")),Wt=b),Wt<=N){var Di=ge[Pe];if(Wt<=0){var Si={point:Di,normal:K,depth:Wt};Y.push(Si)}}}}},a.prototype.clipFaceAgainstPlane=function(P,k,M,S){var b,N,Y=P.length;if(Y<2)return k;var $=P[P.length-1],O=P[0];b=M.dot($)+S;for(var U=0;U<Y;U++){if(O=P[U],N=M.dot(O)+S,b<0)if(N<0){var Q=new n;Q.copy(O),k.push(Q)}else{var Q=new n;$.lerp(O,b/(b-N),Q),k.push(Q)}else if(N<0){var Q=new n;$.lerp(O,b/(b-N),Q),k.push(Q),k.push(O)}$=O,b=N}return k},a.prototype.computeWorldVertices=function(P,k){for(var M=this.vertices.length;this.worldVertices.length<M;)this.worldVertices.push(new n);for(var S=this.vertices,b=this.worldVertices,N=0;N!==M;N++)k.vmult(S[N],b[N]),P.vadd(b[N],b[N]);this.worldVerticesNeedsUpdate=!1},new n,a.prototype.computeLocalAABB=function(P,k){var M=this.vertices.length,S=this.vertices;P.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),k.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var b=0;b<M;b++){var N=S[b];N.x<P.x?P.x=N.x:N.x>k.x&&(k.x=N.x),N.y<P.y?P.y=N.y:N.y>k.y&&(k.y=N.y),N.z<P.z?P.z=N.z:N.z>k.z&&(k.z=N.z)}},a.prototype.computeWorldFaceNormals=function(P){for(var k=this.faceNormals.length;this.worldFaceNormals.length<k;)this.worldFaceNormals.push(new n);for(var M=this.faceNormals,S=this.worldFaceNormals,b=0;b!==k;b++)P.vmult(M[b],S[b]);this.worldFaceNormalsNeedsUpdate=!1},a.prototype.updateBoundingSphereRadius=function(){for(var P=0,k=this.vertices,M=0,S=k.length;M!==S;M++){var b=k[M].norm2();b>P&&(P=b)}this.boundingSphereRadius=Math.sqrt(P)};var G=new n;a.prototype.calculateWorldAABB=function(P,k,M,S){for(var b=this.vertices.length,N=this.vertices,Y,$,O,U,Q,fe,ue=0;ue<b;ue++){G.copy(N[ue]),k.vmult(G,G),P.vadd(G,G);var he=G;he.x<Y||Y===void 0?Y=he.x:(he.x>U||U===void 0)&&(U=he.x),he.y<$||$===void 0?$=he.y:(he.y>Q||Q===void 0)&&(Q=he.y),he.z<O||O===void 0?O=he.z:(he.z>fe||fe===void 0)&&(fe=he.z)}M.set(Y,$,O),S.set(U,Q,fe)},a.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},a.prototype.getAveragePointLocal=function(P){P=P||new n;for(var k=this.vertices.length,M=this.vertices,S=0;S<k;S++)P.vadd(M[S],P);return P.mult(1/k,P),P},a.prototype.transformAllPoints=function(P,k){var M=this.vertices.length,S=this.vertices;if(k){for(var b=0;b<M;b++){var N=S[b];k.vmult(N,N)}for(var b=0;b<this.faceNormals.length;b++){var N=this.faceNormals[b];k.vmult(N,N)}}if(P)for(var b=0;b<M;b++){var N=S[b];N.vadd(P,N)}};var j=new n,z=new n,I=new n;a.prototype.pointIsInside=function(P){var k=this.vertices.length,M=this.vertices,S=this.faces,b=this.faceNormals,N=null,Y=this.faces.length,$=j;this.getAveragePointLocal($);for(var O=0;O<Y;O++){this.faces[O].length;var k=b[O],U=M[S[O][0]],Q=z;P.vsub(U,Q);var fe=k.dot(Q),ue=I;$.vsub(U,ue);var he=k.dot(ue);if(fe<0&&he>0||fe>0&&he<0)return!1}return N?1:-1},new n;var q=new n,V=new n;a.project=function(P,k,M,S,b){var N=P.vertices.length,Y=q,$=0,O=0,U=V,Q=P.vertices;U.setZero(),o.vectorToLocalFrame(M,S,k,Y),o.pointToLocalFrame(M,S,U,U);var fe=U.dot(Y);O=$=Q[0].dot(Y);for(var ue=1;ue<N;ue++){var he=Q[ue].dot(Y);he>$&&($=he),he<O&&(O=he)}if(O-=fe,$-=fe,O>$){var K=O;O=$,$=K}b[0]=$,b[1]=O}},{"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"./Shape":43}],39:[function(t,i,r){i.exports=a;var s=t("./Shape"),n=t("../math/Vec3");t("../math/Quaternion");var o=t("./ConvexPolyhedron");function a(h,l,c,u){var d=u,p=[],f=[],v=[],m=[],g=[],_=Math.cos,w=Math.sin;p.push(new n(l*_(0),l*w(0),-c*.5)),m.push(0),p.push(new n(h*_(0),h*w(0),c*.5)),g.push(1);for(var x=0;x<d;x++){var E=2*Math.PI/d*(x+1),L=2*Math.PI/d*(x+.5);x<d-1?(p.push(new n(l*_(E),l*w(E),-c*.5)),m.push(2*x+2),p.push(new n(h*_(E),h*w(E),c*.5)),g.push(2*x+3),v.push([2*x+2,2*x+3,2*x+1,2*x])):v.push([0,1,2*x+1,2*x]),(d%2===1||x<d/2)&&f.push(new n(_(L),w(L),0))}v.push(g),f.push(new n(0,0,1));for(var A=[],x=0;x<m.length;x++)A.push(m[m.length-x-1]);v.push(A),this.type=s.types.CONVEXPOLYHEDRON,o.call(this,p,v,f)}a.prototype=new o},{"../math/Quaternion":28,"../math/Vec3":30,"./ConvexPolyhedron":38,"./Shape":43}],40:[function(t,i,r){var s=t("./Shape"),n=t("./ConvexPolyhedron"),o=t("../math/Vec3"),a=t("../utils/Utils");i.exports=h;function h(l,c){c=a.defaults(c,{maxValue:null,minValue:null,elementSize:1}),this.data=l,this.maxValue=c.maxValue,this.minValue=c.minValue,this.elementSize=c.elementSize,c.minValue===null&&this.updateMinValue(),c.maxValue===null&&this.updateMaxValue(),this.cacheEnabled=!0,s.call(this),this.pillarConvex=new n,this.pillarOffset=new o,this.type=s.types.HEIGHTFIELD,this.updateBoundingSphereRadius(),this._cachedPillars={}}h.prototype=new s,h.prototype.update=function(){this._cachedPillars={}},h.prototype.updateMinValue=function(){for(var l=this.data,c=l[0][0],u=0;u!==l.length;u++)for(var d=0;d!==l[u].length;d++){var p=l[u][d];p<c&&(c=p)}this.minValue=c},h.prototype.updateMaxValue=function(){for(var l=this.data,c=l[0][0],u=0;u!==l.length;u++)for(var d=0;d!==l[u].length;d++){var p=l[u][d];p>c&&(c=p)}this.maxValue=c},h.prototype.setHeightValueAtIndex=function(l,c,u){var d=this.data;d[l][c]=u,this.clearCachedConvexTrianglePillar(l,c,!1),l>0&&(this.clearCachedConvexTrianglePillar(l-1,c,!0),this.clearCachedConvexTrianglePillar(l-1,c,!1)),c>0&&(this.clearCachedConvexTrianglePillar(l,c-1,!0),this.clearCachedConvexTrianglePillar(l,c-1,!1)),c>0&&l>0&&this.clearCachedConvexTrianglePillar(l-1,c-1,!0)},h.prototype.getRectMinMax=function(l,c,u,d,p){p=p||[];for(var f=this.data,v=this.minValue,m=l;m<=u;m++)for(var g=c;g<=d;g++){var _=f[m][g];_>v&&(v=_)}p[0]=this.minValue,p[1]=v},h.prototype.getIndexOfPosition=function(l,c,u,d){var p=this.elementSize,f=this.data,v=Math.floor(l/p),m=Math.floor(c/p);return u[0]=v,u[1]=m,d&&(v<0&&(v=0),m<0&&(m=0),v>=f.length-1&&(v=f.length-1),m>=f[0].length-1&&(m=f[0].length-1)),!(v<0||m<0||v>=f.length-1||m>=f[0].length-1)},h.prototype.getHeightAt=function(l,c,u){var d=[];this.getIndexOfPosition(l,c,d,u);var p=[];return this.getRectMinMax(d[0],d[1]+1,d[0],d[1]+1,p),(p[0]+p[1])/2},h.prototype.getCacheConvexTrianglePillarKey=function(l,c,u){return l+"_"+c+"_"+(u?1:0)},h.prototype.getCachedConvexTrianglePillar=function(l,c,u){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(l,c,u)]},h.prototype.setCachedConvexTrianglePillar=function(l,c,u,d,p){this._cachedPillars[this.getCacheConvexTrianglePillarKey(l,c,u)]={convex:d,offset:p}},h.prototype.clearCachedConvexTrianglePillar=function(l,c,u){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(l,c,u)]},h.prototype.getConvexTrianglePillar=function(l,c,u){var d=this.pillarConvex,p=this.pillarOffset;if(this.cacheEnabled){var f=this.getCachedConvexTrianglePillar(l,c,u);if(f){this.pillarConvex=f.convex,this.pillarOffset=f.offset;return}d=new n,p=new o,this.pillarConvex=d,this.pillarOffset=p}var f=this.data,v=this.elementSize,m=d.faces;d.vertices.length=6;for(var g=0;g<6;g++)d.vertices[g]||(d.vertices[g]=new o);m.length=5;for(var g=0;g<5;g++)m[g]||(m[g]=[]);var _=d.vertices,w=(Math.min(f[l][c],f[l+1][c],f[l][c+1],f[l+1][c+1])-this.minValue)/2+this.minValue;u?(p.set((l+.75)*v,(c+.75)*v,w),_[0].set(.25*v,.25*v,f[l+1][c+1]-w),_[1].set(-.75*v,.25*v,f[l][c+1]-w),_[2].set(.25*v,-.75*v,f[l+1][c]-w),_[3].set(.25*v,.25*v,-w-1),_[4].set(-.75*v,.25*v,-w-1),_[5].set(.25*v,-.75*v,-w-1),m[0][0]=0,m[0][1]=1,m[0][2]=2,m[1][0]=5,m[1][1]=4,m[1][2]=3,m[2][0]=2,m[2][1]=5,m[2][2]=3,m[2][3]=0,m[3][0]=3,m[3][1]=4,m[3][2]=1,m[3][3]=0,m[4][0]=1,m[4][1]=4,m[4][2]=5,m[4][3]=2):(p.set((l+.25)*v,(c+.25)*v,w),_[0].set(-.25*v,-.25*v,f[l][c]-w),_[1].set(.75*v,-.25*v,f[l+1][c]-w),_[2].set(-.25*v,.75*v,f[l][c+1]-w),_[3].set(-.25*v,-.25*v,-w-1),_[4].set(.75*v,-.25*v,-w-1),_[5].set(-.25*v,.75*v,-w-1),m[0][0]=0,m[0][1]=1,m[0][2]=2,m[1][0]=5,m[1][1]=4,m[1][2]=3,m[2][0]=0,m[2][1]=2,m[2][2]=5,m[2][3]=3,m[3][0]=1,m[3][1]=0,m[3][2]=3,m[3][3]=4,m[4][0]=4,m[4][1]=5,m[4][2]=2,m[4][3]=1),d.computeNormals(),d.computeEdges(),d.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(l,c,u,d,p)},h.prototype.calculateLocalInertia=function(l,c){return c=c||new o,c.set(0,0,0),c},h.prototype.volume=function(){return Number.MAX_VALUE},h.prototype.calculateWorldAABB=function(l,c,u,d){u.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),d.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},h.prototype.updateBoundingSphereRadius=function(){var l=this.data,c=this.elementSize;this.boundingSphereRadius=new o(l.length*c,l[0].length*c,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).norm()}},{"../math/Vec3":30,"../utils/Utils":53,"./ConvexPolyhedron":38,"./Shape":43}],41:[function(t,i,r){i.exports=o;var s=t("./Shape"),n=t("../math/Vec3");function o(){s.call(this),this.type=s.types.PARTICLE}o.prototype=new s,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(a,h){return h=h||new n,h.set(0,0,0),h},o.prototype.volume=function(){return 0},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=0},o.prototype.calculateWorldAABB=function(a,h,l,c){l.copy(a),c.copy(a)}},{"../math/Vec3":30,"./Shape":43}],42:[function(t,i,r){i.exports=o;var s=t("./Shape"),n=t("../math/Vec3");function o(){s.call(this),this.type=s.types.PLANE,this.worldNormal=new n,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}o.prototype=new s,o.prototype.constructor=o,o.prototype.computeWorldNormal=function(h){var l=this.worldNormal;l.set(0,0,1),h.vmult(l,l),this.worldNormalNeedsUpdate=!1},o.prototype.calculateLocalInertia=function(h,l){return l=l||new n,l},o.prototype.volume=function(){return Number.MAX_VALUE};var a=new n;o.prototype.calculateWorldAABB=function(h,l,c,u){a.set(0,0,1),l.vmult(a,a);var d=Number.MAX_VALUE;c.set(-d,-d,-d),u.set(d,d,d),a.x===1&&(u.x=h.x),a.y===1&&(u.y=h.y),a.z===1&&(u.z=h.z),a.x===-1&&(c.x=h.x),a.y===-1&&(c.y=h.y),a.z===-1&&(c.z=h.z)},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=Number.MAX_VALUE}},{"../math/Vec3":30,"./Shape":43}],43:[function(t,i,r){i.exports=s;var s=t("./Shape");t("../math/Vec3"),t("../math/Quaternion"),t("../material/Material");function s(){this.id=s.idCounter++,this.type=0,this.boundingSphereRadius=0,this.collisionResponse=!0,this.material=null}s.prototype.constructor=s,s.prototype.updateBoundingSphereRadius=function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type},s.prototype.volume=function(){throw"volume() not implemented for shape type "+this.type},s.prototype.calculateLocalInertia=function(n,o){throw"calculateLocalInertia() not implemented for shape type "+this.type},s.idCounter=0,s.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256}},{"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"./Shape":43}],44:[function(t,i,r){i.exports=o;var s=t("./Shape"),n=t("../math/Vec3");function o(a){if(s.call(this),this.radius=a!==void 0?Number(a):1,this.type=s.types.SPHERE,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}o.prototype=new s,o.prototype.constructor=o,o.prototype.calculateLocalInertia=function(a,h){h=h||new n;var l=2*a*this.radius*this.radius/5;return h.x=l,h.y=l,h.z=l,h},o.prototype.volume=function(){return 4*Math.PI*this.radius/3},o.prototype.updateBoundingSphereRadius=function(){this.boundingSphereRadius=this.radius},o.prototype.calculateWorldAABB=function(a,h,l,c){for(var u=this.radius,d=["x","y","z"],p=0;p<d.length;p++){var f=d[p];l[f]=a[f]-u,c[f]=a[f]+u}}},{"../math/Vec3":30,"./Shape":43}],45:[function(t,i,r){i.exports=l;var s=t("./Shape"),n=t("../math/Vec3");t("../math/Quaternion");var o=t("../math/Transform"),a=t("../collision/AABB"),h=t("../utils/Octree");function l(A,T){s.call(this),this.type=s.types.TRIMESH,this.vertices=new Float32Array(A),this.indices=new Int16Array(T),this.normals=new Float32Array(T.length),this.aabb=new a,this.edges=null,this.scale=new n(1,1,1),this.tree=new h,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}l.prototype=new s,l.prototype.constructor=l;var c=new n;l.prototype.updateTree=function(){var A=this.tree;A.reset(),A.aabb.copy(this.aabb);var T=this.scale;A.aabb.lowerBound.x*=1/T.x,A.aabb.lowerBound.y*=1/T.y,A.aabb.lowerBound.z*=1/T.z,A.aabb.upperBound.x*=1/T.x,A.aabb.upperBound.y*=1/T.y,A.aabb.upperBound.z*=1/T.z;for(var R=new a,C=new n,B=new n,F=new n,W=[C,B,F],G=0;G<this.indices.length/3;G++){var j=G*3;this._getUnscaledVertex(this.indices[j],C),this._getUnscaledVertex(this.indices[j+1],B),this._getUnscaledVertex(this.indices[j+2],F),R.setFromPoints(W),A.insert(R,G)}A.removeEmptyNodes()};var u=new a;l.prototype.getTrianglesInAABB=function(A,T){u.copy(A);var R=this.scale,C=R.x,B=R.y,F=R.z,W=u.lowerBound,G=u.upperBound;return W.x/=C,W.y/=B,W.z/=F,G.x/=C,G.y/=B,G.z/=F,this.tree.aabbQuery(u,T)},l.prototype.setScale=function(A){var T=this.scale.x===this.scale.y===this.scale.z,R=A.x===A.y===A.z;T&&R||this.updateNormals(),this.scale.copy(A),this.updateAABB(),this.updateBoundingSphereRadius()},l.prototype.updateNormals=function(){for(var A=c,T=this.normals,R=0;R<this.indices.length/3;R++){var C=R*3,B=this.indices[C],F=this.indices[C+1],W=this.indices[C+2];this.getVertex(B,m),this.getVertex(F,g),this.getVertex(W,_),l.computeNormal(g,m,_,A),T[C]=A.x,T[C+1]=A.y,T[C+2]=A.z}},l.prototype.updateEdges=function(){for(var A={},T=function(j,z){var I=B<F?B+"_"+F:F+"_"+B;A[I]=!0},R=0;R<this.indices.length/3;R++){var C=R*3,B=this.indices[C],F=this.indices[C+1];this.indices[C+2],T(),T(),T()}var W=Object.keys(A);this.edges=new Int16Array(W.length*2);for(var R=0;R<W.length;R++){var G=W[R].split("_");this.edges[2*R]=parseInt(G[0],10),this.edges[2*R+1]=parseInt(G[1],10)}},l.prototype.getEdgeVertex=function(A,T,R){var C=this.edges[A*2+(T?1:0)];this.getVertex(C,R)};var d=new n,p=new n;l.prototype.getEdgeVector=function(A,T){var R=d,C=p;this.getEdgeVertex(A,0,R),this.getEdgeVertex(A,1,C),C.vsub(R,T)};var f=new n,v=new n;l.computeNormal=function(A,T,R,C){T.vsub(A,v),R.vsub(T,f),f.cross(v,C),C.isZero()||C.normalize()};var m=new n,g=new n,_=new n;l.prototype.getVertex=function(A,T){var R=this.scale;return this._getUnscaledVertex(A,T),T.x*=R.x,T.y*=R.y,T.z*=R.z,T},l.prototype._getUnscaledVertex=function(A,T){var R=A*3,C=this.vertices;return T.set(C[R],C[R+1],C[R+2])},l.prototype.getWorldVertex=function(A,T,R,C){return this.getVertex(A,C),o.pointToWorldFrame(T,R,C,C),C},l.prototype.getTriangleVertices=function(A,T,R,C){var B=A*3;this.getVertex(this.indices[B],T),this.getVertex(this.indices[B+1],R),this.getVertex(this.indices[B+2],C)},l.prototype.getNormal=function(A,T){var R=A*3;return T.set(this.normals[R],this.normals[R+1],this.normals[R+2])};var w=new a;l.prototype.calculateLocalInertia=function(A,T){this.computeLocalAABB(w);var R=w.upperBound.x-w.lowerBound.x,C=w.upperBound.y-w.lowerBound.y,B=w.upperBound.z-w.lowerBound.z;return T.set(1/12*A*(2*C*2*C+2*B*2*B),1/12*A*(2*R*2*R+2*B*2*B),1/12*A*(2*C*2*C+2*R*2*R))};var x=new n;l.prototype.computeLocalAABB=function(A){var T=A.lowerBound,R=A.upperBound,C=this.vertices.length;this.vertices;var B=x;this.getVertex(0,B),T.copy(B),R.copy(B);for(var F=0;F!==C;F++)this.getVertex(F,B),B.x<T.x?T.x=B.x:B.x>R.x&&(R.x=B.x),B.y<T.y?T.y=B.y:B.y>R.y&&(R.y=B.y),B.z<T.z?T.z=B.z:B.z>R.z&&(R.z=B.z)},l.prototype.updateAABB=function(){this.computeLocalAABB(this.aabb)},l.prototype.updateBoundingSphereRadius=function(){for(var A=0,T=this.vertices,R=new n,C=0,B=T.length/3;C!==B;C++){this.getVertex(C,R);var F=R.norm2();F>A&&(A=F)}this.boundingSphereRadius=Math.sqrt(A)},new n;var E=new o,L=new a;l.prototype.calculateWorldAABB=function(A,T,R,C){var B=E,F=L;B.position=A,B.quaternion=T,this.aabb.toWorldFrame(B,F),R.copy(F.lowerBound),C.copy(F.upperBound)},l.prototype.volume=function(){return 4*Math.PI*this.boundingSphereRadius/3},l.createTorus=function(A,T,R,C,B){A=A||1,T=T||.5,R=R||8,C=C||6,B=B||Math.PI*2;for(var F=[],W=[],G=0;G<=R;G++)for(var j=0;j<=C;j++){var z=j/C*B,I=G/R*Math.PI*2,q=(A+T*Math.cos(I))*Math.cos(z),V=(A+T*Math.cos(I))*Math.sin(z),P=T*Math.sin(I);F.push(q,V,P)}for(var G=1;G<=R;G++)for(var j=1;j<=C;j++){var k=(C+1)*G+j-1,M=(C+1)*(G-1)+j-1,S=(C+1)*(G-1)+j,b=(C+1)*G+j;W.push(k,M,b),W.push(M,S,b)}return new l(F,W)}},{"../collision/AABB":3,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../utils/Octree":50,"./Shape":43}],46:[function(t,i,r){i.exports=n,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver");function n(){s.call(this),this.iterations=10,this.tolerance=1e-7}n.prototype=new s;var o=[],a=[],h=[];n.prototype.solve=function(l,c){var u=0,d=this.iterations,p=this.tolerance*this.tolerance,f=this.equations,v=f.length,m=c.bodies,g=m.length,_=l,w,x,E,L,A,T;if(v!==0)for(var R=0;R!==g;R++)m[R].updateSolveMassProperties();var C=a,B=h,F=o;C.length=v,B.length=v,F.length=v;for(var R=0;R!==v;R++){var W=f[R];F[R]=0,B[R]=W.computeB(_),C[R]=1/W.computeC()}if(v!==0){for(var R=0;R!==g;R++){var G=m[R],j=G.vlambda,z=G.wlambda;j.set(0,0,0),z&&z.set(0,0,0)}for(u=0;u!==d;u++){L=0;for(var I=0;I!==v;I++){var W=f[I];w=B[I],x=C[I],T=F[I],A=W.computeGWlambda(),E=x*(w-A-W.eps*T),T+E<W.minForce?E=W.minForce-T:T+E>W.maxForce&&(E=W.maxForce-T),F[I]+=E,L+=E>0?E:-E,W.addToWlambda(E)}if(L*L<p)break}for(var R=0;R!==g;R++){var G=m[R],q=G.velocity,V=G.angularVelocity;q.vadd(G.vlambda,q),V&&V.vadd(G.wlambda,V)}}return u}},{"../math/Quaternion":28,"../math/Vec3":30,"./Solver":47}],47:[function(t,i,r){i.exports=s;function s(){this.equations=[]}s.prototype.solve=function(n,o){return 0},s.prototype.addEquation=function(n){n.enabled&&this.equations.push(n)},s.prototype.removeEquation=function(n){var o=this.equations,a=o.indexOf(n);a!==-1&&o.splice(a,1)},s.prototype.removeAllEquations=function(){this.equations.length=0}},{}],48:[function(t,i,r){i.exports=o,t("../math/Vec3"),t("../math/Quaternion");var s=t("./Solver"),n=t("../objects/Body");function o(m){for(s.call(this),this.iterations=10,this.tolerance=1e-7,this.subsolver=m,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}o.prototype=new s;var a=[],h=[],l={bodies:[]},c=n.STATIC;function u(m){for(var g=m.length,_=0;_!==g;_++){var w=m[_];if(!w.visited&&!(w.body.type&c))return w}return!1}var d=[];function p(m,g,_,w){for(d.push(m),m.visited=!0,g(m,_,w);d.length;)for(var x=d.pop(),E;E=u(x.children);)E.visited=!0,g(E,_,w),d.push(E)}function f(m,g,_){g.push(m.body);for(var w=m.eqs.length,x=0;x!==w;x++){var E=m.eqs[x];_.indexOf(E)===-1&&_.push(E)}}o.prototype.createNode=function(){return{body:null,children:[],eqs:[],visited:!1}},o.prototype.solve=function(m,g){for(var _=a,w=this.nodePool,x=g.bodies,E=this.equations,L=E.length,A=x.length,T=this.subsolver;w.length<A;)w.push(this.createNode());_.length=A;for(var R=0;R<A;R++)_[R]=w[R];for(var R=0;R!==A;R++){var C=_[R];C.body=x[R],C.children.length=0,C.eqs.length=0,C.visited=!1}for(var B=0;B!==L;B++){var F=E[B],R=x.indexOf(F.bi),W=x.indexOf(F.bj),G=_[R],j=_[W];G.children.push(j),G.eqs.push(F),j.children.push(G),j.eqs.push(F)}var z,I=0,q=h;T.tolerance=this.tolerance,T.iterations=this.iterations;for(var V=l;z=u(_);){q.length=0,V.bodies.length=0,p(z,f,V.bodies,q);var P=q.length;q=q.sort(v);for(var R=0;R!==P;R++)T.addEquation(q[R]);T.solve(m,V),T.removeAllEquations(),I++}return I};function v(m,g){return g.id-m.id}},{"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"./Solver":47}],49:[function(t,i,r){var s=function(){};i.exports=s,s.prototype={constructor:s,addEventListener:function(n,o){this._listeners===void 0&&(this._listeners={});var a=this._listeners;return a[n]===void 0&&(a[n]=[]),a[n].indexOf(o)===-1&&a[n].push(o),this},hasEventListener:function(n,o){if(this._listeners===void 0)return!1;var a=this._listeners;return a[n]!==void 0&&a[n].indexOf(o)!==-1},removeEventListener:function(n,o){if(this._listeners===void 0)return this;var a=this._listeners;if(a[n]===void 0)return this;var h=a[n].indexOf(o);return h!==-1&&a[n].splice(h,1),this},dispatchEvent:function(n){if(this._listeners===void 0)return this;var o=this._listeners,a=o[n.type];if(a!==void 0){n.target=this;for(var h=0,l=a.length;h<l;h++)a[h].call(this,n)}return this}}},{}],50:[function(t,i,r){var s=t("../collision/AABB"),n=t("../math/Vec3");i.exports=a;function o(c){c=c||{},this.root=c.root||null,this.aabb=c.aabb?c.aabb.clone():new s,this.data=[],this.children=[]}function a(c,u){u=u||{},u.root=null,u.aabb=c,o.call(this,u),this.maxDepth=typeof u.maxDepth<"u"?u.maxDepth:8}a.prototype=new o,o.prototype.reset=function(c,u){this.children.length=this.data.length=0},o.prototype.insert=function(c,u,d){var p=this.data;if(d=d||0,!this.aabb.contains(c))return!1;var f=this.children;if(d<(this.maxDepth||this.root.maxDepth)){var v=!1;f.length||(this.subdivide(),v=!0);for(var m=0;m!==8;m++)if(f[m].insert(c,u,d+1))return!0;v&&(f.length=0)}return p.push(u),!0};var h=new n;o.prototype.subdivide=function(){var c=this.aabb,u=c.lowerBound,d=c.upperBound,p=this.children;p.push(new o({aabb:new s({lowerBound:new n(0,0,0)})}),new o({aabb:new s({lowerBound:new n(1,0,0)})}),new o({aabb:new s({lowerBound:new n(1,1,0)})}),new o({aabb:new s({lowerBound:new n(1,1,1)})}),new o({aabb:new s({lowerBound:new n(0,1,1)})}),new o({aabb:new s({lowerBound:new n(0,0,1)})}),new o({aabb:new s({lowerBound:new n(1,0,1)})}),new o({aabb:new s({lowerBound:new n(0,1,0)})})),d.vsub(u,h),h.scale(.5,h);for(var f=this.root||this,v=0;v!==8;v++){var m=p[v];m.root=f;var g=m.aabb.lowerBound;g.x*=h.x,g.y*=h.y,g.z*=h.z,g.vadd(u,g),g.vadd(h,m.aabb.upperBound)}},o.prototype.aabbQuery=function(c,u){this.data,this.children;for(var d=[this];d.length;){var p=d.pop();p.aabb.overlaps(c)&&Array.prototype.push.apply(u,p.data),Array.prototype.push.apply(d,p.children)}return u};var l=new s;o.prototype.rayQuery=function(c,u,d){return c.getAABB(l),l.toLocalFrame(u,l),this.aabbQuery(l,d),d},o.prototype.removeEmptyNodes=function(){for(var c=[this];c.length;){for(var u=c.pop(),d=u.children.length-1;d>=0;d--)u.children[d].data.length||u.children.splice(d,1);Array.prototype.push.apply(c,u.children)}}},{"../collision/AABB":3,"../math/Vec3":30}],51:[function(t,i,r){i.exports=s;function s(){this.objects=[],this.type=Object}s.prototype.release=function(){for(var n=arguments.length,o=0;o!==n;o++)this.objects.push(arguments[o])},s.prototype.get=function(){return this.objects.length===0?this.constructObject():this.objects.pop()},s.prototype.constructObject=function(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}},{}],52:[function(t,i,r){i.exports=s;function s(){this.data={keys:[]}}s.prototype.get=function(n,o){if(n>o){var a=o;o=n,n=a}return this.data[n+"-"+o]},s.prototype.set=function(n,o,a){if(n>o){var h=o;o=n,n=h}var l=n+"-"+o;this.get(n,o)||this.data.keys.push(l),this.data[l]=a},s.prototype.reset=function(){for(var n=this.data,o=n.keys;o.length>0;){var a=o.pop();delete n[a]}}},{}],53:[function(t,i,r){function s(){}i.exports=s,s.defaults=function(n,o){n=n||{};for(var a in o)a in n||(n[a]=o[a]);return n}},{}],54:[function(t,i,r){i.exports=o;var s=t("../math/Vec3"),n=t("./Pool");function o(){n.call(this),this.type=s}o.prototype=new n,o.prototype.constructObject=function(){return new s}},{"../math/Vec3":30,"./Pool":51}],55:[function(t,i,r){i.exports=p;var s=t("../collision/AABB"),n=t("../shapes/Shape"),o=t("../collision/Ray"),a=t("../math/Vec3"),h=t("../math/Transform");t("../shapes/ConvexPolyhedron");var l=t("../math/Quaternion");t("../solver/Solver");var c=t("../utils/Vec3Pool"),u=t("../equations/ContactEquation"),d=t("../equations/FrictionEquation");function p(H){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new c,this.world=H,this.currentContactMaterial=null,this.enableFrictionReduction=!1}p.prototype.createContactEquation=function(H,X,Z,J,ye,ce){var ne;this.contactPointPool.length?(ne=this.contactPointPool.pop(),ne.bi=H,ne.bj=X):ne=new u(H,X),ne.enabled=H.collisionResponse&&X.collisionResponse&&Z.collisionResponse&&J.collisionResponse;var ae=this.currentContactMaterial;ne.restitution=ae.restitution,ne.setSpookParams(ae.contactEquationStiffness,ae.contactEquationRelaxation,this.world.dt);var D=Z.material||H.material,re=J.material||X.material;return D&&re&&D.restitution>=0&&re.restitution>=0&&(ne.restitution=D.restitution*re.restitution),ne.si=ye||Z,ne.sj=ce||J,ne},p.prototype.createFrictionEquationsFromContact=function(H,X){var Z=H.bi,J=H.bj,ye=H.si,ce=H.sj,ne=this.world,ae=this.currentContactMaterial,D=ae.friction,re=ye.material||Z.material,le=ce.material||J.material;if(re&&le&&re.friction>=0&&le.friction>=0&&(D=re.friction*le.friction),D>0){var de=D*ne.gravity.length(),se=Z.invMass+J.invMass;se>0&&(se=1/se);var ie=this.frictionEquationPool,oe=ie.length?ie.pop():new d(Z,J,de*se),ve=ie.length?ie.pop():new d(Z,J,de*se);return oe.bi=ve.bi=Z,oe.bj=ve.bj=J,oe.minForce=ve.minForce=-de*se,oe.maxForce=ve.maxForce=de*se,oe.ri.copy(H.ri),oe.rj.copy(H.rj),ve.ri.copy(H.ri),ve.rj.copy(H.rj),H.ni.tangents(oe.t,ve.t),oe.setSpookParams(ae.frictionEquationStiffness,ae.frictionEquationRelaxation,ne.dt),ve.setSpookParams(ae.frictionEquationStiffness,ae.frictionEquationRelaxation,ne.dt),oe.enabled=ve.enabled=H.enabled,X.push(oe,ve),!0}return!1};var f=new a,v=new a,m=new a;p.prototype.createFrictionFromAverage=function(H){var X=this.result[this.result.length-1];if(!(!this.createFrictionEquationsFromContact(X,this.frictionResult)||H===1)){var Z=this.frictionResult[this.frictionResult.length-2],J=this.frictionResult[this.frictionResult.length-1];f.setZero(),v.setZero(),m.setZero();var ye=X.bi;X.bj;for(var ce=0;ce!==H;ce++)X=this.result[this.result.length-1-ce],X.bodyA!==ye?(f.vadd(X.ni,f),v.vadd(X.ri,v),m.vadd(X.rj,m)):(f.vsub(X.ni,f),v.vadd(X.rj,v),m.vadd(X.ri,m));var ne=1/H;v.scale(ne,Z.ri),m.scale(ne,Z.rj),J.ri.copy(Z.ri),J.rj.copy(Z.rj),f.normalize(),f.tangents(Z.t,J.t)}};var g=new a,_=new a,w=new l,x=new l;p.prototype.getContacts=function(H,X,Z,J,ye,ce,ne){this.contactPointPool=ye,this.frictionEquationPool=ne,this.result=J,this.frictionResult=ce;for(var ae=w,D=x,re=g,le=_,de=0,se=H.length;de!==se;de++){var ie=H[de],oe=X[de],ve=null;ie.material&&oe.material&&(ve=Z.getContactMaterial(ie.material,oe.material)||null);for(var _e=0;_e<ie.shapes.length;_e++){ie.quaternion.mult(ie.shapeOrientations[_e],ae),ie.quaternion.vmult(ie.shapeOffsets[_e],re),re.vadd(ie.position,re);for(var ee=ie.shapes[_e],xe=0;xe<oe.shapes.length;xe++){oe.quaternion.mult(oe.shapeOrientations[xe],D),oe.quaternion.vmult(oe.shapeOffsets[xe],le),le.vadd(oe.position,le);var Te=oe.shapes[xe];if(!(re.distanceTo(le)>ee.boundingSphereRadius+Te.boundingSphereRadius)){var Ye=null;ee.material&&Te.material&&(Ye=Z.getContactMaterial(ee.material,Te.material)||null),this.currentContactMaterial=Ye||ve||Z.defaultContactMaterial;var Ee=this[ee.type|Te.type];Ee&&(ee.type<Te.type?Ee.call(this,ee,Te,re,le,ae,D,ie,oe,ee,Te):Ee.call(this,Te,ee,le,re,D,ae,oe,ie,ee,Te))}}}}},p.prototype[n.types.BOX|n.types.BOX]=p.prototype.boxBox=function(H,X,Z,J,ye,ce,ne,ae){H.convexPolyhedronRepresentation.material=H.material,X.convexPolyhedronRepresentation.material=X.material,H.convexPolyhedronRepresentation.collisionResponse=H.collisionResponse,X.convexPolyhedronRepresentation.collisionResponse=X.collisionResponse,this.convexConvex(H.convexPolyhedronRepresentation,X.convexPolyhedronRepresentation,Z,J,ye,ce,ne,ae,H,X)},p.prototype[n.types.BOX|n.types.CONVEXPOLYHEDRON]=p.prototype.boxConvex=function(H,X,Z,J,ye,ce,ne,ae){H.convexPolyhedronRepresentation.material=H.material,H.convexPolyhedronRepresentation.collisionResponse=H.collisionResponse,this.convexConvex(H.convexPolyhedronRepresentation,X,Z,J,ye,ce,ne,ae,H,X)},p.prototype[n.types.BOX|n.types.PARTICLE]=p.prototype.boxParticle=function(H,X,Z,J,ye,ce,ne,ae){H.convexPolyhedronRepresentation.material=H.material,H.convexPolyhedronRepresentation.collisionResponse=H.collisionResponse,this.convexParticle(H.convexPolyhedronRepresentation,X,Z,J,ye,ce,ne,ae,H,X)},p.prototype[n.types.SPHERE]=p.prototype.sphereSphere=function(H,X,Z,J,ye,ce,ne,ae){var D=this.createContactEquation(ne,ae,H,X);J.vsub(Z,D.ni),D.ni.normalize(),D.ri.copy(D.ni),D.rj.copy(D.ni),D.ri.mult(H.radius,D.ri),D.rj.mult(-X.radius,D.rj),D.ri.vadd(Z,D.ri),D.ri.vsub(ne.position,D.ri),D.rj.vadd(J,D.rj),D.rj.vsub(ae.position,D.rj),this.result.push(D),this.createFrictionEquationsFromContact(D,this.frictionResult)};var E=new a,L=new a,A=new a;p.prototype[n.types.PLANE|n.types.TRIMESH]=p.prototype.planeTrimesh=function(H,X,Z,J,ye,ce,ne,ae){var D=new a,re=E;re.set(0,0,1),ye.vmult(re,re);for(var le=0;le<X.vertices.length/3;le++){X.getVertex(le,D);var de=new a;de.copy(D),h.pointToWorldFrame(J,ce,de,D);var se=L;D.vsub(Z,se);var ie=re.dot(se);if(ie<=0){var oe=this.createContactEquation(ne,ae,H,X);oe.ni.copy(re);var ve=A;re.scale(se.dot(re),ve),D.vsub(ve,ve),oe.ri.copy(ve),oe.ri.vsub(ne.position,oe.ri),oe.rj.copy(D),oe.rj.vsub(ae.position,oe.rj),this.result.push(oe),this.createFrictionEquationsFromContact(oe,this.frictionResult)}}};var T=new a,R=new a;new a;var C=new a,B=new a,F=new a,W=new a,G=new a,j=new a,z=new a,I=new a,q=new a,V=new a,P=new a,k=new s,M=[];p.prototype[n.types.SPHERE|n.types.TRIMESH]=p.prototype.sphereTrimesh=function(H,X,Z,J,ye,ce,ne,ae){var D=F,re=W,le=G,de=j,se=z,ie=I,oe=k,ve=B,_e=R,ee=M;h.pointToLocalFrame(J,ce,Z,se);var xe=H.radius;oe.lowerBound.set(se.x-xe,se.y-xe,se.z-xe),oe.upperBound.set(se.x+xe,se.y+xe,se.z+xe),X.getTrianglesInAABB(oe,ee);for(var Te=C,Ye=H.radius*H.radius,Ee=0;Ee<ee.length;Ee++)for(var Be=0;Be<3;Be++)if(X.getVertex(X.indices[ee[Ee]*3+Be],Te),Te.vsub(se,_e),_e.norm2()<=Ye){ve.copy(Te),h.pointToWorldFrame(J,ce,ve,Te),Te.vsub(Z,_e);var me=this.createContactEquation(ne,ae,H,X);me.ni.copy(_e),me.ni.normalize(),me.ri.copy(me.ni),me.ri.scale(H.radius,me.ri),me.ri.vadd(Z,me.ri),me.ri.vsub(ne.position,me.ri),me.rj.copy(Te),me.rj.vsub(ae.position,me.rj),this.result.push(me),this.createFrictionEquationsFromContact(me,this.frictionResult)}for(var Ee=0;Ee<ee.length;Ee++)for(var Be=0;Be<3;Be++){X.getVertex(X.indices[ee[Ee]*3+Be],D),X.getVertex(X.indices[ee[Ee]*3+(Be+1)%3],re),re.vsub(D,le),se.vsub(re,ie);var Gt=ie.dot(le);se.vsub(D,ie);var Ht=ie.dot(le);if(Ht>0&&Gt<0){se.vsub(D,ie),de.copy(le),de.normalize(),Ht=ie.dot(de),de.scale(Ht,ie),ie.vadd(D,ie);var xt=ie.distanceTo(se);if(xt<H.radius){var me=this.createContactEquation(ne,ae,H,X);ie.vsub(se,me.ni),me.ni.normalize(),me.ni.scale(H.radius,me.ri),h.pointToWorldFrame(J,ce,ie,ie),ie.vsub(ae.position,me.rj),h.vectorToWorldFrame(ce,me.ni,me.ni),h.vectorToWorldFrame(ce,me.ri,me.ri),this.result.push(me),this.createFrictionEquationsFromContact(me,this.frictionResult)}}}for(var vi=q,At=V,Oe=P,mi=T,Ee=0,He=ee.length;Ee!==He;Ee++){X.getTriangleVertices(ee[Ee],vi,At,Oe),X.getNormal(ee[Ee],mi),se.vsub(vi,ie);var xt=ie.dot(mi);if(mi.scale(xt,ie),se.vsub(ie,ie),xt=ie.distanceTo(se),o.pointInTriangle(ie,vi,At,Oe)&&xt<H.radius){var me=this.createContactEquation(ne,ae,H,X);ie.vsub(se,me.ni),me.ni.normalize(),me.ni.scale(H.radius,me.ri),h.pointToWorldFrame(J,ce,ie,ie),ie.vsub(ae.position,me.rj),h.vectorToWorldFrame(ce,me.ni,me.ni),h.vectorToWorldFrame(ce,me.ri,me.ri),this.result.push(me),this.createFrictionEquationsFromContact(me,this.frictionResult)}}ee.length=0};var S=new a,b=new a;p.prototype[n.types.SPHERE|n.types.PLANE]=p.prototype.spherePlane=function(H,X,Z,J,ye,ce,ne,ae){var D=this.createContactEquation(ne,ae,H,X);if(D.ni.set(0,0,1),ce.vmult(D.ni,D.ni),D.ni.negate(D.ni),D.ni.normalize(),D.ni.mult(H.radius,D.ri),Z.vsub(J,S),D.ni.mult(D.ni.dot(S),b),S.vsub(b,D.rj),-S.dot(D.ni)<=H.radius){var re=D.ri,le=D.rj;re.vadd(Z,re),re.vsub(ne.position,re),le.vadd(J,le),le.vsub(ae.position,le),this.result.push(D),this.createFrictionEquationsFromContact(D,this.frictionResult)}};var N=new a,Y=new a,$=new a;function O(H,X,Z){for(var J=null,ye=H.length,ce=0;ce!==ye;ce++){var ne=H[ce],ae=N;H[(ce+1)%ye].vsub(ne,ae);var D=Y;ae.cross(X,D);var re=$;Z.vsub(ne,re);var le=D.dot(re);if(J===null||le>0&&J===!0||le<=0&&J===!1){J===null&&(J=le>0);continue}else return!1}return!0}var U=new a,Q=new a,fe=new a,ue=new a,he=[new a,new a,new a,new a,new a,new a],K=new a,te=new a,Me=new a,ge=new a;p.prototype[n.types.SPHERE|n.types.BOX]=p.prototype.sphereBox=function(H,X,Z,J,ye,ce,ne,ae){var D=this.v3pool,re=he;Z.vsub(J,U),X.getSideNormals(re,ce);for(var le=H.radius,de=!1,se=te,ie=Me,oe=ge,ve=null,_e=0,ee=0,xe=0,Te=null,Ye=0,Ee=re.length;Ye!==Ee&&de===!1;Ye++){var Be=Q;Be.copy(re[Ye]);var me=Be.norm();Be.normalize();var Gt=U.dot(Be);if(Gt<me+le&&Gt>0){var Ht=fe,xt=ue;Ht.copy(re[(Ye+1)%3]),xt.copy(re[(Ye+2)%3]);var vi=Ht.norm(),At=xt.norm();Ht.normalize(),xt.normalize();var Oe=U.dot(Ht),mi=U.dot(xt);if(Oe<vi&&Oe>-vi&&mi<At&&mi>-At){var tt=Math.abs(Gt-me-le);(Te===null||tt<Te)&&(Te=tt,ee=Oe,xe=mi,ve=me,se.copy(Be),ie.copy(Ht),oe.copy(xt),_e++)}}}if(_e){de=!0;var we=this.createContactEquation(ne,ae,H,X);se.mult(-le,we.ri),we.ni.copy(se),we.ni.negate(we.ni),se.mult(ve,se),ie.mult(ee,ie),se.vadd(ie,se),oe.mult(xe,oe),se.vadd(oe,we.rj),we.ri.vadd(Z,we.ri),we.ri.vsub(ne.position,we.ri),we.rj.vadd(J,we.rj),we.rj.vsub(ae.position,we.rj),this.result.push(we),this.createFrictionEquationsFromContact(we,this.frictionResult)}for(var He=D.get(),gi=K,bt=0;bt!==2&&!de;bt++)for(var ct=0;ct!==2&&!de;ct++)for(var st=0;st!==2&&!de;st++)if(He.set(0,0,0),bt?He.vadd(re[0],He):He.vsub(re[0],He),ct?He.vadd(re[1],He):He.vsub(re[1],He),st?He.vadd(re[2],He):He.vsub(re[2],He),J.vadd(He,gi),gi.vsub(Z,gi),gi.norm2()<le*le){de=!0;var we=this.createContactEquation(ne,ae,H,X);we.ri.copy(gi),we.ri.normalize(),we.ni.copy(we.ri),we.ri.mult(le,we.ri),we.rj.copy(He),we.ri.vadd(Z,we.ri),we.ri.vsub(ne.position,we.ri),we.rj.vadd(J,we.rj),we.rj.vsub(ae.position,we.rj),this.result.push(we),this.createFrictionEquationsFromContact(we,this.frictionResult)}D.release(He),He=null;for(var Ut=D.get(),yi=D.get(),we=D.get(),Bt=D.get(),tt=D.get(),Ui=re.length,bt=0;bt!==Ui&&!de;bt++)for(var ct=0;ct!==Ui&&!de;ct++)if(bt%3!==ct%3){re[ct].cross(re[bt],Ut),Ut.normalize(),re[bt].vadd(re[ct],yi),we.copy(Z),we.vsub(yi,we),we.vsub(J,we);var qi=we.dot(Ut);Ut.mult(qi,Bt);for(var st=0;st===bt%3||st===ct%3;)st++;tt.copy(Z),tt.vsub(Bt,tt),tt.vsub(yi,tt),tt.vsub(J,tt);var la=Math.abs(qi),ca=tt.norm();if(la<re[st].norm()&&ca<le){de=!0;var Ue=this.createContactEquation(ne,ae,H,X);yi.vadd(Bt,Ue.rj),Ue.rj.copy(Ue.rj),tt.negate(Ue.ni),Ue.ni.normalize(),Ue.ri.copy(Ue.rj),Ue.ri.vadd(J,Ue.ri),Ue.ri.vsub(Z,Ue.ri),Ue.ri.normalize(),Ue.ri.mult(le,Ue.ri),Ue.ri.vadd(Z,Ue.ri),Ue.ri.vsub(ne.position,Ue.ri),Ue.rj.vadd(J,Ue.rj),Ue.rj.vsub(ae.position,Ue.rj),this.result.push(Ue),this.createFrictionEquationsFromContact(Ue,this.frictionResult)}}D.release(Ut,yi,we,Bt,tt)};var Ne=new a,pe=new a,Fe=new a,ze=new a,Ie=new a,De=new a,Pe=new a,Ge=new a,Le=new a,Je=new a;p.prototype[n.types.SPHERE|n.types.CONVEXPOLYHEDRON]=p.prototype.sphereConvex=function(H,X,Z,J,ye,ce,ne,ae){var D=this.v3pool;Z.vsub(J,Ne);for(var re=X.faceNormals,le=X.faces,de=X.vertices,se=H.radius,ie=0;ie!==de.length;ie++){var oe=de[ie],ve=Ie;ce.vmult(oe,ve),J.vadd(ve,ve);var _e=ze;if(ve.vsub(Z,_e),_e.norm2()<se*se){xe=!0;var ee=this.createContactEquation(ne,ae,H,X);ee.ri.copy(_e),ee.ri.normalize(),ee.ni.copy(ee.ri),ee.ri.mult(se,ee.ri),ve.vsub(J,ee.rj),ee.ri.vadd(Z,ee.ri),ee.ri.vsub(ne.position,ee.ri),ee.rj.vadd(J,ee.rj),ee.rj.vsub(ae.position,ee.rj),this.result.push(ee),this.createFrictionEquationsFromContact(ee,this.frictionResult);return}}for(var xe=!1,ie=0,Te=le.length;ie!==Te&&xe===!1;ie++){var Ye=re[ie],Ee=le[ie],Be=De;ce.vmult(Ye,Be);var me=Pe;ce.vmult(de[Ee[0]],me),me.vadd(J,me);var Gt=Ge;Be.mult(-se,Gt),Z.vadd(Gt,Gt);var Ht=Le;Gt.vsub(me,Ht);var xt=Ht.dot(Be),vi=Je;if(Z.vsub(me,vi),xt<0&&vi.dot(Be)>0){for(var At=[],Oe=0,mi=Ee.length;Oe!==mi;Oe++){var He=D.get();ce.vmult(de[Ee[Oe]],He),J.vadd(He,He),At.push(He)}if(O(At,Be,Z)){xe=!0;var ee=this.createContactEquation(ne,ae,H,X);Be.mult(-se,ee.ri),Be.negate(ee.ni);var gi=D.get();Be.mult(-xt,gi);var bt=D.get();Be.mult(-se,bt),Z.vsub(J,ee.rj),ee.rj.vadd(bt,ee.rj),ee.rj.vadd(gi,ee.rj),ee.rj.vadd(J,ee.rj),ee.rj.vsub(ae.position,ee.rj),ee.ri.vadd(Z,ee.ri),ee.ri.vsub(ne.position,ee.ri),D.release(gi),D.release(bt),this.result.push(ee),this.createFrictionEquationsFromContact(ee,this.frictionResult);for(var Oe=0,ct=At.length;Oe!==ct;Oe++)D.release(At[Oe]);return}else for(var Oe=0;Oe!==Ee.length;Oe++){var st=D.get(),Ut=D.get();ce.vmult(de[Ee[(Oe+1)%Ee.length]],st),ce.vmult(de[Ee[(Oe+2)%Ee.length]],Ut),J.vadd(st,st),J.vadd(Ut,Ut);var yi=pe;Ut.vsub(st,yi);var we=Fe;yi.unit(we);var Bt=D.get(),tt=D.get();Z.vsub(st,tt);var Ui=tt.dot(we);we.mult(Ui,Bt),Bt.vadd(st,Bt);var qi=D.get();if(Bt.vsub(Z,qi),Ui>0&&Ui*Ui<yi.norm2()&&qi.norm2()<se*se){var ee=this.createContactEquation(ne,ae,H,X);Bt.vsub(J,ee.rj),Bt.vsub(Z,ee.ni),ee.ni.normalize(),ee.ni.mult(se,ee.ri),ee.rj.vadd(J,ee.rj),ee.rj.vsub(ae.position,ee.rj),ee.ri.vadd(Z,ee.ri),ee.ri.vsub(ne.position,ee.ri),this.result.push(ee),this.createFrictionEquationsFromContact(ee,this.frictionResult);for(var Oe=0,ct=At.length;Oe!==ct;Oe++)D.release(At[Oe]);D.release(st),D.release(Ut),D.release(Bt),D.release(qi),D.release(tt);return}D.release(st),D.release(Ut),D.release(Bt),D.release(qi),D.release(tt)}for(var Oe=0,ct=At.length;Oe!==ct;Oe++)D.release(At[Oe])}}},new a,new a,p.prototype[n.types.PLANE|n.types.BOX]=p.prototype.planeBox=function(H,X,Z,J,ye,ce,ne,ae){X.convexPolyhedronRepresentation.material=X.material,X.convexPolyhedronRepresentation.collisionResponse=X.collisionResponse,this.planeConvex(H,X.convexPolyhedronRepresentation,Z,J,ye,ce,ne,ae)};var _t=new a,pi=new a,Ei=new a,fi=new a;p.prototype[n.types.PLANE|n.types.CONVEXPOLYHEDRON]=p.prototype.planeConvex=function(H,X,Z,J,ye,ce,ne,ae){var D=_t,re=pi;re.set(0,0,1),ye.vmult(re,re);for(var le=0,de=Ei,se=0;se!==X.vertices.length;se++){D.copy(X.vertices[se]),ce.vmult(D,D),J.vadd(D,D),D.vsub(Z,de);var ie=re.dot(de);if(ie<=0){var oe=this.createContactEquation(ne,ae,H,X),ve=fi;re.mult(re.dot(de),ve),D.vsub(ve,ve),ve.vsub(Z,oe.ri),oe.ni.copy(re),D.vsub(J,oe.rj),oe.ri.vadd(Z,oe.ri),oe.ri.vsub(ne.position,oe.ri),oe.rj.vadd(J,oe.rj),oe.rj.vsub(ae.position,oe.rj),this.result.push(oe),le++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(oe,this.frictionResult)}}this.enableFrictionReduction&&le&&this.createFrictionFromAverage(le)};var Dt=new a,Wt=new a;p.prototype[n.types.CONVEXPOLYHEDRON]=p.prototype.convexConvex=function(H,X,Z,J,ye,ce,ne,ae,D,re,le,de){var se=Dt;if(!(Z.distanceTo(J)>H.boundingSphereRadius+X.boundingSphereRadius)&&H.findSeparatingAxis(X,Z,ye,J,ce,se,le,de)){var ie=[],oe=Wt;H.clipAgainstHull(Z,ye,X,J,ce,se,-100,100,ie);for(var ve=0,_e=0;_e!==ie.length;_e++){var ee=this.createContactEquation(ne,ae,H,X,D,re),xe=ee.ri,Te=ee.rj;se.negate(ee.ni),ie[_e].normal.negate(oe),oe.mult(ie[_e].depth,oe),ie[_e].point.vadd(oe,xe),Te.copy(ie[_e].point),xe.vsub(Z,xe),Te.vsub(J,Te),xe.vadd(Z,xe),xe.vsub(ne.position,xe),Te.vadd(J,Te),Te.vsub(ae.position,Te),this.result.push(ee),ve++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(ee,this.frictionResult)}this.enableFrictionReduction&&ve&&this.createFrictionFromAverage(ve)}};var Di=new a,Si=new a,ti=new a;p.prototype[n.types.PLANE|n.types.PARTICLE]=p.prototype.planeParticle=function(H,X,Z,J,ye,ce,ne,ae){var D=Di;D.set(0,0,1),ne.quaternion.vmult(D,D);var re=Si;J.vsub(ne.position,re);var le=D.dot(re);if(le<=0){var de=this.createContactEquation(ae,ne,X,H);de.ni.copy(D),de.ni.negate(de.ni),de.ri.set(0,0,0);var se=ti;D.mult(D.dot(J),se),J.vsub(se,se),de.rj.copy(se),this.result.push(de),this.createFrictionEquationsFromContact(de,this.frictionResult)}};var Qt=new a;p.prototype[n.types.PARTICLE|n.types.SPHERE]=p.prototype.sphereParticle=function(H,X,Z,J,ye,ce,ne,ae){var D=Qt;D.set(0,0,1),J.vsub(Z,D);var re=D.norm2();if(re<=H.radius*H.radius){var le=this.createContactEquation(ae,ne,X,H);D.normalize(),le.rj.copy(D),le.rj.mult(H.radius,le.rj),le.ni.copy(D),le.ni.negate(le.ni),le.ri.set(0,0,0),this.result.push(le),this.createFrictionEquationsFromContact(le,this.frictionResult)}};var Lt=new l,ii=new a;new a;var Zt=new a,vt=new a,Wi=new a;p.prototype[n.types.PARTICLE|n.types.CONVEXPOLYHEDRON]=p.prototype.convexParticle=function(H,X,Z,J,ye,ce,ne,ae){var D=-1,re=Zt,le=Wi,de=null,se=ii;if(se.copy(J),se.vsub(Z,se),ye.conjugate(Lt),Lt.vmult(se,se),H.pointIsInside(se)){H.worldVerticesNeedsUpdate&&H.computeWorldVertices(Z,ye),H.worldFaceNormalsNeedsUpdate&&H.computeWorldFaceNormals(ye);for(var ie=0,oe=H.faces.length;ie!==oe;ie++){var ve=[H.worldVertices[H.faces[ie][0]]],_e=H.worldFaceNormals[ie];J.vsub(ve[0],vt);var ee=-_e.dot(vt);(de===null||Math.abs(ee)<Math.abs(de))&&(de=ee,D=ie,re.copy(_e))}if(D!==-1){var xe=this.createContactEquation(ae,ne,X,H);re.mult(de,le),le.vadd(J,le),le.vsub(Z,le),xe.rj.copy(le),re.negate(xe.ni),xe.ri.set(0,0,0);var Te=xe.ri,Ye=xe.rj;Te.vadd(J,Te),Te.vsub(ae.position,Te),Ye.vadd(Z,Ye),Ye.vsub(ne.position,Ye),this.result.push(xe),this.createFrictionEquationsFromContact(xe,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}},p.prototype[n.types.BOX|n.types.HEIGHTFIELD]=p.prototype.boxHeightfield=function(H,X,Z,J,ye,ce,ne,ae){H.convexPolyhedronRepresentation.material=H.material,H.convexPolyhedronRepresentation.collisionResponse=H.collisionResponse,this.convexHeightfield(H.convexPolyhedronRepresentation,X,Z,J,ye,ce,ne,ae)};var Gi=new a,Hi=new a,cn=[0];p.prototype[n.types.CONVEXPOLYHEDRON|n.types.HEIGHTFIELD]=p.prototype.convexHeightfield=function(H,X,Z,J,ye,ce,ne,ae){var D=X.data,re=X.elementSize,le=H.boundingSphereRadius,de=Hi,se=cn,ie=Gi;h.pointToLocalFrame(J,ce,Z,ie);var oe=Math.floor((ie.x-le)/re)-1,ve=Math.ceil((ie.x+le)/re)+1,_e=Math.floor((ie.y-le)/re)-1,ee=Math.ceil((ie.y+le)/re)+1;if(!(ve<0||ee<0||oe>D.length||_e>D[0].length)){oe<0&&(oe=0),ve<0&&(ve=0),_e<0&&(_e=0),ee<0&&(ee=0),oe>=D.length&&(oe=D.length-1),ve>=D.length&&(ve=D.length-1),ee>=D[0].length&&(ee=D[0].length-1),_e>=D[0].length&&(_e=D[0].length-1);var xe=[];X.getRectMinMax(oe,_e,ve,ee,xe);var Te=xe[0],Ye=xe[1];if(!(ie.z-le>Ye||ie.z+le<Te))for(var Ee=oe;Ee<ve;Ee++)for(var Be=_e;Be<ee;Be++)X.getConvexTrianglePillar(Ee,Be,!1),h.pointToWorldFrame(J,ce,X.pillarOffset,de),Z.distanceTo(de)<X.pillarConvex.boundingSphereRadius+H.boundingSphereRadius&&this.convexConvex(H,X.pillarConvex,Z,de,ye,ce,ne,ae,null,null,se,null),X.getConvexTrianglePillar(Ee,Be,!0),h.pointToWorldFrame(J,ce,X.pillarOffset,de),Z.distanceTo(de)<X.pillarConvex.boundingSphereRadius+H.boundingSphereRadius&&this.convexConvex(H,X.pillarConvex,Z,de,ye,ce,ne,ae,null,null,se,null)}};var hn=new a,et=new a;p.prototype[n.types.SPHERE|n.types.HEIGHTFIELD]=p.prototype.sphereHeightfield=function(H,X,Z,J,ye,ce,ne,ae){var D=X.data,re=H.radius,le=X.elementSize,de=et,se=hn;h.pointToLocalFrame(J,ce,Z,se);var ie=Math.floor((se.x-re)/le)-1,oe=Math.ceil((se.x+re)/le)+1,ve=Math.floor((se.y-re)/le)-1,_e=Math.ceil((se.y+re)/le)+1;if(!(oe<0||_e<0||ie>D.length||_e>D[0].length)){ie<0&&(ie=0),oe<0&&(oe=0),ve<0&&(ve=0),_e<0&&(_e=0),ie>=D.length&&(ie=D.length-1),oe>=D.length&&(oe=D.length-1),_e>=D[0].length&&(_e=D[0].length-1),ve>=D[0].length&&(ve=D[0].length-1);var ee=[];X.getRectMinMax(ie,ve,oe,_e,ee);var xe=ee[0],Te=ee[1];if(!(se.z-re>Te||se.z+re<xe))for(var Ye=this.result,Ee=ie;Ee<oe;Ee++)for(var Be=ve;Be<_e;Be++){var me=Ye.length;X.getConvexTrianglePillar(Ee,Be,!1),h.pointToWorldFrame(J,ce,X.pillarOffset,de),Z.distanceTo(de)<X.pillarConvex.boundingSphereRadius+H.boundingSphereRadius&&this.sphereConvex(H,X.pillarConvex,Z,de,ye,ce,ne,ae),X.getConvexTrianglePillar(Ee,Be,!0),h.pointToWorldFrame(J,ce,X.pillarOffset,de),Z.distanceTo(de)<X.pillarConvex.boundingSphereRadius+H.boundingSphereRadius&&this.sphereConvex(H,X.pillarConvex,Z,de,ye,ce,ne,ae);var Gt=Ye.length-me;if(Gt>2)return}}}},{"../collision/AABB":3,"../collision/Ray":9,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../math/Quaternion":28,"../math/Transform":29,"../math/Vec3":30,"../shapes/ConvexPolyhedron":38,"../shapes/Shape":43,"../solver/Solver":47,"../utils/Vec3Pool":54}],56:[function(t,i,r){i.exports=w;var s=t("../shapes/Shape"),n=t("../math/Vec3"),o=t("../math/Quaternion"),a=t("../solver/GSSolver");t("../utils/Vec3Pool"),t("../equations/ContactEquation"),t("../equations/FrictionEquation");var h=t("./Narrowphase"),l=t("../utils/EventTarget"),c=t("../collision/ArrayCollisionMatrix"),u=t("../material/Material"),d=t("../material/ContactMaterial"),p=t("../objects/Body"),f=t("../utils/TupleDictionary"),v=t("../collision/RaycastResult"),m=t("../collision/AABB"),g=t("../collision/Ray"),_=t("../collision/NaiveBroadphase");function w(){l.apply(this),this.dt=-1,this.allowSleep=!1,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=0,this.quatNormalizeFast=!1,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new n,this.broadphase=new _,this.bodies=[],this.solver=new a,this.constraints=[],this.narrowphase=new h(this),this.collisionMatrix=new c,this.collisionMatrixPrevious=new c,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new f,this.defaultMaterial=new u("default"),this.defaultContactMaterial=new d(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null}}w.prototype=new l,new m;var x=new g;if(w.prototype.getContactMaterial=function(I,q){return this.contactMaterialTable.get(I.id,q.id)},w.prototype.numObjects=function(){return this.bodies.length},w.prototype.collisionMatrixTick=function(){var I=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=I,this.collisionMatrix.reset()},w.prototype.add=w.prototype.addBody=function(I){this.bodies.indexOf(I)===-1&&(I.index=this.bodies.length,this.bodies.push(I),I.world=this,I.initPosition.copy(I.position),I.initVelocity.copy(I.velocity),I.timeLastSleepy=this.time,I instanceof p&&(I.initAngularVelocity.copy(I.angularVelocity),I.initQuaternion.copy(I.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=I,this.dispatchEvent(this.addBodyEvent))},w.prototype.addConstraint=function(I){this.constraints.push(I)},w.prototype.removeConstraint=function(I){var q=this.constraints.indexOf(I);q!==-1&&this.constraints.splice(q,1)},w.prototype.rayTest=function(I,q,V){V instanceof v?this.raycastClosest(I,q,{skipBackfaces:!0},V):this.raycastAll(I,q,{skipBackfaces:!0},V)},w.prototype.raycastAll=function(I,q,V,P){return V.mode=g.ALL,V.from=I,V.to=q,V.callback=P,x.intersectWorld(this,V)},w.prototype.raycastAny=function(I,q,V,P){return V.mode=g.ANY,V.from=I,V.to=q,V.result=P,x.intersectWorld(this,V)},w.prototype.raycastClosest=function(I,q,V,P){return V.mode=g.CLOSEST,V.from=I,V.to=q,V.result=P,x.intersectWorld(this,V)},w.prototype.remove=function(I){I.world=null;var q=this.bodies.length-1,V=this.bodies,P=V.indexOf(I);if(P!==-1){V.splice(P,1);for(var k=0;k!==V.length;k++)V[k].index=k;this.collisionMatrix.setNumObjects(q),this.removeBodyEvent.body=I,this.dispatchEvent(this.removeBodyEvent)}},w.prototype.removeBody=w.prototype.remove,w.prototype.addMaterial=function(I){this.materials.push(I)},w.prototype.addContactMaterial=function(I){this.contactmaterials.push(I),this.contactMaterialTable.set(I.materials[0].id,I.materials[1].id,I)},typeof performance>"u"&&(performance={}),!performance.now){var E=Date.now();performance.timing&&performance.timing.navigationStart&&(E=performance.timing.navigationStart),performance.now=function(){return Date.now()-E}}var L=new n;w.prototype.step=function(I,q,V){if(V=V||10,q=q||0,q===0)this.internalStep(I),this.time+=I;else{var P=Math.floor((this.time+q)/I)-Math.floor(this.time/I);P=Math.min(P,V);for(var k=performance.now(),M=0;M!==P&&(this.internalStep(I),!(performance.now()-k>I*1e3));M++);this.time+=q;for(var S=this.time%I,b=S/I,N=L,Y=this.bodies,$=0;$!==Y.length;$++){var O=Y[$];O.type!==p.STATIC&&O.sleepState!==p.SLEEPING?(O.position.vsub(O.previousPosition,N),N.scale(b,N),O.position.vadd(N,O.interpolatedPosition)):(O.interpolatedPosition.copy(O.position),O.interpolatedQuaternion.copy(O.quaternion))}}};var A={type:"postStep"},T={type:"preStep"},R={type:"collide",body:null,contact:null},C=[],B=[],F=[],W=[];new n,new n,new n,new n,new n,new n,new n,new n,new n,new o;var G=new o,j=new o,z=new n;w.prototype.internalStep=function(I){this.dt=I;var q=this.contacts,V=F,P=W,k=this.numObjects(),M=this.bodies,S=this.solver,b=this.gravity,N=this.doProfiling,Y=this.profile,$=p.DYNAMIC,O,U=this.constraints,Q=B;b.norm();var fe=b.x,ue=b.y,he=b.z,K=0;for(N&&(O=performance.now()),K=0;K!==k;K++){var te=M[K];if(te.type&$){var Me=te.force,ge=te.mass;Me.x+=ge*fe,Me.y+=ge*ue,Me.z+=ge*he}}for(var K=0,Ne=this.subsystems.length;K!==Ne;K++)this.subsystems[K].update();N&&(O=performance.now()),V.length=0,P.length=0,this.broadphase.collisionPairs(this,V,P),N&&(Y.broadphase=performance.now()-O);var Dt=U.length;for(K=0;K!==Dt;K++){var pe=U[K];if(!pe.collideConnected)for(var Fe=V.length-1;Fe>=0;Fe-=1)(pe.bodyA===V[Fe]&&pe.bodyB===P[Fe]||pe.bodyB===V[Fe]&&pe.bodyA===P[Fe])&&(V.splice(Fe,1),P.splice(Fe,1))}this.collisionMatrixTick(),N&&(O=performance.now());var ze=C,Ie=q.length;for(K=0;K!==Ie;K++)ze.push(q[K]);q.length=0;var De=this.frictionEquations.length;for(K=0;K!==De;K++)Q.push(this.frictionEquations[K]);this.frictionEquations.length=0,this.narrowphase.getContacts(V,P,this,q,ze,this.frictionEquations,Q),N&&(Y.narrowphase=performance.now()-O),N&&(O=performance.now());for(var K=0;K<this.frictionEquations.length;K++)S.addEquation(this.frictionEquations[K]);for(var Pe=q.length,Ge=0;Ge!==Pe;Ge++){var pe=q[Ge],te=pe.bi,Le=pe.bj;pe.si,pe.sj;var Je;if(te.material&&Le.material?Je=this.getContactMaterial(te.material,Le.material)||this.defaultContactMaterial:Je=this.defaultContactMaterial,Je.friction,te.material&&Le.material&&(te.material.friction>=0&&Le.material.friction>=0&&te.material.friction*Le.material.friction,te.material.restitution>=0&&Le.material.restitution>=0&&(pe.restitution=te.material.restitution*Le.material.restitution)),S.addEquation(pe),te.allowSleep&&te.type===p.DYNAMIC&&te.sleepState===p.SLEEPING&&Le.sleepState===p.AWAKE&&Le.type!==p.STATIC){var _t=Le.velocity.norm2()+Le.angularVelocity.norm2(),pi=Math.pow(Le.sleepSpeedLimit,2);_t>=pi*2&&(te._wakeUpAfterNarrowphase=!0)}if(Le.allowSleep&&Le.type===p.DYNAMIC&&Le.sleepState===p.SLEEPING&&te.sleepState===p.AWAKE&&te.type!==p.STATIC){var Ei=te.velocity.norm2()+te.angularVelocity.norm2(),fi=Math.pow(te.sleepSpeedLimit,2);Ei>=fi*2&&(Le._wakeUpAfterNarrowphase=!0)}this.collisionMatrix.set(te,Le,!0),this.collisionMatrixPrevious.get(te,Le)||(R.body=Le,R.contact=pe,te.dispatchEvent(R),R.body=te,Le.dispatchEvent(R))}for(N&&(Y.makeContactConstraints=performance.now()-O,O=performance.now()),K=0;K!==k;K++){var te=M[K];te._wakeUpAfterNarrowphase&&(te.wakeUp(),te._wakeUpAfterNarrowphase=!1)}var Dt=U.length;for(K=0;K!==Dt;K++){var pe=U[K];pe.update();for(var Fe=0,Wt=pe.equations.length;Fe!==Wt;Fe++){var Di=pe.equations[Fe];S.addEquation(Di)}}S.solve(I,this),N&&(Y.solve=performance.now()-O),S.removeAllEquations();var Si=Math.pow;for(K=0;K!==k;K++){var te=M[K];if(te.type&$){var ti=Si(1-te.linearDamping,I),Qt=te.velocity;Qt.mult(ti,Qt);var Lt=te.angularVelocity;if(Lt){var ii=Si(1-te.angularDamping,I);Lt.mult(ii,Lt)}}}for(this.dispatchEvent(T),K=0;K!==k;K++){var te=M[K];te.preStep&&te.preStep.call(te)}N&&(O=performance.now());var Zt=G,vt=j,Wi=this.stepnumber,Gi=p.DYNAMIC|p.KINEMATIC,Hi=Wi%(this.quatNormalizeSkip+1)===0,cn=this.quatNormalizeFast,hn=I*.5;for(s.types.PLANE,s.types.CONVEXPOLYHEDRON,K=0;K!==k;K++){var et=M[K],H=et.force,X=et.torque;if(et.type&Gi&&et.sleepState!==p.SLEEPING){var Z=et.velocity,J=et.angularVelocity,ye=et.position,ce=et.quaternion,ne=et.invMass,ae=et.invInertiaWorld;Z.x+=H.x*ne*I,Z.y+=H.y*ne*I,Z.z+=H.z*ne*I,et.angularVelocity&&(ae.vmult(X,z),z.mult(I,z),z.vadd(J,J)),ye.x+=Z.x*I,ye.y+=Z.y*I,ye.z+=Z.z*I,et.angularVelocity&&(Zt.set(J.x,J.y,J.z,0),Zt.mult(ce,vt),ce.x+=hn*vt.x,ce.y+=hn*vt.y,ce.z+=hn*vt.z,ce.w+=hn*vt.w,Hi&&(cn?ce.normalizeFast():ce.normalize())),et.aabb&&(et.aabbNeedsUpdate=!0),et.updateInertiaWorld&&et.updateInertiaWorld()}}for(this.clearForces(),this.broadphase.dirty=!0,N&&(Y.integrate=performance.now()-O),this.time+=I,this.stepnumber+=1,this.dispatchEvent(A),K=0;K!==k;K++){var te=M[K],D=te.postStep;D&&D.call(te)}if(this.allowSleep)for(K=0;K!==k;K++)M[K].sleepTick(this.time)},w.prototype.clearForces=function(){for(var I=this.bodies,q=I.length,V=0;V!==q;V++){var P=I[V];P.force,P.torque,P.force.set(0,0,0),P.torque.set(0,0,0)}}},{"../collision/AABB":3,"../collision/ArrayCollisionMatrix":4,"../collision/NaiveBroadphase":7,"../collision/Ray":9,"../collision/RaycastResult":10,"../equations/ContactEquation":19,"../equations/FrictionEquation":21,"../material/ContactMaterial":24,"../material/Material":25,"../math/Quaternion":28,"../math/Vec3":30,"../objects/Body":31,"../shapes/Shape":43,"../solver/GSSolver":46,"../utils/EventTarget":49,"../utils/TupleDictionary":52,"../utils/Vec3Pool":54,"./Narrowphase":55}]},{},[2])(2)})})(aa);var Qh=aa.exports;const qt=ha(Qh),Zh={class:"wcp-demo-container"},Jh={__name:"ThreePhysics",setup(y){const e=Ce(null),t=Ce(null),i=new di;return ot(()=>{const r=new pt,s=new Audio("/sounds/glass-hitting.wav"),n=new Audio("/sounds/game-ball-tap.wav");function o(V){const P=V.contact.getImpactVelocityAlongNormal();P>1.5&&(s.volume=Math.min(P/10,1),s.currentTime=0,s.play())}function a(V){const P=V.contact.getImpactVelocityAlongNormal();P>1.5&&(n.volume=Math.min(P/10,1),n.currentTime=0,n.play())}const l=new Qa().load(["/textures/matcap1.png","/textures/matcap1.png","/textures/matcap1.png","/textures/matcap1.png","/textures/matcap1.png","/textures/matcap1.png"]),u=new ui().load("/textures/Plastic013A/Plastic013A_1K-PNG_Color.png");u.wrapS=It,u.wrapT=It,u.repeat.set(2,2);const d=new Ae(new rn(10,10),new je({color:"#eee",side:ki}));d.rotation.x=-Math.PI/2,r.add(d),d.receiveShadow=!0,console.log(qt);const p=new qt.World;p.gravity.set(0,-9.8,0);const f=new qt.Material("ballMaterial"),v=new qt.ContactMaterial(f,{friction:.1,restitution:.7});p.addContactMaterial(v),p.defaultContactMaterial=v;const m=new qt.Plane,g=new qt.Body;g.mass=0,g.addShape(m),g.quaternion.setFromAxisAngle(new qt.Vec3(-1,0,0),Math.PI/2),p.addBody(g);const _=new an("#ffffff",.5);r.add(_);const w=new bn("#ffffff",.5);w.position.set(1,3,-3),w.castShadow=!0,r.add(w);const x={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},E=new lt(75,x.width/x.height,.1,1e3);E.position.z=6,E.position.y=6,E.position.x=6,r.add(E);const L=new Vt(E,t.value);L.enableDamping=!0;const A={};A.createSphere=function(){F(Math.random()*.5,{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})},A.createBox=function(){j(Math.random()*.5,Math.random()*.5,Math.random()*.5,{x:(Math.random()-.5)*3,y:3,z:(Math.random()-.5)*3})},A.reset=()=>{R.forEach(V=>{V.body.removeEventListener("collide",o),p.removeBody(V.body),r.remove(V.mesh)}),R.length=0},i.add(A,"createSphere"),i.add(A,"createBox"),i.add(A,"reset");const T=new ft({canvas:t.value});T.setSize(x.width,x.height),T.setPixelRatio(Math.min(window.devicePixelRatio,2)),T.shadowMap.enabled=!0;const R=[],C=new oi(1,32,32),B=new je({metalness:.3,roughness:.4,envMap:l});function F(V,P){const k=new Ae(C,B);k.scale.set(V,V,V),k.castShadow=!0,k.position.copy(P),r.add(k);const M=new qt.Sphere(V),S=new qt.Body({mass:1,position:P,shape:M,material:f});S.position.copy(P),S.addEventListener("collide",a),p.addBody(S),R.push({mesh:k,body:S})}const W=new Jt(1,1,1),G=new je({metalness:1,roughness:.4,envMap:l});function j(V,P,k,M){const S=new Ae(W,G);S.scale.set(V,P,k),S.castShadow=!0,S.position.copy(M),r.add(S);const b=new qt.Box(new qt.Vec3(V/2,P/2,k/2)),N=new qt.Body({mass:1,position:M,shape:b,material:f});N.position.copy(M),N.addEventListener("collide",o),p.addBody(N),R.push({mesh:S,body:N})}F(.5,{x:0,y:3,z:0});const z=new hi;let I=0;function q(){requestAnimationFrame(q);const V=z.getElapsedTime(),P=V-I;I=V,p.step(1/60,P,3),R.forEach(k=>{k.mesh.position.copy(k.body.position),k.mesh.quaternion.copy(k.body.quaternion)}),L.update(),T.render(r,E)}q(),window.addEventListener("resize",V=>{x.width=+getComputedStyle(e.value).width.split("px")[0],x.height=+getComputedStyle(e.value).height.split("px")[0],E.aspect=x.width/x.height,E.updateProjectionMatrix(),T.setSize(x.width,x.height),T.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",V=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy(),console.log("unmounted")}),(r,s)=>(ke(),nt("div",Zh,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},eu=at(Jh,[["__scopeId","data-v-610169cf"]]),tu={class:"wcp-demo-container"},iu={__name:"ThreeModels",setup(y){const e=Ce(null),t=Ce(null),i=new di;Ce({animation:0});const r=new pt,s=new fs,n=new oa;n.setDecoderPath("/js/three/examples/js/libs/draco/"),s.setDRACOLoader(n);const o={model:null,animation:{},resource:null,update:function(d){this.model!==null&&this.animation.mixer.update(d)}};s.load("/models/Fox/glTF/Fox.gltf",d=>{o.model=d.scene,o.resource=d,o.animation.mixer=new Za(o.model),o.animation.actions={default:o.animation.mixer.clipAction(o.resource.animations[0]),walking:o.animation.mixer.clipAction(o.resource.animations[1]),running:o.animation.mixer.clipAction(o.resource.animations[2])},o.animation.action=o.animation.actions.default,console.log(o.animation.action),o.animation.action.play(),o.animation.play=p=>{const f=o.animation.actions[p],v=o.animation.action;f.reset(),f.play(),f.crossFadeFrom(v,1),o.animation.action=f},o.model.scale.set(.06,.06,.06),o.model.traverse(p=>{p instanceof Ae&&(p.castShadow=!0)}),r.add(o.model)},d=>{console.log(d.loaded/d.total*100+"% loaded")},d=>{console.log(d)});const h=new ui().load("/textures/Plastic013A/Plastic013A_1K-PNG_Color.png");h.wrapS=It,h.wrapT=It,h.repeat.set(2,2);const l=new Ae(new rn(20,20),new je({color:"#eee",side:ki}));l.rotation.x=-Math.PI/2,r.add(l),l.receiveShadow=!0;const c=new an("#ffffff",.5);r.add(c);const u=new bn("#ffffff",1.5);return u.position.set(4,5,0),u.castShadow=!0,r.add(u),ot(()=>{console.log(e.value);const d={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},p=new lt(75,d.width/d.height,.1,1e3);p.position.z=6,p.position.y=6,p.position.x=6,r.add(p);const f=new Vt(p,t.value);f.enableDamping=!0,i.add(u,"intensity",0,10).name("light intensity"),i.add(u.position,"x",-10,10),i.add(u.position,"y",-10,10),i.add(u.position,"z",-10,10),i.add(u,"castShadow");const v=new ft({canvas:t.value});v.setSize(d.width,d.height),v.setPixelRatio(Math.min(window.devicePixelRatio,2)),v.shadowMap.enabled=!0;const m=new hi;let g=0;function _(){requestAnimationFrame(_);const w=m.getElapsedTime(),x=w-g;g=w,o.update(x),f.update(),v.render(r,p)}_(),window.addEventListener("resize",w=>{d.width=+getComputedStyle(e.value).width.split("px")[0],d.height=+getComputedStyle(e.value).height.split("px")[0],p.aspect=d.width/d.height,p.updateProjectionMatrix(),v.setSize(d.width,d.height),v.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",w=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy(),console.log("unmounted")}),(d,p)=>(ke(),nt("div",tu,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512),be("w-btn",{onClick:p[0]||(p[0]=()=>{o.animation.play("default")})},"default"),be("w-btn",{onClick:p[1]||(p[1]=()=>{o.animation.play("walking")})},"walking"),be("w-btn",{onClick:p[2]||(p[2]=()=>{o.animation.play("running")})},"running")]))}},nu=at(iu,[["__scopeId","data-v-51229556"]]),ru={class:"wcp-demo-container"},su={__name:"ThreeMouseEvent",setup(y){const e=Ce(null),t=Ce(null);return ot(()=>{new ui().load("/textures/matcap1.png");const r=new pt,s=new Ae(new oi(.5,16,16),new je);s.position.x=-1.5;const n=new Ae(new oi(.5,16,16),new je),o=new Ae(new oi(.5,16,16),new je);o.position.x=1.5,r.add(s),r.add(n),r.add(o);const a={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},h=new lt(75,a.width/a.height,.1,1e3);h.position.z=5,r.add(h);const l=new Vt(h,t.value);l.enableDamping=!0;const c=new an(16777215,.5);r.add(c);const u=new ft({canvas:t.value});u.setSize(a.width,a.height),u.setPixelRatio(Math.min(window.devicePixelRatio,2));let d=null;new fs().load("/models/Fox/glTF/Fox.gltf",w=>{d=w.scene,w.scene.scale.set(.01,.01,.01),r.add(w.scene)},w=>{console.log(w.loaded/w.total*100+"% loaded")},w=>{console.log(w)}),window.addEventListener("resize",w=>{a.width=+getComputedStyle(e.value).width.split("px")[0],a.height=+getComputedStyle(e.value).height.split("px")[0],h.aspect=a.width/a.height,h.updateProjectionMatrix(),u.setSize(a.width,a.height),u.setPixelRatio(Math.min(window.devicePixelRatio,2))});const f=new Ja,v=new Kr;let m=null;window.addEventListener("pointermove",w=>{v.x=w.clientX/window.innerWidth*2-1,v.y=-(w.clientY/window.innerHeight)*2+1}),t.value.addEventListener("dblclick",w=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()}),t.value.addEventListener("click",w=>{if(m)switch(m.object){case s:console.log("sphere1 clicked");break;case n:console.log("sphere2 clicked");break;case o:console.log("sphere3 clicked");break}});const g=new hi;function _(){const w=g.getElapsedTime();s.position.y=Math.sin(w*.3)*1.5,n.position.y=Math.sin(w*1.4)*1.5,o.position.y=Math.sin(w*.8)*1.5,f.setFromCamera(v,h);const x=[s,n,o],E=f.intersectObjects(x);x.forEach(L=>{L.material.color.set("pink")});for(let L=0;L<E.length;L++)E[L].object.material.color.set("#abcdef");E.length>0?m=E[0]:m=null,d&&(f.intersectObject(d).length>0?d.scale.set(.02,.02,.02):d.scale.set(.01,.01,.01)),l.update(),u.render(r,h),requestAnimationFrame(_)}_()}),wt(()=>{}),(i,r)=>(ke(),nt("div",ru,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},ou=at(su,[["__scopeId","data-v-f87a115a"]]),au={class:"wcp-demo-container"},lu={__name:"ThreeEnvironmentMap",setup(y){const e=Ce(null),t=Ce(null),i=new di;return ot(async()=>{const r=new pt,s=new fs,n=new oa,o=new lr;new ui;const a=await o.loadAsync("/hdrs/1.hdr");a.mapping=Xs,r.background=a,r.environment=a;const h=new Ae(new oi(1,16,16),new je({roughness:0,metalness:1}));h.position.x=4,h.material.map=a,r.add(h);const l=new Ae(new hr(6,.5),new Et({color:new yt(10,6,2)}));l.position.y=2,r.add(l);const c=new el(256,{type:Sn});r.environment=c.texture;const u=new tl(.1,100,c);n.setDecoderPath("/js/three/examples/js/libs/draco/"),s.setDRACOLoader(n),s.load("/models/FlightHelmet/glTF/FlightHelmet.gltf",w=>{w.scene.scale.set(2,2,2),r.add(w.scene)},w=>{console.log(w.loaded/w.total*100+"% loaded")},w=>{console.log(w)});const d=new an("#ffffff",0);r.add(d);const p={width:+getComputedStyle(e.value).width.split("px")[0],height:+getComputedStyle(e.value).height.split("px")[0]},f=new lt(75,p.width/p.height,.1,1e3);f.position.z=6,f.position.y=6,f.position.x=6,r.add(f);const v=new ft({canvas:t.value});v.setSize(p.width,p.height),v.setPixelRatio(Math.min(window.devicePixelRatio,2)),v.shadowMap.enabled=!0,v.toneMappingExposure=1,v.toneMapping=_s;const m=new Vt(f,t.value);m.enableDamping=!0,m.target.set(0,2,0),m.maxPolarAngle=Pn.degToRad(90),m.maxDistance=80,m.minDistance=10,m.enablePan=!1,m.update(),i.add(d,"intensity",0,1),i.add(v,"toneMapping",{No:il,Linear:nl,Reinhard:_s,Cineon:rl,ACESFilmic:sl}),i.add(v,"toneMappingExposure",0,10).step(.001);const g=new hi;function _(){requestAnimationFrame(_);const w=g.getElapsedTime();l.rotation.x=w,u.update(v,r),m.update(),v.render(r,f)}_(),window.addEventListener("resize",w=>{p.width=+getComputedStyle(e.value).width.split("px")[0],p.height=+getComputedStyle(e.value).height.split("px")[0],f.aspect=p.width/p.height,f.updateProjectionMatrix(),v.setSize(p.width,p.height),v.setPixelRatio(Math.min(window.devicePixelRatio,2))}),t.value.addEventListener("dblclick",w=>{document.fullscreenElement?document.exitFullscreen():e.value.requestFullscreen()})}),wt(()=>{i.destroy(),console.log("unmounted")}),(r,s)=>(ke(),nt("div",au,[be("div",{ref_key:"canvasContainer",ref:e,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:t},null,512)],512)]))}},cu=at(lu,[["__scopeId","data-v-2d2d2a20"]]),hu={class:"wcp-demo-container"},uu={__name:"ThreePanoramic",setup(y){Ce({}),Hs();let e,t,i,r=0,s=0,n=0,o=0,a=0,h=0,l=0,c=0;const u=Ce(null),d=Ce(null);function p(){e=new lt(75,window.innerWidth/window.innerHeight,1,1100),t=new pt;const E=new oi(500,60,40);E.scale(1,1,-1);const L=new lr().load("/hdrs/0.hdr"),A=new lr().load("/hdrs/1.hdr");L.colorSpace=zi;const T=new Et({map:L}),R=new Ae(E,T);t.add(R),i=new ft({canvas:d.value});const C={width:+getComputedStyle(u.value).width.split("px")[0],height:+getComputedStyle(u.value).height.split("px")[0]};i.setPixelRatio(window.devicePixelRatio),i.setSize(C.width,C.height),u.value.style.touchAction="none",u.value.addEventListener("pointerdown",v),u.value.addEventListener("wheel",_),u.value.addEventListener("dblclick",B=>{console.log(T),T.map==L?T.map=A:T.map=L,n=0,a=0}),document.addEventListener("dragover",function(B){B.preventDefault(),B.dataTransfer.dropEffect="copy"}),document.addEventListener("dragenter",function(){document.body.style.opacity=.5}),document.addEventListener("dragleave",function(){document.body.style.opacity=1}),document.addEventListener("drop",function(B){B.preventDefault();const F=new FileReader;F.addEventListener("load",function(W){T.map.image.src=W.target.result,T.map.needsUpdate=!0}),F.readAsDataURL(B.dataTransfer.files[0]),document.body.style.opacity=1}),window.addEventListener("resize",f)}function f(){e.aspect=sizes.width/sizes.height,e.updateProjectionMatrix(),i.setSize(sizes.width,sizes.height)}function v(E){E.isPrimary!==!1&&(r=E.clientX,s=E.clientY,o=n,h=a,document.addEventListener("pointermove",m),document.addEventListener("pointerup",g))}function m(E){E.isPrimary!==!1&&(n=(r-E.clientX)*.1+o,a=(E.clientY-s)*.1+h)}function g(E){E.isPrimary!==!1&&(document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",g))}function _(E){E.preventDefault();const L=e.fov+E.deltaY*.05;e.fov=Pn.clamp(L,10,75),e.updateProjectionMatrix()}function w(){requestAnimationFrame(w),x()}function x(){a=Math.max(-85,Math.min(85,a)),l=Pn.degToRad(90-a),c=Pn.degToRad(n);const E=500*Math.sin(l)*Math.cos(c),L=500*Math.cos(l),A=500*Math.sin(l)*Math.sin(c);e.lookAt(E,L,A),i.render(t,e)}return ot(E=>{p(),w()}),(E,L)=>(ke(),nt("div",hu,[be("div",{ref_key:"canvasContainer",ref:u,class:"canvas-container"},[be("canvas",{ref_key:"canvas",ref:d},null,512)],512)]))}},du=at(uu,[["__scopeId","data-v-0cf123c0"]]),pu={class:"wrap"},fu={class:"content"},vu={style:{"overflow-x":"auto","scrollbar-width":"none"}},mu=["value"],gu=da('<w-tab value="basic" data-v-2c25a5d5>basic</w-tab><w-tab value="transform" data-v-2c25a5d5>transform</w-tab><w-tab value="camera" data-v-2c25a5d5>camera</w-tab><w-tab value="geometries" data-v-2c25a5d5>geometries</w-tab><w-tab value="debug ui" data-v-2c25a5d5>debug ui</w-tab><w-tab value="materials" data-v-2c25a5d5>materials</w-tab><w-tab value="light" data-v-2c25a5d5>light</w-tab><w-tab value="shadows" data-v-2c25a5d5>shadows</w-tab><w-tab value="house" data-v-2c25a5d5>house</w-tab><w-tab value="particles" data-v-2c25a5d5>particles</w-tab><w-tab value="physics" data-v-2c25a5d5>physics</w-tab><w-tab value="models" data-v-2c25a5d5>models</w-tab><w-tab value="mouse event" data-v-2c25a5d5>mouse event</w-tab><w-tab value="Environment map" data-v-2c25a5d5>Environment map</w-tab><w-tab value="panoramic" data-v-2c25a5d5>panoramic</w-tab>',15),yu=[gu],wu={__name:"ThreeDemo",setup(y){Hs();const e=Ce(null),t=Ce({demo:"basic"});return ot(i=>{}),(i,r)=>(ke(),nt("div",{class:"wcp-container",onClick:r[1]||(r[1]=(...s)=>{var n,o;return((n=e.value)==null?void 0:n.hideMenu)&&((o=e.value)==null?void 0:o.hideMenu(...s))})},[qn(pa,{ref_key:"headerRef",ref:e},null,512),be("div",pu,[be("div",fu,[be("div",vu,[be("w-tabs",{style:{width:"max-content",display:"block"},value:t.value.demo,onChange:r[0]||(r[0]=s=>{t.value.demo=s.detail.value})},yu,40,mu)]),be("div",null,[t.value.demo=="basic"?(ke(),Tt(Xc,{key:0})):mt("",!0),t.value.demo=="transform"?(ke(),Tt(Uc,{key:1})):mt("",!0),t.value.demo=="camera"?(ke(),Tt(Wc,{key:2})):mt("",!0),t.value.demo=="geometries"?(ke(),Tt(Oc,{key:3})):mt("",!0),t.value.demo=="debug ui"?(ke(),Tt(kc,{key:4})):mt("",!0),t.value.demo=="materials"?(ke(),nt(ua,{key:5},[qn(ol),qn(Kc),qn(rh)],64)):mt("",!0),t.value.demo=="light"?(ke(),Tt(ah,{key:6})):mt("",!0),t.value.demo=="shadows"?(ke(),Tt(hh,{key:7})):mt("",!0),t.value.demo=="house"?(ke(),Tt(Xh,{key:8})):mt("",!0),t.value.demo=="particles"?(ke(),Tt(Kh,{key:9})):mt("",!0),t.value.demo=="physics"?(ke(),Tt(eu,{key:10})):mt("",!0),t.value.demo=="models"?(ke(),Tt(nu,{key:11})):mt("",!0),t.value.demo=="mouse event"?(ke(),Tt(ou,{key:12})):mt("",!0),t.value.demo=="Environment map"?(ke(),Tt(cu,{key:13})):mt("",!0),t.value.demo=="panoramic"?(ke(),Tt(du,{key:14})):mt("",!0)])])])]))}},bu=at(wu,[["__scopeId","data-v-2c25a5d5"]]);export{bu as default};
